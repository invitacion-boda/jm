(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6024],{6024:(vh,ur,ne)=>{"use strict";ne.r(ur),ne.d(ur,{HomePageModule:()=>pw});var S=ne(6814),de=ne(3582),I=ne(95),P=ne(4934),E=ne(5861),te=ne(5592),ee=ne(6321),Ge=ne(671);function J(n=0,e,t=ee.P){let r=-1;return null!=e&&((0,Ge.K)(e)?t=e:r=e),new te.y(i=>{let s=function ie(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let a=0;return t.schedule(function(){i.closed||(i.next(a++),0<=r?this.schedule(void 0,r):i.complete())},s)})}var v=ne(5879),f=ne(6593),_=ne(2459),T=ne(2096),b=ne(2793),O=ne(7921),L=ne(9360),R=ne(8251);function Q(){return(0,L.e)((n,e)=>{let t,r=!1;n.subscribe((0,R.x)(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var j,ce=ne(7398),ke=ne(6699),Ee=ne(3997),Ce=ne(2181),ct=ne(6304),Ae=(ne(8977),ne(3399)),V=ne(7592),lt=ne(4537),je=ne(7879),pe=ne(9058),zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gt={},Jo=Jo||{},se=zt||self;function cr(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function lr(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var ea="closure_uid_"+(1e9*Math.random()>>>0),Fe=0;function Ze(n,e,t){return n.call.apply(n.bind,arguments)}function ta(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function st(n,e,t){return(st=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ze:ta).apply(null,arguments)}function hr(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Ne(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var a=Array(arguments.length-2),h=2;h<arguments.length;h++)a[h-2]=arguments[h];return e.prototype[i].apply(r,a)}}function $t(){this.s=this.s,this.o=this.o}$t.prototype.s=!1,$t.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Ih(n){Object.prototype.hasOwnProperty.call(n,ea)&&n[ea]||(n[ea]=++Fe)}(this)},$t.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const uc=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function On(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function cc(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(cr(r)){const i=n.length||0,s=r.length||0;n.length=i+s;for(let a=0;a<s;a++)n[i+a]=r[a]}else n.push(r)}}function nt(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}nt.prototype.h=function(){this.defaultPrevented=!0};var wh=function(){if(!se.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{se.addEventListener("test",()=>{},e),se.removeEventListener("test",()=>{},e)}catch{}return n}();function Mn(n){return/^[\s\xa0]*$/.test(n)}function ps(){var n=se.navigator;return n&&(n=n.userAgent)?n:""}function Nt(n){return-1!=ps().indexOf(n)}function Ln(n){return Ln[" "](n),n}Ln[" "]=function(){};var na,n,Th=Nt("Opera"),pn=Nt("Trident")||Nt("MSIE"),ms=Nt("Edge"),dr=ms||pn,lc=Nt("Gecko")&&!(-1!=ps().toLowerCase().indexOf("webkit")&&!Nt("Edge"))&&!(Nt("Trident")||Nt("MSIE"))&&!Nt("Edge"),Jt=-1!=ps().toLowerCase().indexOf("webkit")&&!Nt("Edge");function gs(){var n=se.document;return n?n.documentMode:void 0}e:{var ra="",_s=(n=ps(),lc?/rv:([^\);]+)(\)|;)/.exec(n):ms?/Edge\/([\d\.]+)/.exec(n):pn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Jt?/WebKit\/(\S+)/.exec(n):Th?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(_s&&(ra=_s?_s[1]:""),pn){var Fn=gs();if(null!=Fn&&Fn>parseFloat(ra)){na=String(Fn);break e}}na=ra}var ia=se.document&&pn&&(gs()||parseInt(na,10))||void 0;function Qr(n,e){if(nt.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(lc){e:{try{Ln(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Eh[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Qr.$.h.call(this)}}Ne(Qr,nt);var Eh={2:"touch",3:"pen",4:"mouse"};Qr.prototype.h=function(){Qr.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Yr="closure_listenable_"+(1e6*Math.random()|0),sa=0;function Xr(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++sa,this.fa=this.ia=!1}function qt(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function en(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function _t(n){const e={};for(const t in n)e[t]=n[t];return e}const Ah="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Un(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let s=0;s<Ah.length;s++)t=Ah[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function jt(n){this.src=n,this.g={},this.h=0}function mn(n,e){var t=e.type;if(t in n.g){var s,r=n.g[t],i=uc(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(qt(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function ys(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}jt.prototype.add=function(n,e,t,r,i){var s=n.toString();(n=this.g[s])||(n=this.g[s]=[],this.h++);var a=ys(n,e,r,i);return-1<a?(e=n[a],t||(e.ia=!1)):((e=new Xr(e,this.src,s,!!r,i)).ia=t,n.push(e)),e};var vs="closure_lm_"+(1e6*Math.random()|0),Jr={};function oa(n,e,t,r,i){if(r&&r.once)return ua(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)oa(n,e[s],t,r,i);return null}return t=ha(t),n&&n[Yr]?n.O(e,t,lr(r)?!!r.capture:!!r,i):aa(n,e,t,!1,r,i)}function aa(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var a=lr(i)?!!i.capture:!!i,h=la(n);if(h||(n[vs]=h=new jt(n)),(t=h.add(e,t,r,a,s)).proxy)return t;if(r=function ei(){const e=Sh;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)wh||(i=a),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(fc(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function ua(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ua(n,e[s],t,r,i);return null}return t=ha(t),n&&n[Yr]?n.P(e,t,lr(r)?!!r.capture:!!r,i):aa(n,e,t,!0,r,i)}function ca(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)ca(n,e[s],t,r,i);else r=lr(r)?!!r.capture:!!r,t=ha(t),n&&n[Yr]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=ys(s=n.g[e],t,r,i))&&(qt(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete n.g[e],n.h--))):n&&(n=la(n))&&(e=n.g[e.toString()],n=-1,e&&(n=ys(e,t,r,i)),(t=-1<n?e[n]:null)&&gn(t))}function gn(n){if("number"!=typeof n&&n&&!n.fa){var e=n.src;if(e&&e[Yr])mn(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(fc(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=la(e))?(mn(t,n),0==t.h&&(t.src=null,e[vs]=null)):qt(n)}}}function fc(n){return n in Jr?Jr[n]:Jr[n]="on"+n}function Sh(n,e){if(n.fa)n=!0;else{e=new Qr(e,this);var t=n.listener,r=n.la||n.src;n.ia&&gn(n),n=t.call(r,e)}return n}function la(n){return(n=n[vs])instanceof jt?n:null}var Is="__closure_events_fn_"+(1e9*Math.random()>>>0);function ha(n){return"function"==typeof n?n:(n[Is]||(n[Is]=function(e){return n.handleEvent(e)}),n[Is])}function Ke(){$t.call(this),this.i=new jt(this),this.S=this,this.J=null}function ot(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,"string"==typeof e)e=new nt(e,n);else if(e instanceof nt)e.target=e.target||n;else{var i=e;Un(e=new nt(r,n),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];i=fr(a,r,!0,e)&&i}if(i=fr(a=e.g=n,r,!0,e)&&i,i=fr(a,r,!1,e)&&i,t)for(s=0;s<t.length;s++)i=fr(a=e.g=t[s],r,!1,e)&&i}function fr(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.fa&&a.capture==t){var h=a.listener,d=a.la||a.src;a.ia&&mn(n.i,a),i=!1!==h.call(d,r)&&i}}return i&&!r.defaultPrevented}Ne(Ke,$t),Ke.prototype[Yr]=!0,Ke.prototype.removeEventListener=function(n,e,t,r){ca(this,n,e,t,r)},Ke.prototype.N=function(){if(Ke.$.N.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)qt(t[r]);delete n.g[e],n.h--}}this.J=null},Ke.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Ke.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var ws=se.JSON.stringify;function pc(){var n=ma;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var fa=new class da{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new bh,n=>n.reset());class bh{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function pa(n){var e=1;n=n.split(":");const t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function gc(n){se.setTimeout(()=>{throw n},0)}let ti,ni=!1,ma=new class mc{constructor(){this.h=this.g=null}add(e,t){const r=fa.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},ga=()=>{const n=se.Promise.resolve(void 0);ti=()=>{n.then(_n)}};var _n=()=>{for(var n;n=pc();){try{n.h.call(n.g)}catch(t){gc(t)}var e=fa;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}ni=!1};function pr(n,e){Ke.call(this),this.h=n||1,this.g=e||se,this.j=st(this.qb,this),this.l=Date.now()}function _a(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function ya(n,e,t){if("function"==typeof n)t&&(n=st(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=st(n.handleEvent,n)}return 2147483647<Number(e)?-1:se.setTimeout(n,e||0)}function Ue(n){n.g=ya(()=>{n.g=null,n.i&&(n.i=!1,Ue(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Ne(pr,Ke),(j=pr.prototype).ga=!1,j.T=null,j.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ot(this,"tick"),this.ga&&(_a(this),this.start()))}},j.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},j.N=function(){pr.$.N.call(this),_a(this),delete this.g};class _c extends $t{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ue(this)}N(){super.N(),this.g&&(se.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ri(n){$t.call(this),this.h=n,this.g={}}Ne(ri,$t);var yc=[];function va(n,e,t,r){Array.isArray(t)||(t&&(yc[0]=t.toString()),t=yc);for(var i=0;i<t.length;i++){var s=oa(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Ia(n){en(n.g,function(e,t){this.g.hasOwnProperty(t)&&gn(e)},n),n.g={}}function Ts(){this.g=!0}function Bt(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function wa(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return ws(t)}catch{return e}}(n,t)+(r?" "+r:"")})}ri.prototype.N=function(){ri.$.N.call(this),Ia(this)},ri.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ts.prototype.Ea=function(){this.g=!1},Ts.prototype.info=function(){};var yn={},Es=null;function As(){return Es=Es||new Ke}function Ss(n){nt.call(this,yn.Ta,n)}function Vn(n){const e=As();ot(e,new Ss(e))}function bs(n,e){nt.call(this,yn.STAT_EVENT,n),this.stat=e}function rt(n){const e=As();ot(e,new bs(e,n))}function xs(n,e){nt.call(this,yn.Ua,n),this.size=e}function ii(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return se.setTimeout(function(){n()},e)}yn.Ta="serverreachability",Ne(Ss,nt),yn.STAT_EVENT="statevent",Ne(bs,nt),yn.Ua="timingevent",Ne(xs,nt);var mr={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ks={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function si(){}function Ns(){}si.prototype.h=null;var ui,oi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ai(){nt.call(this,"d")}function Ta(){nt.call(this,"c")}function Rs(){}function qn(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new ri(this),this.P=tn,this.V=new pr(n=dr?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new gr}function gr(){this.i=null,this.g="",this.h=!1}Ne(ai,nt),Ne(Ta,nt),Ne(Rs,si),Rs.prototype.g=function(){return new XMLHttpRequest},Rs.prototype.i=function(){return{}},ui=new Rs;var tn=45e3,ci={},Ds={};function Rt(n,e,t){n.L=1,n.v=Ls(yt(e)),n.s=t,n.S=!0,wc(n,null)}function wc(n,e){n.G=Date.now(),li(n),n.A=yt(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),Ca(t.i,"t",r),n.C=0,t=n.l.J,n.h=new gr,n.g=Mc(n.l,t?e:null,!n.s),0<n.O&&(n.M=new _c(st(n.Pa,n,n.g),n.O)),va(n.U,n.g,"readystatechange",n.nb),e=n.I?_t(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Vn(),function vc(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var a="",h=s.split("&"),d=0;d<h.length;d++){var m=h[d].split("=");if(1<m.length){var y=m[0];m=m[1];var w=y.split("_");a=2<=w.length&&"type"==w[1]?a+(y+"=")+m+"&":a+(y+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+a})}(n.j,n.u,n.A,n.m,n.W,n.s)}function Ps(n){return!!n.g&&"GET"==n.u&&2!=n.L&&n.l.Ha}function Tc(n,e,t){let i,r=!0;for(;!n.J&&n.C<t.length;){if(i=Ea(n,t),i==Ds){4==e&&(n.o=4,rt(14),r=!1),Bt(n.j,n.m,null,"[Incomplete Response]");break}if(i==ci){n.o=4,rt(15),Bt(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Bt(n.j,n.m,i,null),rn(n,i)}Ps(n)&&i!=Ds&&i!=ci&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,rt(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,(e=n.l).g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Za(e),e.M=!0,rt(11))):(Bt(n.j,n.m,t,"[Invalid Chunked Response]"),nn(n),hi(n))}function Ea(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Ds:(t=Number(e.substring(t,r)),isNaN(t)?ci:(r+=1)+t>e.length?Ds:(e=e.slice(r,r+t),n.C=r+t,e))}function li(n){n.Y=Date.now()+n.P,Os(n,n.P)}function Os(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ii(st(n.lb,n),e)}function Ms(n){n.B&&(se.clearTimeout(n.B),n.B=null)}function hi(n){0==n.l.H||n.J||Qs(n.l,n)}function nn(n){Ms(n);var e=n.M;e&&"function"==typeof e.sa&&e.sa(),n.M=null,_a(n.V),Ia(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function rn(n,e){try{var t=n.l;if(0!=t.H&&(t.g==n||gi(t.i,n)))if(!n.K&&gi(t.i,n)&&3==t.H){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<n.G))break e;Ws(t),Tr(t)}Ii(t),rt(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=ii(st(t.ib,t),6e3));if(1>=Da(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else Zn(t,11)}else if((n.K||t.g==n)&&Ws(t),!Mn(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let m=i[e];if(t.V=m[0],m=m[1],2==t.H)if("c"==m[0]){t.K=m[1],t.pa=m[2];const y=m[3];null!=y&&(t.ra=y,t.l.info("VER="+t.ra));const w=m[4];null!=w&&(t.Ga=w,t.l.info("SVER="+t.Ga));const k=m[5];null!=k&&"number"==typeof k&&0<k&&(t.L=r=1.5*k,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;const D=n.g;if(D){const q=D.g?D.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(q){var s=r.i;s.g||-1==q.indexOf("spdy")&&-1==q.indexOf("quic")&&-1==q.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Gs(s,s.h),s.h=null))}if(r.F){const G=D.g?D.g.getResponseHeader("X-HTTP-Session-Id"):null;G&&(r.Da=G,Re(r.I,r.F,G))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms"));var a=n;if((r=t).wa=Ys(r,r.J?r.pa:null,r.Y),a.K){Zs(r.i,a);var h=a,d=r.L;d&&h.setTimeout(d),h.B&&(Ms(h),li(h)),r.g=a}else Pc(r);0<t.j.length&&Er(t)}else"stop"!=m[0]&&"close"!=m[0]||Zn(t,7);else 3==t.H&&("stop"==m[0]||"close"==m[0]?"stop"==m[0]?Zn(t,7):Ga(t):"noop"!=m[0]&&t.h&&t.h.Aa(m),t.A=0)}Vn()}catch{}}function _r(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(cr(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function Ch(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(cr(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function kh(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(cr(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}(j=qn.prototype).setTimeout=function(n){this.P=n},j.nb=function(n){n=n.target;const e=this.M;e&&3==Pt(n)?e.l():this.Pa(n)},j.Pa=function(n){try{if(n==this.g)e:{const y=Pt(this.g);var e=this.g.Ia();if(this.g.da(),!(3>y)&&(3!=y||dr||this.g&&(this.h.h||this.g.ja()||Cc(this.g)))){this.J||4!=y||7==e||Vn(),Ms(this);var t=this.g.da();this.ca=t;t:if(Ps(this)){var r=Cc(this.g);n="";var i=r.length,s=4==Pt(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){nn(this),hi(this);var a="";break t}this.h.i=new se.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=200==t,function xh(n,e,t,r,i,s,a){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+a})}(this.j,this.u,this.A,this.m,this.W,y,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var h,d=this.g;if((h=d.g?d.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Mn(h)){var m=h;break t}}m=null}if(!(t=m)){this.i=!1,this.o=3,rt(12),nn(this),hi(this);break e}Bt(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rn(this,t)}this.S?(Tc(this,y,a),dr&&this.i&&3==y&&(va(this.U,this.V,"tick",this.mb),this.V.start())):(Bt(this.j,this.m,a,null),rn(this,a)),4==y&&nn(this),this.i&&!this.J&&(4==y?Qs(this.l,this):(this.i=!1,li(this)))}else(function qa(n){const e={};n=(n.g&&2<=Pt(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<n.length;r++){if(Mn(n[r]))continue;var t=pa(n[r]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function dc(n,e){for(const t in n)e.call(void 0,n[t],t,n)}(e,function(r){return r.join(", ")})})(this.g),400==t&&0<a.indexOf("Unknown SID")?(this.o=3,rt(12)):(this.o=0,rt(13)),nn(this),hi(this)}}}catch{}},j.mb=function(){if(this.g){var n=Pt(this.g),e=this.g.ja();this.C<e.length&&(Ms(this),Tc(this,n,e),this.i&&4!=n&&li(this))}},j.cancel=function(){this.J=!0,nn(this)},j.lb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Ic(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Vn(),rt(17)),nn(this),this.o=2,hi(this)):Os(this,this.Y-n)};var Nh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dt(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof dt){this.h=n.h,sn(this,n.j),this.s=n.s,this.g=n.g,di(this,n.m),this.l=n.l;var e=n.i,t=new pi;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Sa(this,t),this.o=n.o}else n&&(e=String(n).match(Nh))?(this.h=!1,sn(this,e[1]||"",!0),this.s=Ht(e[2]||""),this.g=Ht(e[3]||"",!0),di(this,e[4]),this.l=Ht(e[5]||"",!0),Sa(this,e[6]||"",!0),this.o=Ht(e[7]||"")):(this.h=!1,this.i=new pi(null,this.h))}function yt(n){return new dt(n)}function sn(n,e,t){n.j=t?Ht(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function di(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Sa(n,e,t){e instanceof pi?(n.i=e,function Na(n,e){e&&!n.j&&(Kt(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(mi(this,r),Ca(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=fi(e,Dt)),n.i=new pi(e,n.h))}function Re(n,e,t){n.i.set(e,t)}function Ls(n){return Re(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Ht(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function fi(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,Fs),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Fs(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}dt.prototype.toString=function(){var n=[],e=this.j;e&&n.push(fi(e,ba,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(fi(e,ba,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(fi(t,"/"==t.charAt(0)?xa:Us,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",fi(t,Ec)),n.join("")};var ba=/[#\/\?@]/g,Us=/[#\?:]/g,xa=/[#\?]/g,Dt=/[#\?@]/g,Ec=/#/g;function pi(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Kt(n){n.g||(n.g=new Map,n.h=0,n.i&&function Aa(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function mi(n,e){Kt(n),e=yr(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function ka(n,e){return Kt(n),e=yr(n,e),n.g.has(e)}function Ca(n,e,t){mi(n,e),0<t.length&&(n.i=null,n.g.set(yr(n,e),On(t)),n.h+=t.length)}function yr(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Vs(n){this.l=n||qs,n=se.PerformanceNavigationTiming?0<(n=se.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(se.g&&se.g.Ka&&se.g.Ka()&&se.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(j=pi.prototype).add=function(n,e){Kt(this),this.i=null,n=yr(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},j.forEach=function(n,e){Kt(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},j.ta=function(){Kt(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t},j.Z=function(n){Kt(this);let e=[];if("string"==typeof n)ka(this,n)&&(e=e.concat(this.g.get(yr(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},j.set=function(n,e){return Kt(this),this.i=null,ka(this,n=yr(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},j.get=function(n,e){return n&&0<(n=this.Z(n)).length?String(n[0]):e},j.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),n.push(i)}}return this.i=n.join("&")};var qs=10;function Bs(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Da(n){return n.h?1:n.g?n.g.size:0}function gi(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Gs(n,e){n.g?n.g.add(e):n.h=e}function Zs(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function _i(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.F);return e}return On(n.i)}Vs.prototype.cancel=function(){if(this.i=_i(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var Pa=class{stringify(n){return se.JSON.stringify(n,void 0)}parse(n){return se.JSON.parse(n,void 0)}};function Ac(){this.g=new Pa}function Oa(n,e,t){const r=t||"";try{_r(n,function(i,s){let a=i;lr(i)&&(a=ws(i)),e.push(r+s+"="+encodeURIComponent(a))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function vr(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function yi(n){this.l=n.fc||null,this.j=n.ob||!1}function Ir(n,e){Ke.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Ma,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ne(yi,si),yi.prototype.g=function(){return new Ir(this.l,this.j)},yi.prototype.i=function(n){return function(){return n}}({}),Ne(Ir,Ke);var Ma=0;function zs(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function on(n){n.readyState=4,n.l=null,n.j=null,n.A=null,Bn(n)}function Bn(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(j=Ir.prototype).open=function(n,e){if(this.readyState!=Ma)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,Bn(this)},j.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||se).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},j.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,on(this)),this.readyState=Ma},j.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,Bn(this)),this.g&&(this.readyState=3,Bn(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof se.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;zs(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},j.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?on(this):Bn(this),3==this.readyState&&zs(this)}},j.Za=function(n){this.g&&(this.response=this.responseText=n,on(this))},j.Ya=function(n){this.g&&(this.response=n,on(this))},j.ka=function(){this.g&&on(this)},j.setRequestHeader=function(n,e){this.v.append(n,e)},j.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},j.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(Ir.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var La=se.JSON.parse;function Se(n){Ke.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=bc,this.L=this.M=!1}Ne(Se,Ke);var bc="",Fa=/^https?$/i,Rh=["POST","PUT"];function xc(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,$s(n),wr(n)}function $s(n){n.F||(n.F=!0,ot(n,"complete"),ot(n,"error"))}function Va(n){if(n.h&&typeof Jo<"u"&&(!n.C[1]||4!=Pt(n)||2!=n.da()))if(n.v&&4==Pt(n))ya(n.La,0,n);else if(ot(n,"readystatechange"),4==Pt(n)){n.h=!1;try{const a=n.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===a){var i=String(n.I).match(Nh)[1]||null;!i&&se.self&&se.self.location&&(i=se.self.location.protocol.slice(0,-1)),r=!Fa.test(i?i.toLowerCase():"")}t=r}if(t)ot(n,"complete"),ot(n,"success");else{n.m=6;try{var s=2<Pt(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",$s(n)}}finally{wr(n)}}}function wr(n,e){if(n.g){kc(n);const t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||ot(n,"ready");try{t.onreadystatechange=r}catch{}}}function kc(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(se.clearTimeout(n.A),n.A=null)}function Pt(n){return n.g?n.g.readyState:0}function Cc(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case bc:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Nc(n){let e="";return en(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function Ba(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Nc(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Re(n,e,t))}function Gn(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function Rc(n){this.Ga=0,this.j=[],this.l=new Ts,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Gn("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Gn("baseRetryDelayMs",5e3,n),this.hb=Gn("retryDelaySeedMs",1e4,n),this.eb=Gn("forwardChannelMaxRetries",2,n),this.xa=Gn("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new Vs(n&&n.concurrentRequestLimit),this.Ja=new Ac,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ga(n){if(Dc(n),3==n.H){var e=n.W++,t=yt(n.I);if(Re(t,"SID",n.K),Re(t,"RID",e),Re(t,"TYPE","terminate"),vi(n,t),(e=new qn(n,n.l,e)).L=2,e.v=Ls(yt(t)),t=!1,se.navigator&&se.navigator.sendBeacon)try{t=se.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&se.Image&&((new Image).src=e.v,t=!0),t||(e.g=Mc(e.l,null),e.g.ha(e.v)),e.G=Date.now(),li(e)}za(n)}function Tr(n){n.g&&(Za(n),n.g.cancel(),n.g=null)}function Dc(n){Tr(n),n.u&&(se.clearTimeout(n.u),n.u=null),Ws(n),n.i.cancel(),n.m&&("number"==typeof n.m&&se.clearTimeout(n.m),n.m=null)}function Er(n){if(!Bs(n.i)&&!n.m){n.m=!0;var e=n.Na;ti||ga(),ni||(ti(),ni=!0),ma.add(e,n),n.C=0}}function js(n,e){var t;t=e?e.m:n.W++;const r=yt(n.I);Re(r,"SID",n.K),Re(r,"RID",t),Re(r,"AID",n.V),vi(n,r),n.o&&n.s&&Ba(r,n.o,n.s),t=new qn(n,n.l,t,n.C+1),null===n.o&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Hs(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Gs(n.i,t),Rt(t,r,e)}function vi(n,e){n.na&&en(n.na,function(t,r){Re(e,r,t)}),n.h&&_r({},function(t,r){Re(e,r,t)})}function Hs(n,e,t){t=Math.min(n.j.length,t);var r=n.h?st(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){const a=["count="+t];-1==s?0<t?(s=i[0].g,a.push("ofs="+s)):s=0:a.push("ofs="+s);let h=!0;for(let d=0;d<t;d++){let m=i[d].g;const y=i[d].map;if(m-=s,0>m)s=Math.max(0,i[d].g-100),h=!1;else try{Oa(y,a,"req"+m+"_")}catch{r&&r(y)}}if(h){r=a.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Pc(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;ti||ga(),ni||(ti(),ni=!0),ma.add(e,n),n.A=0}}function Ii(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=ii(st(n.Ma,n),Oc(n,n.A)),n.A++,0))}function Za(n){null!=n.B&&(se.clearTimeout(n.B),n.B=null)}function Ks(n){n.g=new qn(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var e=yt(n.wa);Re(e,"RID","rpc"),Re(e,"SID",n.K),Re(e,"AID",n.V),Re(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&Re(e,"TO",n.qa),Re(e,"TYPE","xmlhttp"),vi(n,e),n.o&&n.s&&Ba(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=Ls(yt(e)),t.s=null,t.S=!0,wc(t,n)}function Ws(n){null!=n.v&&(se.clearTimeout(n.v),n.v=null)}function Qs(n,e){var t=null;if(n.g==e){Ws(n),Za(n),n.g=null;var r=2}else{if(!gi(n.i,e))return;t=e.F,Zs(n.i,e),r=1}if(0!=n.H)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;ot(r=As(),new xs(r,t)),Er(n)}else Pc(n);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==r&&function Dh(n,e){return!(Da(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=e.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=ii(st(n.Na,n,e),Oc(n,n.C)),n.C++,0)))}(n,e)||2==r&&Ii(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Zn(n,5);break;case 4:Zn(n,10);break;case 3:Zn(n,6);break;default:Zn(n,2)}}function Oc(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function Zn(n,e){if(n.l.info("Error code "+e),2==e){var t=null;n.h&&(t=null);var r=st(n.pb,n);t||(t=new dt("//www.google.com/images/cleardot.gif"),se.location&&"http"==se.location.protocol||sn(t,"https"),Ls(t)),function Sc(n,e){const t=new Ts;if(se.Image){const r=new Image;r.onload=hr(vr,t,r,"TestLoadImage: loaded",!0,e),r.onerror=hr(vr,t,r,"TestLoadImage: error",!1,e),r.onabort=hr(vr,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=hr(vr,t,r,"TestLoadImage: timeout",!1,e),se.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else rt(2);n.H=0,n.h&&n.h.za(e),za(n),Dc(n)}function za(n){if(n.H=0,n.ma=[],n.h){const e=_i(n.i);(0!=e.length||0!=n.j.length)&&(cc(n.ma,e),cc(n.ma,n.j),n.i.i.length=0,On(n.j),n.j.length=0),n.h.ya()}}function Ys(n,e,t){var r=t instanceof dt?yt(t):new dt(t);if(""!=r.g)e&&(r.g=e+"."+r.g),di(r,r.m);else{var i=se.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new dt(null);r&&sn(s,r),e&&(s.g=e),i&&di(s,i),t&&(s.l=t),r=s}return e=n.Da,(t=n.F)&&e&&Re(r,t,e),Re(r,"VER",n.ra),vi(n,r),r}function Mc(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Se(t&&n.Ha&&!n.va?new yi({ob:!0}):n.va)).Oa(n.J),e}function zn(){}function wi(){if(pn&&!(10<=Number(ia)))throw Error("Environmental error: no available transport.")}function St(n,e){Ke.call(this),this.g=new Rc(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Mn(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Mn(e)&&(this.g.F=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Ar(this)}function Lc(n){ai.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Fc(){Ta.call(this),this.status=1}function Ar(n){this.g=n}function Wt(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Uc(n,e,t){t||(t=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=n.g[3],a=(e=n.g[0])+(s^(t=n.g[1])&((i=n.g[2])^s))+r[0]+3614090360&4294967295;a=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(a<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=e+(s^t&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^e&(t^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(t^s&(e^t))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=t+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=e+(i^s&(t^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=e+(i^s&(t^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(t^i&(e^t))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(e^t&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=t+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=e+(t^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=e+(t^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(e^t^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^e^t)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=t+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=e+(i^(t|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=e+(i^(t|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(e^(s|~t))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=t+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(e=t+((a=e+(i^(t|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(t^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(e^(s|~t))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}function we(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=0|n[i];r&&s==e||(t[i]=s,r=!1)}this.g=t}(j=Se.prototype).Oa=function(n){this.M=n},j.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ui.g(),this.C=function Cs(n){return n.h||(n.h=n.i())}(this.u?this.u:ui),this.g.onreadystatechange=st(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){return void xc(this,s)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())t.set(s,r.get(s))}r=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=se.FormData&&n instanceof se.FormData,!(0<=uc(Rh,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of t)this.g.setRequestHeader(s,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{kc(this),0<this.B&&((this.L=function Ua(n){return pn&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=st(this.ua,this)):this.A=ya(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){xc(this,s)}},j.ua=function(){typeof Jo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ot(this,"timeout"),this.abort(8))},j.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ot(this,"complete"),ot(this,"abort"),wr(this))},j.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wr(this,!0)),Se.$.N.call(this)},j.La=function(){this.s||(this.G||this.v||this.l?Va(this):this.kb())},j.kb=function(){Va(this)},j.isActive=function(){return!!this.g},j.da=function(){try{return 2<Pt(this)?this.g.status:-1}catch{return-1}},j.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},j.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),La(e)}},j.Ia=function(){return this.m},j.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(j=Rc.prototype).ra=8,j.H=1,j.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const i=new qn(this,this.l,n);let s=this.s;if(this.U&&(s?(s=_t(s),Un(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var r=this.j[t];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Hs(this,i,e),Re(t=yt(this.I),"RID",n),Re(t,"CVER",22),this.F&&Re(t,"X-HTTP-Session-Id",this.F),vi(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Nc(s)))+"&"+e:this.o&&Ba(t,this.o,s)),Gs(this.i,i),this.bb&&Re(t,"TYPE","init"),this.P?(Re(t,"$req",e),Re(t,"SID","null"),i.aa=!0,Rt(i,t,null)):Rt(i,t,e),this.H=2}}else 3==this.H&&(n?js(this,n):0==this.j.length||Bs(this.i)||js(this))},j.Ma=function(){if(this.u=null,Ks(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=ii(st(this.jb,this),n)}},j.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,rt(10),Tr(this),Ks(this))},j.ib=function(){null!=this.v&&(this.v=null,Tr(this),Ii(this),rt(19))},j.pb=function(n){n?(this.l.info("Successfully pinged google.com"),rt(2)):(this.l.info("Failed to ping google.com"),rt(1))},j.isActive=function(){return!!this.h&&this.h.isActive(this)},(j=zn.prototype).Ba=function(){},j.Aa=function(){},j.za=function(){},j.ya=function(){},j.isActive=function(){return!0},j.Va=function(){},wi.prototype.g=function(n,e){return new St(n,e)},Ne(St,Ke),St.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;rt(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=Ys(n,null,n.Y),Er(n)},St.prototype.close=function(){Ga(this.g)},St.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=ws(n),n=t);e.j.push(new class{constructor(n,e){this.g=n,this.map=e}}(e.fb++,n)),3==e.H&&Er(e)},St.prototype.N=function(){this.g.h=null,delete this.j,Ga(this.g),delete this.g,St.$.N.call(this)},Ne(Lc,ai),Ne(Fc,Ta),Ne(Ar,zn),Ar.prototype.Ba=function(){ot(this.g,"a")},Ar.prototype.Aa=function(n){ot(this.g,new Lc(n))},Ar.prototype.za=function(n){ot(this.g,new Fc)},Ar.prototype.ya=function(){ot(this.g,"b")},Ne(Wt,function Ph(){this.blockSize=-1}),Wt.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Wt.prototype.j=function(n,e){void 0===e&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)Uc(this,n,s),s+=this.blockSize;if("string"==typeof n){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){Uc(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){Uc(this,r),i=0;break}}this.h=i,this.i+=e},Wt.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=255&t,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};var Oh={};function Vc(n){return-128<=n&&128>n?function Dp(n,e){var t=Oh;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}(n,function(e){return new we([0|e],0>e?-1:0)}):new we([0|n],0>n?-1:0)}function an(n){if(isNaN(n)||!isFinite(n))return Ti;if(0>n)return at(an(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=qc;return new we(e,0)}var qc=4294967296,Ti=Vc(0),Ei=Vc(1),vn=Vc(16777216);function Gt(n){if(0!=n.h)return!1;for(var e=0;e<n.g.length;e++)if(0!=n.g[e])return!1;return!0}function Ot(n){return-1==n.h}function at(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new we(t,~n.h).add(Ei)}function Xs(n,e){return n.add(at(e))}function $a(n,e){for(;(65535&n[e])!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Ai(n,e){this.g=n,this.h=e}function Js(n,e){if(Gt(e))throw Error("division by zero");if(Gt(n))return new Ai(Ti,Ti);if(Ot(n))return e=Js(at(n),e),new Ai(at(e.g),at(e.h));if(Ot(e))return e=Js(n,at(e)),new Ai(at(e.g),e.h);if(30<n.g.length){if(Ot(n)||Ot(e))throw Error("slowDivide_ only works with positive integers.");for(var t=Ei,r=e;0>=r.X(n);)t=eo(t),r=eo(r);var i=In(t,1),s=In(r,1);for(r=In(r,2),t=In(t,2);!Gt(r);){var a=s.add(r);0>=a.X(n)&&(i=i.add(t),s=a),r=In(r,1),t=In(t,1)}return e=Xs(n,i.R(e)),new Ai(i,e)}for(i=Ti;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,r-48),a=(s=an(t)).R(e);Ot(a)||0<a.X(n);)a=(s=an(t-=r)).R(e);Gt(s)&&(s=Ei),i=i.add(s),n=Xs(n,a)}return new Ai(i,n)}function eo(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new we(t,n.h)}function In(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new we(i,n.h)}(j=we.prototype).ea=function(){if(Ot(this))return-at(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:qc+r)*e,e*=qc}return n},j.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Gt(this))return"0";if(Ot(this))return"-"+at(this).toString(n);for(var e=an(Math.pow(n,6)),t=this,r="";;){var i=Js(t,e).g,s=((0<(t=Xs(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(n);if(Gt(t=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},j.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},j.X=function(n){return Ot(n=Xs(this,n))?-1:Gt(n)?0:1},j.abs=function(){return Ot(this)?at(this):this},j.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&n.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=a>>>16,t[i]=(a&=65535)<<16|(s&=65535)}return new we(t,-2147483648&t[t.length-1]?-1:0)},j.R=function(n){if(Gt(this)||Gt(n))return Ti;if(Ot(this))return Ot(n)?at(this).R(at(n)):at(at(this).R(n));if(Ot(n))return at(this.R(at(n)));if(0>this.X(vn)&&0>n.X(vn))return an(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,a=65535&this.D(r),h=n.D(i)>>>16,d=65535&n.D(i);t[2*r+2*i]+=a*d,$a(t,2*r+2*i),t[2*r+2*i+1]+=s*d,$a(t,2*r+2*i+1),t[2*r+2*i+1]+=a*h,$a(t,2*r+2*i+1),t[2*r+2*i+2]+=s*h,$a(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new we(t,0)},j.gb=function(n){return Js(this,n).h},j.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new we(t,this.h&n.h)},j.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new we(t,this.h|n.h)},j.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new we(t,this.h^n.h)},wi.prototype.createWebChannel=wi.prototype.g,St.prototype.send=St.prototype.u,St.prototype.open=St.prototype.m,St.prototype.close=St.prototype.close,mr.NO_ERROR=0,mr.TIMEOUT=8,mr.HTTP_ERROR=6,ks.COMPLETE="complete",Ns.EventType=oi,oi.OPEN="a",oi.CLOSE="b",oi.ERROR="c",oi.MESSAGE="d",Ke.prototype.listen=Ke.prototype.O,Se.prototype.listenOnce=Se.prototype.P,Se.prototype.getLastError=Se.prototype.Sa,Se.prototype.getLastErrorCode=Se.prototype.Ia,Se.prototype.getStatus=Se.prototype.da,Se.prototype.getResponseJson=Se.prototype.Wa,Se.prototype.getResponseText=Se.prototype.ja,Se.prototype.send=Se.prototype.ha,Se.prototype.setWithCredentials=Se.prototype.Oa,Wt.prototype.digest=Wt.prototype.l,Wt.prototype.reset=Wt.prototype.reset,Wt.prototype.update=Wt.prototype.j,we.prototype.add=we.prototype.add,we.prototype.multiply=we.prototype.R,we.prototype.modulo=we.prototype.gb,we.prototype.compare=we.prototype.X,we.prototype.toNumber=we.prototype.ea,we.prototype.toString=we.prototype.toString,we.prototype.getBits=we.prototype.D,we.fromNumber=an,we.fromString=function Mh(n,e){if(0==n.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==n.charAt(0))return at(Mh(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=an(Math.pow(e,8)),r=Ti,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),a=parseInt(n.substring(i,i+s),e);8>s?(s=an(Math.pow(e,s)),r=r.R(s).add(an(a))):r=(r=r.R(t)).add(an(a))}return r};var Lh=gt.createWebChannelTransport=function(){return new wi},to=gt.getStatEventTarget=function(){return As()},no=gt.ErrorCode=mr,Fh=gt.EventType=ks,Uh=gt.Event=yn,Bc=gt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Pp=gt.FetchXmlHttpFactory=yi,$n=gt.WebChannel=Ns,Op=gt.XhrIo=Se,wn=gt.Md5=Wt,Sr=gt.Integer=we;const Gc="@firebase/firestore";class ze{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ze.UNAUTHENTICATED=new ze(null),ze.GOOGLE_CREDENTIALS=new ze("google-credentials-uid"),ze.FIRST_PARTY=new ze("first-party-uid"),ze.MOCK_USER=new ze("mock-user");let br="9.23.0";const be=new je.Yd("@firebase/firestore");function ja(){return be.logLevel}function U(n,...e){if(be.logLevel<=je.in.DEBUG){const t=e.map(Ka);be.debug(`Firestore (${br}): ${n}`,...t)}}function Ve(n,...e){if(be.logLevel<=je.in.ERROR){const t=e.map(Ka);be.error(`Firestore (${br}): ${n}`,...t)}}function Mt(n,...e){if(be.logLevel<=je.in.WARN){const t=e.map(Ka);be.warn(`Firestore (${br}): ${n}`,...t)}}function Ka(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function H(n="Unexpected state"){const e=`FIRESTORE (${br}) INTERNAL ASSERTION FAILED: `+n;throw Ve(e),new Error(e)}function X(n,e){n||H()}function z(n,e){return n}const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class M extends pe.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class We{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class io{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Zc{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ze.UNAUTHENTICATED))}shutdown(){}}class Wa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Vh{constructor(e){this.t=e,this.currentUser=ze.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const s=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let a=new We;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new We,e.enqueueRetryable(()=>s(this.currentUser))};const h=()=>{const m=a;e.enqueueRetryable((0,E.Z)(function*(){yield m.promise,yield s(r.currentUser)}))},d=m=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(m=>d(m)),setTimeout(()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?d(m):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new We)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X("string"==typeof r.accessToken),new io(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return X(null===e||"string"==typeof e),new ze(e)}}class Qa{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=ze.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class zc{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new Qa(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ze.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class $c{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qh{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const r=s=>{null!=s.error&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.T;return this.T=s.token,U("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(X("string"==typeof t.token),this.T=t.token,new $c(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function xr(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class jc{static A(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=xr(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function ae(n,e){return n<e?-1:n>e?1:0}function kr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Hc(n){return n+"\0"}class Oe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Oe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ae(this.nanoseconds,e.nanoseconds):ae(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Y{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Y(e)}static min(){return new Y(new Oe(0,0))}static max(){return new Y(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Si{constructor(e,t,r){void 0===t?t=0:t>e.length&&H(),void 0===r?r=e.length-t:r>e.length-t&&H(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===Si.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Si?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class _e extends Si{construct(e,t,r){return new _e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new M(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new _e(t)}static emptyPath(){return new _e([])}}const Bh=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Me extends Si{construct(e,t,r){return new Me(e,t,r)}static isValidIdentifier(e){return Bh.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Me.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Me(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new M(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new M(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if("\\"!==d&&"."!==d&&"`"!==d)throw new M(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else"`"===h?(a=!a,i++):"."!==h||a?(r+=h,i++):(s(),i++)}if(s(),a)throw new M(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Me(t)}static emptyPath(){return new Me([])}}class Z{constructor(e){this.path=e}static fromPath(e){return new Z(_e.fromString(e))}static fromName(e){return new Z(_e.fromString(e).popFirst(5))}static empty(){return new Z(_e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===_e.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return _e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Z(new _e(e.slice()))}}class so{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Ya(n){return n.fields.find(e=>2===e.kind)}function jn(n){return n.fields.filter(e=>2!==e.kind)}so.UNKNOWN_ID=-1;class bi{constructor(e,t){this.fieldPath=e,this.kind=t}}class xi{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new xi(0,bt.min())}}function Kc(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(1e9===r?new Oe(t+1,0):new Oe(t,r));return new bt(i,Z.empty(),e)}function oo(n){return new bt(n.readTime,n.key,-1)}class bt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bt(Y.min(),Z.empty(),-1)}static max(){return new bt(Y.max(),Z.empty(),-1)}}function ki(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Z.comparator(n.documentKey,e.documentKey),0!==t?t:ae(n.largestBatchId,e.largestBatchId))}const Wc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ao{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Tn(n){return Ci.apply(this,arguments)}function Ci(){return Ci=(0,E.Z)(function*(n){if(n.code!==N.FAILED_PRECONDITION||n.message!==Wc)throw n;U("LocalStore","Unexpectedly lost primary lease")}),Ci.apply(this,arguments)}class C{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new C((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof C?t:C.resolve(t)}catch(t){return C.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):C.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):C.reject(t)}static resolve(e){return new C((t,r)=>{t(e)})}static reject(e){return new C((t,r)=>{r(e)})}static waitFor(e){return new C((t,r)=>{let i=0,s=0,a=!1;e.forEach(h=>{++i,h.next(()=>{++s,a&&s===i&&t()},d=>r(d))}),a=!0,s===i&&t()})}static or(e){let t=C.resolve(!1);for(const r of e)t=t.next(i=>i?C.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new C((r,i)=>{const s=e.length,a=new Array(s);let h=0;for(let d=0;d<s;d++){const m=d;t(e[m]).next(y=>{a[m]=y,++h,h===s&&r(a)},y=>i(y))}})}static doWhile(e,t){return new C((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class Cr{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new We,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new un(e,t.error)):this.v.resolve()},this.transaction.onerror=r=>{const i=eu(r.target.error);this.v.reject(new un(e,i))}}static open(e,t,r,i){try{return new Cr(t,e.transaction(i,r))}catch(s){throw new un(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Ja(t)}}class Zt{constructor(e,t,r){this.name=e,this.version=t,this.V=r,12.2===Zt.S((0,pe.z$)())&&Ve("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),Hn(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,pe.hl)())return!1;if(Zt.C())return!0;const e=(0,pe.z$)(),t=Zt.S(e),r=0<t&&t<10,i=Zt.N(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}$(e){var t=this;return(0,E.Z)(function*(){return t.db||(U("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=a=>{r(a.target.result)},s.onblocked=()=>{i(new un(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const h=a.target.error;i("VersionError"===h.name?new M(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new M(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new un(e,h))},s.onupgradeneeded=a=>{U("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',a.oldVersion),t.V.O(a.target.result,s.transaction,a.oldVersion,t.version).next(()=>{U("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.F&&(t.db.onversionchange=r=>t.F(r)),t.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,E.Z)(function*(){const a="readonly"===t;let h=0;for(;;){++h;try{s.db=yield s.$(e);const d=Cr.open(s.db,e,a?"readonly":"readwrite",r),m=i(d).next(y=>(d.P(),y)).catch(y=>(d.abort(y),C.reject(y))).toPromise();return m.catch(()=>{}),yield d.R,m}catch(d){const m=d,y="FirebaseError"!==m.name&&h<3;if(U("SimpleDb","Transaction failed with error:",m.message,"Retrying:",y),s.close(),!y)return Promise.reject(m)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Xa{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Hn(this.L.delete())}}class un extends M{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function vt(n){return"IndexedDbTransactionError"===n.name}class Ja{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hn(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),Hn(this.store.add(e))}get(e){return Hn(this.store.get(e)).next(t=>(void 0===t&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),Hn(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),Hn(this.store.count())}j(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.W(i,(a,h)=>{s.push(h)}).next(()=>s)}{const i=this.store.getAll(r.range);return new C((s,a)=>{i.onerror=h=>{a(h.target.error)},i.onsuccess=h=>{s(h.target.result)}})}}H(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new C((i,s)=>{r.onerror=a=>{s(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}J(e,t){U("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const i=this.cursor(r);return this.W(i,(s,a,h)=>h.delete())}X(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Z(e){const t=this.cursor({});return new C((r,i)=>{t.onerror=s=>{const a=eu(s.target.error);i(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(h=>{h?a.continue():r()}):r()}})}W(e,t){const r=[];return new C((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const h=a.target.result;if(!h)return void i();const d=new Xa(h),m=t(h.primaryKey,h.value,d);if(m instanceof C){const y=m.catch(w=>(d.done(),C.reject(w)));r.push(y)}d.isDone?i():null===d.K?h.continue():h.continue(d.K)}}).next(()=>C.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hn(n){return new C((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=eu(r.target.error);t(i)}})}let Qc=!1;function eu(n){const e=Zt.S((0,pe.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Qc||(Qc=!0,setTimeout(()=>{throw r},0)),r}}return n}class tu{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var t=this;U("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,E.Z)(function*(){t.task=null;try{U("IndexBackiller",`Documents written: ${yield t.tt.nt()}`)}catch(r){vt(r)?U("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Tn(r)}yield t.et(6e4)}))}}class Yc{constructor(e,t){this.localStore=e,this.persistence=t}nt(e=50){var t=this;return(0,E.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.st(r,e))})()}st(e,t){const r=new Set;let i=t,s=!0;return C.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(null!==a&&!r.has(a))return U("IndexBackiller",`Processing collection: ${a}`),this.it(e,a,i).next(h=>{i-=h,r.add(a)});s=!1})).next(()=>t-i)}it(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.rt(i,s)).next(h=>(U("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>a.size)}))}rt(e,t){let r=e;return t.changes.forEach((i,s)=>{const a=oo(s);ki(a,r)>0&&(r=a)}),new bt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let xt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>r.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return n.ct=-1,n})();function Ni(n){return null==n}function Kn(n){return 0===n&&1/n==-1/0}function Xc(n){return"number"==typeof n&&Number.isInteger(n)&&!Kn(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function it(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=uo(e)),e=zh(n.get(t),e);return uo(e)}function zh(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function uo(n){return n+"\x01\x01"}function Lt(n){const e=n.length;if(X(e>=2),2===e)return X("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),_e.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const a=n.indexOf("\x01",s);switch((a<0||a>t)&&H(),n.charAt(a+1)){case"\x01":const h=n.substring(s,a);let d;0===i.length?d=h:(i+=h,d=i,i=""),r.push(d);break;case"\x10":i+=n.substring(s,a),i+="\0";break;case"\x11":i+=n.substring(s,a+1);break;default:H()}s=a+2}return new _e(r)}const Jc=["userId","batchId"];function En(n,e){return[n,it(e)]}function el(n,e,t){return[n,it(e),t]}const $h={},nu=["prefixPath","collectionGroup","readTime","documentId"],ru=["prefixPath","collectionGroup","documentId"],iu=["collectionGroup","readTime","prefixPath","documentId"],jh=["canonicalId","targetId"],su=["targetId","path"],tl=["path","targetId"],nl=["collectionId","parent"],Hh=["indexId","uid"],Kh=["uid","sequenceNumber"],ou=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Wh=["indexId","uid","orderedDocumentKey"],Qh=["userId","collectionPath","documentId"],au=["userId","collectionPath","largestBatchId"],Yh=["userId","collectionGroup","largestBatchId"],rl=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],uu=[...rl,"documentOverlays"],il=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],co=il,lo=[...co,"indexConfiguration","indexState","indexEntries"];class Ri extends ao{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Qe(n,e){const t=z(n);return Zt.M(t.ht,e)}function ho(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function An(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function cu(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class xe{constructor(e,t){this.comparator=e,this.root=t||ut.EMPTY}insert(e,t){return new xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Di(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Di(this.root,e,this.comparator,!1)}getReverseIterator(){return new Di(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Di(this.root,e,this.comparator,!0)}}class Di{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=null!=r?r:ut.RED,this.left=null!=i?i:ut.EMPTY,this.right=null!=s?s:ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ut(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ut.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();const e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1,ut.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(n,e,t,r,i){return this}insert(n,e,t){return new ut(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class De{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fo(this.data.getIterator())}getIteratorFrom(e){return new fo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof De)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new De(this.comparator);return t.data=e,t}}class fo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Nr(n){return n.hasNext()?n.getNext():void 0}class It{constructor(e){this.fields=e,e.sort(Me.comparator)}static empty(){return new It([])}unionWith(e){let t=new De(Me.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new It(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return kr(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class sl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ye{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sl("Invalid base64 string: "+i):i}}(e);return new Ye(t)}static fromUint8Array(e){const t=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new Ye(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ae(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ye.EMPTY_BYTE_STRING=new Ye("");const Xh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cn(n){if(X(!!n),"string"==typeof n){let e=0;const t=Xh.exec(n);if(X(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(n.seconds),nanos:$e(n.nanos)}}function $e(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Ft(n){return"string"==typeof n?Ye.fromBase64String(n):Ye.fromUint8Array(n)}function po(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function mo(n){const e=n.mapValue.fields.__previous_value__;return po(e)?mo(e):e}function Pi(n){const e=cn(n.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}class Jh{constructor(e,t,r,i,s,a,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=m}}class Sn{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Sn("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Sn&&e.projectId===this.projectId&&e.database===this.database}}const bn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},go={nullValue:"NULL_VALUE"};function xn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?po(n)?4:cl(n)?9007199254740991:10:H()}function Ut(n,e){if(n===e)return!0;const t=xn(n);if(t!==xn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Pi(n).isEqual(Pi(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=cn(r.timestampValue),a=cn(i.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Ft(n.bytesValue).isEqual(Ft(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return $e(r.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(r.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return $e(r.integerValue)===$e(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=$e(r.doubleValue),a=$e(i.doubleValue);return s===a?Kn(s)===Kn(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return kr(n.arrayValue.values||[],e.arrayValue.values||[],Ut);case 10:return function(r,i){const s=r.mapValue.fields||{},a=i.mapValue.fields||{};if(ho(s)!==ho(a))return!1;for(const h in s)if(s.hasOwnProperty(h)&&(void 0===a[h]||!Ut(s[h],a[h])))return!1;return!0}(n,e);default:return H()}var i}function Oi(n,e){return void 0!==(n.values||[]).find(t=>Ut(t,e))}function kn(n,e){if(n===e)return 0;const t=xn(n),r=xn(e);if(t!==r)return ae(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ae(n.booleanValue,e.booleanValue);case 2:return function(i,s){const a=$e(i.integerValue||i.doubleValue),h=$e(s.integerValue||s.doubleValue);return a<h?-1:a>h?1:a===h?0:isNaN(a)?isNaN(h)?0:-1:1}(n,e);case 3:return ol(n.timestampValue,e.timestampValue);case 4:return ol(Pi(n),Pi(e));case 5:return ae(n.stringValue,e.stringValue);case 6:return function(i,s){const a=Ft(i),h=Ft(s);return a.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,s){const a=i.split("/"),h=s.split("/");for(let d=0;d<a.length&&d<h.length;d++){const m=ae(a[d],h[d]);if(0!==m)return m}return ae(a.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,s){const a=ae($e(i.latitude),$e(s.latitude));return 0!==a?a:ae($e(i.longitude),$e(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,s){const a=i.values||[],h=s.values||[];for(let d=0;d<a.length&&d<h.length;++d){const m=kn(a[d],h[d]);if(m)return m}return ae(a.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===bn.mapValue&&s===bn.mapValue)return 0;if(i===bn.mapValue)return 1;if(s===bn.mapValue)return-1;const a=i.fields||{},h=Object.keys(a),d=s.fields||{},m=Object.keys(d);h.sort(),m.sort();for(let y=0;y<h.length&&y<m.length;++y){const w=ae(h[y],m[y]);if(0!==w)return w;const k=kn(a[h[y]],d[m[y]]);if(0!==k)return k}return ae(h.length,m.length)}(n.mapValue,e.mapValue);default:throw H()}}function ol(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return ae(n,e);const t=cn(n),r=cn(e),i=ae(t.seconds,r.seconds);return 0!==i?i:ae(t.nanos,r.nanos)}function Rr(n){return hu(n)}function hu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=cn(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Ft(n.bytesValue).toBase64():"referenceValue"in n?Z.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(const a of r.values||[])s?s=!1:i+=",",i+=hu(a);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const h of i)a?a=!1:s+=",",s+=`${h}:${hu(r.fields[h])}`;return s+"}"}(n.mapValue):H();var e}function Wn(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function du(n){return!!n&&"integerValue"in n}function Li(n){return!!n&&"arrayValue"in n}function al(n){return!!n&&"nullValue"in n}function ul(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Dr(n){return!!n&&"mapValue"in n}function Qn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return An(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Qn(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Qn(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cl(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function fu(n){return"nullValue"in n?go:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Wn(Sn.empty(),Z.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:H()}function ed(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Wn(Sn.empty(),Z.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?bn:H()}function pu(n,e){const t=kn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ll(n,e){const t=kn(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Xe{constructor(e){this.value=e}static empty(){return new Xe({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Dr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qn(t)}setAll(e){let t=Me.emptyPath(),r={},i=[];e.forEach((a,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,r,i),r={},i=[],t=h.popLast()}a?r[h.lastSegment()]=Qn(a):i.push(h.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Dr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ut(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Dr(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){An(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Xe(Qn(this.value))}}function hl(n){const e=[];return An(n.fields,(t,r)=>{const i=new Me([t]);if(Dr(r)){const s=hl(r.mapValue).fields;if(0===s.length)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new It(e)}class Le{constructor(e,t,r,i,s,a,h){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=h}static newInvalidDocument(e){return new Le(e,0,Y.min(),Y.min(),Y.min(),Xe.empty(),0)}static newFoundDocument(e,t,r,i){return new Le(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new Le(e,2,t,Y.min(),Y.min(),Xe.empty(),0)}static newUnknownDocument(e,t){return new Le(e,3,t,Y.min(),Y.min(),Xe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Le&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Qt{constructor(e,t){this.position=e,this.inclusive=t}}function mu(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],a=n.position[i];if(r=s.field.isKeyField()?Z.comparator(Z.fromName(a.referenceValue),t.key):kn(a,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Fi(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ut(n.position[t],e.position[t]))return!1;return!0}class Yn{constructor(e,t="asc"){this.field=e,this.dir=t}}function dl(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class fl{}class ge extends fl{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new _u(e,t,r):"array-contains"===t?new nd(e,r):"in"===t?new yo(e,r):"not-in"===t?new rd(e,r):"array-contains-any"===t?new id(e,r):new ge(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new td(e,r):new yu(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(kn(t,this.value)):null!==t&&xn(this.value)===xn(t)&&this.matchesComparison(kn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return H()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Te extends fl{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Te(e,t)}matches(e){return Pr(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Pr(n){return"and"===n.op}function gu(n){return"or"===n.op}function _o(n){return pl(n)&&Pr(n)}function pl(n){for(const e of n.filters)if(e instanceof Te)return!1;return!0}function ml(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+Rr(n.value);if(_o(n))return n.filters.map(e=>ml(e)).join(",");{const e=n.filters.map(t=>ml(t)).join(",");return`${n.op}(${e})`}}function Cn(n,e){return n instanceof ge?(t=n,(r=e)instanceof ge&&t.op===r.op&&t.field.isEqual(r.field)&&Ut(t.value,r.value)):n instanceof Te?function(t,r){return r instanceof Te&&t.op===r.op&&t.filters.length===r.filters.length&&t.filters.reduce((i,s,a)=>i&&Cn(s,r.filters[a]),!0)}(n,e):void H();var t,r}function gl(n,e){const t=n.filters.concat(e);return Te.create(t,n.op)}function _l(n){return n instanceof ge?`${(e=n).field.canonicalString()} ${e.op} ${Rr(e.value)}`:n instanceof Te?function(e){return e.op.toString()+" {"+e.getFilters().map(_l).join(" ,")+"}"}(n):"Filter";var e}class _u extends ge{constructor(e,t,r){super(e,t,r),this.key=Z.fromName(r.referenceValue)}matches(e){const t=Z.comparator(e.key,this.key);return this.matchesComparison(t)}}class td extends ge{constructor(e,t){super(e,"in",t),this.keys=yl(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class yu extends ge{constructor(e,t){super(e,"not-in",t),this.keys=yl(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function yl(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Z.fromName(r.referenceValue))}class nd extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Li(t)&&Oi(t.arrayValue,this.value)}}class yo extends ge{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Oi(this.value.arrayValue,t)}}class rd extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(Oi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Oi(this.value.arrayValue,t)}}class id extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Li(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Oi(this.value.arrayValue,r))}}class vu{constructor(e,t=null,r=[],i=[],s=null,a=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=h,this.dt=null}}function Iu(n,e=null,t=[],r=[],i=null,s=null,a=null){return new vu(n,e,t,r,i,s,a)}function Xn(n){const e=z(n);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ml(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),Ni(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Rr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Rr(r)).join(",")),e.dt=t}return e.dt}function Ui(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!dl(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Cn(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Fi(n.startAt,e.startAt)&&Fi(n.endAt,e.endAt)}function vo(n){return Z.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function Io(n,e){return n.filters.filter(t=>t instanceof ge&&t.field.isEqual(e))}function wu(n,e,t){let r=go,i=!0;for(const s of Io(n,e)){let a=go,h=!0;switch(s.op){case"<":case"<=":a=fu(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,h=!1;break;case"!=":case"not-in":a=go}pu({value:r,inclusive:i},{value:a,inclusive:h})<0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];pu({value:r,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}function wo(n,e,t){let r=bn,i=!0;for(const s of Io(n,e)){let a=bn,h=!0;switch(s.op){case">=":case">":a=ed(s.value),h=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,h=!1;break;case"!=":case"not-in":a=bn}ll({value:r,inclusive:i},{value:a,inclusive:h})>0&&(r=a,i=h)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const a=t.position[s];ll({value:r,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(r=a,i=t.inclusive);break}return{value:r,inclusive:i}}class ln{constructor(e,t=null,r=[],i=[],s=null,a="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=h,this.endAt=d,this.wt=null,this._t=null}}function vl(n,e,t,r,i,s,a,h){return new ln(n,e,t,r,i,s,a,h)}function Nn(n){return new ln(n)}function To(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Tu(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Eo(n){for(const e of n.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function Or(n){return null!==n.collectionGroup}function Jn(n){const e=z(n);if(null===e.wt){e.wt=[];const t=Eo(e),r=Tu(e);if(null!==t&&null===r)t.isKeyField()||e.wt.push(new Yn(t)),e.wt.push(new Yn(Me.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Yn(Me.keyField(),s))}}}return e.wt}function ft(n){const e=z(n);if(!e._t)if("F"===e.limitType)e._t=Iu(e.path,e.collectionGroup,Jn(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Jn(e))t.push(new Yn(s.field,"desc"===s.dir?"asc":"desc"));const r=e.endAt?new Qt(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Qt(e.startAt.position,e.startAt.inclusive):null;e._t=Iu(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e._t}function Eu(n,e){e.getFirstInequalityField(),Eo(n);const t=n.filters.concat([e]);return new ln(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vi(n,e,t){return new ln(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function qi(n,e){return Ui(ft(n),ft(e))&&n.limitType===e.limitType}function Il(n){return`${Xn(ft(n))}|lt:${n.limitType}`}function Au(n){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>_l(r)).join(", ")}]`),Ni(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Rr(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Rr(r)).join(",")),`Target(${t})`}(ft(n))}; limitType=${n.limitType})`}function Bi(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Z.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of Jn(t))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,s,a){const h=mu(i,s,a);return i.inclusive?h<=0:h<0}(t.startAt,Jn(t),r)||t.endAt&&!function(i,s,a){const h=mu(i,s,a);return i.inclusive?h>=0:h>0}(t.endAt,Jn(t),r)));var t,r}function Mr(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wl(n){return(e,t)=>{let r=!1;for(const i of Jn(n)){const s=Tl(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function Tl(n,e,t){const r=n.field.isKeyField()?Z.comparator(e.key,t.key):function(i,s,a){const h=s.data.field(i),d=a.data.field(i);return null!==h&&null!==d?kn(h,d):H()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}class hn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){An(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return cu(this.inner)}size(){return this.innerSize}}const sd=new xe(Z.comparator);function wt(){return sd}const El=new xe(Z.comparator);function Lr(...n){let e=El;for(const t of n)e=e.insert(t.key,t);return e}function Ao(n){let e=El;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Vt(){return Gi()}function Su(){return Gi()}function Gi(){return new hn(n=>n.toString(),(n,e)=>n.isEqual(e))}const bu=new xe(Z.comparator),od=new De(Z.comparator);function re(...n){let e=od;for(const t of n)e=e.add(t);return e}const Zi=new De(ae);function So(){return Zi}function Al(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kn(e)?"-0":e}}function bo(n){return{integerValue:""+n}}function xo(n,e){return Xc(e)?bo(e):Al(n,e)}class ko{constructor(){this._=void 0}}function Sl(n,e,t){return n instanceof er?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&po(i)&&(i=mo(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):n instanceof tr?bl(n,e):n instanceof nr?xu(n,e):function(r,i){const s=dn(r,i),a=Co(s)+Co(r.gt);return du(s)&&du(r.gt)?bo(a):Al(r.serializer,a)}(n,e)}function ad(n,e,t){return n instanceof tr?bl(n,e):n instanceof nr?xu(n,e):t}function dn(n,e){return n instanceof Je?du(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class er extends ko{}class tr extends ko{constructor(e){super(),this.elements=e}}function bl(n,e){const t=No(e);for(const r of n.elements)t.some(i=>Ut(i,r))||t.push(r);return{arrayValue:{values:t}}}class nr extends ko{constructor(e){super(),this.elements=e}}function xu(n,e){let t=No(e);for(const r of n.elements)t=t.filter(i=>!Ut(i,r));return{arrayValue:{values:t}}}class Je extends ko{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Co(n){return $e(n.integerValue||n.doubleValue)}function No(n){return Li(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class zi{constructor(e,t){this.field=e,this.transform=t}}class $i{constructor(e,t){this.version=e,this.transformResults=t}}class Pe{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Pe}static exists(e){return new Pe(void 0,e)}static updateTime(e){return new Pe(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ji(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class Ro{}function Do(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new g(n.key,Pe.none()):new c(n.key,n.data,Pe.none());{const t=n.data,r=Xe.empty();let i=new De(Me.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);null===a&&s.length>1&&(s=s.popLast(),a=t.field(s)),null===a?r.delete(s):r.set(s,a),i=i.add(s)}return new o(n.key,r,new It(i.toArray()),Pe.none())}}function ud(n,e,t){n instanceof c?function(r,i,s){const a=r.value.clone(),h=l(r.fieldTransforms,i,s.transformResults);a.setAll(h),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof o?function(r,i,s){if(!ji(r.precondition,i))return void i.convertToUnknownDocument(s.version);const a=l(r.fieldTransforms,i,s.transformResults),h=i.data;h.setAll(u(r)),h.setAll(a),i.convertToFoundDocument(s.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Hi(n,e,t,r){return n instanceof c?function(i,s,a,h){if(!ji(i.precondition,s))return a;const d=i.value.clone(),m=p(i.fieldTransforms,h,s);return d.setAll(m),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof o?function(i,s,a,h){if(!ji(i.precondition,s))return a;const d=p(i.fieldTransforms,h,s),m=s.data;return m.setAll(u(i)),m.setAll(d),s.convertToFoundDocument(s.version,m).setHasLocalMutations(),null===a?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(n,e,t,r):(a=t,ji(n.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a);var s,a}function cd(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=dn(r.transform,i||null);null!=s&&(null===t&&(t=Xe.empty()),t.set(r.field,s))}return t||null}function xl(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&kr(t,r,(i,s)=>function fn(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof tr&&r instanceof tr||t instanceof nr&&r instanceof nr?kr(t.elements,r.elements,Ut):t instanceof Je&&r instanceof Je?Ut(t.gt,r.gt):t instanceof er&&r instanceof er);var t,r}(i,s))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class c extends Ro{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class o extends Ro{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function u(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function l(n,e,t){const r=new Map;X(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],a=s.transform,h=e.data.field(s.field);r.set(s.field,ad(a,h,t[i]))}return r}function p(n,e,t){const r=new Map;for(const i of n){const s=i.transform,a=t.data.field(i.field);r.set(i.field,Sl(s,a,e))}return r}class g extends Ro{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A extends Ro{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class x{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ud(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Hi(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Hi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Su();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let h=this.applyToLocalView(a,s.mutatedFields);h=t.has(i.key)?null:h;const d=Do(a,h);null!==d&&r.set(i.key,d),a.isValidDocument()||a.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),re())}isEqual(e){return this.batchId===e.batchId&&kr(this.mutations,e.mutations,(t,r)=>xl(t,r))&&kr(this.baseMutations,e.baseMutations,(t,r)=>xl(t,r))}}class F{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){X(e.mutations.length===r.length);let i=bu;const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new F(e,t,r,i)}}class B{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class W{constructor(e,t){this.count=e,this.unchangedNames=t}}var he,le;function Ki(n){switch(n){default:return H();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function ku(n){if(void 0===n)return Ve("GRPC error has no .code"),N.UNKNOWN;switch(n){case he.OK:return N.OK;case he.CANCELLED:return N.CANCELLED;case he.UNKNOWN:return N.UNKNOWN;case he.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case he.INTERNAL:return N.INTERNAL;case he.UNAVAILABLE:return N.UNAVAILABLE;case he.UNAUTHENTICATED:return N.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case he.NOT_FOUND:return N.NOT_FOUND;case he.ALREADY_EXISTS:return N.ALREADY_EXISTS;case he.PERMISSION_DENIED:return N.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case he.ABORTED:return N.ABORTED;case he.OUT_OF_RANGE:return N.OUT_OF_RANGE;case he.UNIMPLEMENTED:return N.UNIMPLEMENTED;case he.DATA_LOSS:return N.DATA_LOSS;default:return H()}}(le=he||(he={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";class Wi{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Qi}static getOrCreateInstance(){return null===Qi&&(Qi=new Wi),Qi}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Qi=null;function Cu(){return new TextEncoder}const Nu=new Sr([4294967295,4294967295],0);function Ru(n){const e=Cu().encode(n),t=new wn;return t.update(e),new Uint8Array(t.digest())}function Du(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Sr([t,r],0),new Sr([i,s],0)]}class Yi{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fr(`Invalid padding: ${t}`);if(r<0)throw new Fr(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new Fr(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new Fr(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Sr.fromNumber(this.It)}Et(e,t,r){let i=e.add(t.multiply(Sr.fromNumber(r)));return 1===i.compare(Nu)&&(i=new Sr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=Ru(e),[r,i]=Du(t);for(let s=0;s<this.hashCount;s++){const a=this.Et(r,i,s);if(!this.At(a))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Yi(s,i,t);return r.forEach(h=>a.insert(h)),a}insert(e){if(0===this.It)return;const t=Ru(e),[r,i]=Du(t);for(let s=0;s<this.hashCount;s++){const a=this.Et(r,i,s);this.Rt(a)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Fr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xi{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,rr.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Xi(Y.min(),i,new xe(ae),wt(),re())}}class rr{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new rr(r,t,re(),re(),re())}}class Po{constructor(e,t,r,i){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=i}}class Mp{constructor(e,t){this.targetId=e,this.Vt=t}}class Lp{constructor(e,t,r=Ye.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Fp{constructor(){this.St=0,this.Dt=Vp(),this.Ct=Ye.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=re(),t=re(),r=re();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H()}}),new rr(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=Vp()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class V_{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=wt(),this.zt=Up(),this.Wt=new xe(ae)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:H()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,i)=>{this.te(i)&&t(i)})}ne(e){var t;const r=e.targetId,i=e.Vt.count,s=this.se(r);if(s){const a=s.target;if(vo(a))if(0===i){const h=new Z(a.path);this.Yt(r,h,Le.newNoDocument(h,Y.min()))}else X(1===i);else{const h=this.ie(r);if(h!==i){const d=this.re(e,h);0!==d&&(this.ee(r),this.Wt=this.Wt.insert(r,2===d?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=Wi.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(m,y,w){var k,D,q,G,$,oe;const me={localCacheCount:y,existenceFilterCount:w.count},ue=w.unchangedNames;return ue&&(me.bloomFilter={applied:0===m,hashCount:null!==(k=null==ue?void 0:ue.hashCount)&&void 0!==k?k:0,bitmapLength:null!==(G=null===(q=null===(D=null==ue?void 0:ue.bits)||void 0===D?void 0:D.bitmap)||void 0===q?void 0:q.length)&&void 0!==G?G:0,padding:null!==(oe=null===($=null==ue?void 0:ue.bits)||void 0===$?void 0:$.padding)&&void 0!==oe?oe:0}),me}(d,h,e.Vt))}}}}re(e,t){const{unchangedNames:r,count:i}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:s="",padding:a=0},hashCount:h=0}=r;let d,m;try{d=Ft(s).toUint8Array()}catch(y){if(y instanceof sl)return Mt("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw y}try{m=new Yi(d,a,h)}catch(y){return Mt(y instanceof Fr?"BloomFilter error: ":"Applying bloom filter failed: ",y),1}return 0===m.It?1:i!==t-this.oe(e.targetId,m)?2:0}oe(e,t){const r=this.Gt.getRemoteKeysForTarget(e);let i=0;return r.forEach(s=>{const a=this.Gt.ue(),h=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.vt(h)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,a)=>{const h=this.se(a);if(h){if(s.current&&vo(h.target)){const d=new Z(h.target.path);null!==this.jt.get(d)||this.ae(a,d)||this.Yt(a,d,Le.newNoDocument(d,e))}s.Mt&&(t.set(a,s.Ot()),s.Ft())}});let r=re();this.zt.forEach((s,a)=>{let h=!0;a.forEachWhile(d=>{const m=this.se(d);return!m||"TargetPurposeLimboResolution"===m.purpose||(h=!1,!1)}),h&&(r=r.add(s))}),this.jt.forEach((s,a)=>a.setReadTime(e));const i=new Xi(e,t,this.Wt,this.jt,r);return this.jt=wt(),this.zt=Up(),this.Wt=new xe(ae),i}Jt(e,t){if(!this.te(e))return;const r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Fp,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new De(ae),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||U("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Fp),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Up(){return new xe(Z.comparator)}function Vp(){return new xe(Z.comparator)}const q_={asc:"ASCENDING",desc:"DESCENDING"},B_={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},G_={and:"AND",or:"OR"};class Z_{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ld(n,e){return n.useProto3Json||Ni(e)?e:{value:e}}function Oo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function z_(n,e){return Oo(n,e.toTimestamp())}function et(n){return X(!!n),Y.fromTimestamp(function(e){const t=cn(e);return new Oe(t.seconds,t.nanos)}(n))}function hd(n,e){return(t=n,new _e(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function Bp(n){const e=_e.fromString(n);return X(Qp(e)),e}function Pu(n,e){return hd(n.databaseId,e.path)}function Rn(n,e){const t=Bp(e);if(t.get(1)!==n.databaseId.projectId)throw new M(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Z(Zp(t))}function dd(n,e){return hd(n.databaseId,e)}function Gp(n){const e=Bp(n);return 4===e.length?_e.emptyPath():Zp(e)}function Ou(n){return new _e(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Zp(n){return X(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function zp(n,e,t){return{name:Pu(n,e),fields:t.value.mapValue.fields}}function $p(n,e,t){const r=Rn(n,e.name),i=et(e.updateTime),s=e.createTime?et(e.createTime):Y.min(),a=new Xe({mapValue:{fields:e.fields}}),h=Le.newFoundDocument(r,i,s,a);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function Mu(n,e){let t;if(e instanceof c)t={update:zp(n,e.key,e.value)};else if(e instanceof g)t={delete:Pu(n,e.key)};else if(e instanceof o)t={update:zp(n,e.key,e.data),updateMask:X_(e.fieldMask)};else{if(!(e instanceof A))return H();t={verify:Pu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const a=s.transform;if(a instanceof er)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof tr)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nr)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Je)return{fieldPath:s.field.canonicalString(),increment:a.gt};throw H()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:z_(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:H()),t;var i}function fd(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Pe.updateTime(et(i.updateTime)):void 0!==i.exists?Pe.exists(i.exists):Pe.none():Pe.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let h=null;"setToServerValue"in a?(X("REQUEST_TIME"===a.setToServerValue),h=new er):"appendMissingElements"in a?h=new tr(a.appendMissingElements.values||[]):"removeAllFromArray"in a?h=new nr(a.removeAllFromArray.values||[]):"increment"in a?h=new Je(s,a.increment):H();const d=Me.fromServerFormat(a.fieldPath);return new zi(d,h)}(n,i)):[];var i;if(e.update){const i=Rn(n,e.update.name),s=new Xe({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=new It((e.updateMask.fieldPaths||[]).map(m=>Me.fromServerFormat(m)));return new o(i,s,a,t,r)}return new c(i,s,t,r)}if(e.delete){const i=Rn(n,e.delete);return new g(i,t)}if(e.verify){const i=Rn(n,e.verify);return new A(i,t)}return H()}function jp(n,e){return{documents:[dd(n,e.path)]}}function pd(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=dd(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=dd(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(d){if(0!==d.length)return Wp(Te.create(d,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(d){if(0!==d.length)return d.map(m=>{return{field:Ur((y=m).field),direction:W_(y.dir)};var y})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=ld(n,e.limit);var h,d;return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(d=e.endAt).inclusive,values:d.position}),t}function Hp(n){let e=Gp(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){X(1===r);const y=t.from[0];y.allDescendants?i=y.collectionId:e=e.child(y.collectionId)}let s=[];t.where&&(s=function(y){const w=Kp(y);return w instanceof Te&&_o(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=t.orderBy.map(y=>{return new Yn(Mo((w=y).field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction));var w}));let h=null;t.limit&&(h=function(y){let w;return w="object"==typeof y?y.value:y,Ni(w)?null:w}(t.limit));let d=null;var y;t.startAt&&(d=new Qt((y=t.startAt).values||[],!!y.before));let m=null;return t.endAt&&(m=function(y){return new Qt(y.values||[],!y.before)}(t.endAt)),vl(e,i,a,s,h,"F",d,m)}function Kp(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Mo(e.unaryFilter.field);return ge.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=Mo(e.unaryFilter.field);return ge.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Mo(e.unaryFilter.field);return ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Mo(e.unaryFilter.field);return ge.create(s,"!=",{nullValue:"NULL_VALUE"});default:return H()}}(n):void 0!==n.fieldFilter?ge.create(Mo((e=n).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return Te.create(e.compositeFilter.filters.map(t=>Kp(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return H()}}(e.compositeFilter.op))}(n):H();var e}function W_(n){return q_[n]}function Q_(n){return B_[n]}function Y_(n){return G_[n]}function Ur(n){return{fieldPath:n.canonicalString()}}function Mo(n){return Me.fromServerFormat(n.fieldPath)}function Wp(n){return n instanceof ge?function(e){if("=="===e.op){if(ul(e.value))return{unaryFilter:{field:Ur(e.field),op:"IS_NAN"}};if(al(e.value))return{unaryFilter:{field:Ur(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ul(e.value))return{unaryFilter:{field:Ur(e.field),op:"IS_NOT_NAN"}};if(al(e.value))return{unaryFilter:{field:Ur(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ur(e.field),op:Q_(e.op),value:e.value}}}(n):n instanceof Te?function(e){const t=e.getFilters().map(r=>Wp(r));return 1===t.length?t[0]:{compositeFilter:{op:Y_(e.op),filters:t}}}(n):H()}function X_(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Qp(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ir{constructor(e,t,r,i,s=Y.min(),a=Y.min(),h=Ye.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Yp{constructor(e){this.fe=e}}function Xp(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:kl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Pu(i=n.fe,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:Oo(i,s.version.toTimestamp()),createTime:Oo(i,s.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ji(e.version)};else{if(!e.isUnknownDocument())return H();r.unknownDocument={path:t.path.toArray(),version:Ji(e.version)}}var i,s;return r}function kl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ji(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function es(n){const e=new Oe(n.seconds,n.nanoseconds);return Y.fromTimestamp(e)}function ts(n,e){const t=(e.baseMutations||[]).map(s=>fd(n.fe,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>fd(n.fe,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new x(e.batchId,i,t,r)}function Lu(n){const e=es(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?es(n.lastLimboFreeSnapshotVersion):Y.min();let r;var i;return void 0!==n.query.documents?(X(1===(i=n.query).documents.length),r=ft(Nn(Gp(i.documents[0])))):r=ft(Hp(n.query)),new ir(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ye.fromBase64String(n.resumeToken))}function Jp(n,e){const t=Ji(e.snapshotVersion),r=Ji(e.lastLimboFreeSnapshotVersion);let i;i=vo(e.target)?jp(n.fe,e.target):pd(n.fe,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function md(n){const e=Hp({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Vi(e,e.limit,"L"):e}function gd(n,e){return new B(e.largestBatchId,fd(n.fe,e.overlayMutation))}function em(n,e){const t=e.path.lastSegment();return[n,it(e.path.popLast()),t]}function tm(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Ji(r.readTime),documentKey:it(r.documentKey.path),largestBatchId:r.largestBatchId}}class ey{getBundleMetadata(e,t){return nm(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:es(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return nm(e).put({bundleId:(r=t).id,createTime:Ji(et(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return rm(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:md(i.bundledQuery),readTime:es(i.readTime)};var i})}saveNamedQuery(e,t){return rm(e).put({name:(r=t).name,readTime:Ji(et(r.readTime)),bundledQuery:r.bundledQuery});var r}}function nm(n){return Qe(n,"bundles")}function rm(n){return Qe(n,"namedQueries")}class Cl{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){return new Cl(e,t.uid||"")}getOverlay(e,t){return Fu(e).get(em(this.userId,t)).next(r=>r?gd(this.serializer,r):null)}getOverlays(e,t){const r=Vt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,a)=>{const h=new B(t,a);i.push(this.we(e,h))}),C.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(a=>i.add(it(a.getCollectionPath())));const s=[];return i.forEach(a=>{const h=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,r+1],!1,!0);s.push(Fu(e).J("collectionPathOverlayIndex",h))}),C.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Vt(),s=it(t),a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Fu(e).j("collectionPathOverlayIndex",a).next(h=>{for(const d of h){const m=gd(this.serializer,d);i.set(m.getKey(),m)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Vt();let a;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fu(e).X({index:"collectionGroupOverlayIndex",range:h},(d,m,y)=>{const w=gd(this.serializer,m);s.size()<i||w.largestBatchId===a?(s.set(w.getKey(),w),a=w.largestBatchId):y.done()}).next(()=>s)}we(e,t){return Fu(e).put(function(r,i,s){const[a,h,d]=em(i,s.mutation.key);return{userId:i,collectionPath:h,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Mu(r.fe,s.mutation)}}(this.serializer,this.userId,t))}}function Fu(n){return Qe(n,"documentOverlays")}class ns{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe($e(e.integerValue));else if("doubleValue"in e){const r=$e(e.doubleValue);isNaN(r)?this.ye(t,13):(this.ye(t,15),Kn(r)?t.pe(0):t.pe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ye(t,20),"string"==typeof r?t.Ie(r):(t.Ie(`${r.seconds||""}`),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Ft(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ye(t,45),t.pe(r.latitude||0),t.pe(r.longitude||0)}else"mapValue"in e?cl(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):H()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const r=e.fields||{};this.ye(t,55);for(const i of Object.keys(r))this.Te(i,t),this.me(r[i],t)}Pe(e,t){const r=e.values||[];this.ye(t,50);for(const i of r)this.me(i,t)}ve(e,t){this.ye(t,37),Z.fromName(e).path.forEach(r=>{this.ye(t,60),this.be(r,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function ty(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function im(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const s=ty(255&t[i]);if(r+=s,8!==s)break}return r}(n);return Math.ceil(e/8)}ns.Ve=new ns;class ny{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.De(r.value),r=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ne(r.value),r=t.next();this.ke()}Me(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const i=t.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const i=t.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(e){const t=this.Fe(e),r=im(t);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Le(e){const t=this.Fe(e),r=im(t);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class ry{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class iy{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Uu{constructor(){this.je=new ny,this.ze=new ry(this.je),this.We=new iy(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}class rs{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new rs(this.indexId,this.documentKey,this.arrayValue,r)}}function Vr(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=sm(n.arrayValue,e.arrayValue),0!==t?t:(t=sm(n.directionalValue,e.directionalValue),0!==t?t:Z.comparator(n.documentKey,e.documentKey)))}function sm(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class sy{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const r=t;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){X(e.collectionGroup===this.collectionId);const t=Ya(e);if(void 0!==t&&!this.en(t))return!1;const r=jn(e);let i=new Set,s=0,a=0;for(;s<r.length&&this.en(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(void 0!==this.Ze){if(!i.has(this.Ze.field.canonicalString())){const h=r[s];if(!this.nn(this.Ze,h)||!this.sn(this.Ye[a++],h))return!1}++s}for(;s<r.length;++s)if(a>=this.Ye.length||!this.sn(this.Ye[a++],r[s]))return!1;return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function om(n){var e,t;if(X(n instanceof ge||n instanceof Te),n instanceof ge){if(n instanceof yo){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>ge.create(n.field,"==",s)))||[];return Te.create(i,"or")}return n}const r=n.filters.map(i=>om(i));return Te.create(r,n.op)}function oy(n){if(0===n.getFilters().length)return[];const e=vd(om(n));return X(am(e)),_d(e)||yd(e)?[e]:e.getFilters()}function _d(n){return n instanceof ge}function yd(n){return n instanceof Te&&_o(n)}function am(n){return _d(n)||yd(n)||function(e){if(e instanceof Te&&gu(e)){for(const t of e.getFilters())if(!_d(t)&&!yd(t))return!1;return!0}return!1}(n)}function vd(n){if(X(n instanceof ge||n instanceof Te),n instanceof ge)return n;if(1===n.filters.length)return vd(n.filters[0]);const e=n.filters.map(r=>vd(r));let t=Te.create(e,n.op);return t=Nl(t),am(t)?t:(X(t instanceof Te),X(Pr(t)),X(t.filters.length>1),t.filters.reduce((r,i)=>Id(r,i)))}function Id(n,e){let t;return X(n instanceof ge||n instanceof Te),X(e instanceof ge||e instanceof Te),t=n instanceof ge?e instanceof ge?Te.create([n,e],"and"):um(n,e):e instanceof ge?um(e,n):function(r,i){if(X(r.filters.length>0&&i.filters.length>0),Pr(r)&&Pr(i))return gl(r,i.getFilters());const s=gu(r)?r:i,a=gu(r)?i:r,h=s.filters.map(d=>Id(d,a));return Te.create(h,"or")}(n,e),Nl(t)}function um(n,e){if(Pr(e))return gl(e,n.getFilters());{const t=e.filters.map(r=>Id(n,r));return Te.create(t,"or")}}function Nl(n){if(X(n instanceof ge||n instanceof Te),n instanceof ge)return n;const e=n.getFilters();if(1===e.length)return Nl(e[0]);if(pl(n))return n;const t=e.map(i=>Nl(i)),r=[];return t.forEach(i=>{i instanceof ge?r.push(i):i instanceof Te&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Te.create(r,n.op)}class ay{constructor(){this.rn=new wd}addToCollectionParentIndex(e,t){return this.rn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(bt.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}}class wd{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new De(_e.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new De(_e.comparator)).toArray()}}const Rl=new Uint8Array(0);class uy{constructor(e,t){this.user=e,this.databaseId=t,this.on=new wd,this.un=new hn(r=>Xn(r),(r,i)=>Ui(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const s={collectionId:r,parent:it(i)};return cm(e).put(s)}return C.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Hc(t),""],!1,!0);return cm(e).j(i).next(s=>{for(const a of s){if(a.collectionId!==t)break;r.push(Lt(a.parent))}return r})}addFieldIndex(e,t){const r=Dl(e),i={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var a;delete i.indexId;const s=r.add(i);if(t.indexState){const a=qu(e);return s.next(h=>{a.put(tm(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Dl(e),i=qu(e),s=Vu(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=Vu(e);let i=!0;const s=new Map;return C.forEach(this.cn(t),a=>this.an(e,a).next(h=>{i&&(i=!!h),s.set(a,h)})).next(()=>{if(i){let a=re();const h=[];return C.forEach(s,(d,m)=>{var y;U("IndexedDbIndexManager",`Using index ${y=d,`id=${y.indexId}|cg=${y.collectionGroup}|f=${y.fields.map(ue=>`${ue.fieldPath}:${ue.kind}`).join(",")}`} to execute ${Xn(t)}`);const w=function(ue,fe){const ve=Ya(fe);if(void 0===ve)return null;for(const Ie of Io(ue,ve.fieldPath))switch(Ie.op){case"array-contains-any":return Ie.value.arrayValue.values||[];case"array-contains":return[Ie.value]}return null}(m,d),k=function(ue,fe){const ve=new Map;for(const Ie of jn(fe))for(const At of Io(ue,Ie.fieldPath))switch(At.op){case"==":case"in":ve.set(Ie.fieldPath.canonicalString(),At.value);break;case"not-in":case"!=":return ve.set(Ie.fieldPath.canonicalString(),At.value),Array.from(ve.values())}return null}(m,d),D=function(ue,fe){const ve=[];let Ie=!0;for(const At of jn(fe)){const fs=0===At.kind?wu(ue,At.fieldPath,ue.startAt):wo(ue,At.fieldPath,ue.startAt);ve.push(fs.value),Ie&&(Ie=fs.inclusive)}return new Qt(ve,Ie)}(m,d),q=function(ue,fe){const ve=[];let Ie=!0;for(const At of jn(fe)){const fs=0===At.kind?wo(ue,At.fieldPath,ue.endAt):wu(ue,At.fieldPath,ue.endAt);ve.push(fs.value),Ie&&(Ie=fs.inclusive)}return new Qt(ve,Ie)}(m,d),G=this.hn(d,m,D),$=this.hn(d,m,q),oe=this.ln(d,m,k),me=this.fn(d.indexId,w,G,D.inclusive,$,q.inclusive,oe);return C.forEach(me,ue=>r.H(ue,t.limit).next(fe=>{fe.forEach(ve=>{const Ie=Z.fromSegments(ve.documentKey);a.has(Ie)||(a=a.add(Ie),h.push(Ie))})}))}).next(()=>h)}return C.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:oy(Te.create(e.filters,"and")).map(r=>Iu(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,r,i,s,a,h){const d=(null!=t?t.length:1)*Math.max(r.length,s.length),m=d/(null!=t?t.length:1),y=[];for(let w=0;w<d;++w){const k=t?this.dn(t[w/m]):Rl,D=this.wn(e,k,r[w%m],i),q=this._n(e,k,s[w%m],a),G=h.map($=>this.wn(e,k,$,!0));y.push(...this.createRange(D,q,G))}return y}wn(e,t,r,i){const s=new rs(e,Z.empty(),t,r);return i?s:s.Je()}_n(e,t,r,i){const s=new rs(e,Z.empty(),t,r);return i?s.Je():s}an(e,t){const r=new sy(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(const h of s)r.tn(h)&&(!a||h.fields.length>a.fields.length)&&(a=h);return a})}getIndexType(e,t){let r=2;const i=this.cn(t);return C.forEach(i,s=>this.an(e,s).next(a=>{a?0!==r&&a.fields.length<function(h){let d=new De(Me.comparator),m=!1;for(const y of h.filters)for(const w of y.getFlattenedFilters())w.field.isKeyField()||("array-contains"===w.op||"array-contains-any"===w.op?m=!0:d=d.add(w.field));for(const y of h.orderBy)y.field.isKeyField()||(d=d.add(y.field));return d.size+(m?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}mn(e,t){const r=new Uu;for(const i of jn(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const a=r.He(i.kind);ns.Ve._e(s,a)}return r.Qe()}dn(e){const t=new Uu;return ns.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const r=new Uu;return ns.Ve._e(Wn(this.databaseId,t),r.He(function(i){const s=jn(i);return 0===s.length?0:s[s.length-1].kind}(e))),r.Qe()}ln(e,t,r){if(null===r)return[];let i=[];i.push(new Uu);let s=0;for(const a of jn(e)){const h=r[s++];for(const d of i)if(this.yn(t,a.fieldPath)&&Li(h))i=this.pn(i,a,h);else{const m=d.He(a.kind);ns.Ve._e(h,m)}}return this.In(i)}hn(e,t,r){return this.ln(e,t,r.position)}In(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Qe();return t}pn(e,t,r){const i=[...e],s=[];for(const a of r.arrayValue.values||[])for(const h of i){const d=new Uu;d.seed(h.Qe()),ns.Ve._e(a,d.He(t.kind)),s.push(d)}return s}yn(e,t){return!!e.filters.find(r=>r instanceof ge&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Dl(e),i=qu(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next(s=>{const a=[];return C.forEach(s,h=>i.get([h.indexId,this.uid]).next(d=>{a.push(function(m,y){const w=y?new xi(y.sequenceNumber,new bt(es(y.readTime),new Z(Lt(y.documentKey)),y.largestBatchId)):xi.empty(),k=m.fields.map(([D,q])=>new bi(Me.fromServerFormat(D),q));return new so(m.indexId,m.collectionGroup,k,w)}(h,d))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:ae(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Dl(e),s=qu(e);return this.Tn(e).next(a=>i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>C.forEach(h,d=>s.put(tm(d.indexId,this.user,a,r)))))}updateIndexEntries(e,t){const r=new Map;return C.forEach(t,(i,s)=>{const a=r.get(i.collectionGroup);return(a?C.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),C.forEach(h,d=>this.En(e,i,d).next(m=>{const y=this.An(s,d);return m.isEqual(y)?C.resolve():this.vn(e,s,d,m,y)}))))})}Rn(e,t,r,i){return Vu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,r,i){return Vu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}En(e,t,r){const i=Vu(e);let s=new De(Vr);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(a,h)=>{s=s.add(new rs(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>s)}An(e,t){let r=new De(Vr);const i=this.mn(t,e);if(null==i)return r;const s=Ya(t);if(null!=s){const a=e.data.field(s.fieldPath);if(Li(a))for(const h of a.arrayValue.values||[])r=r.add(new rs(t.indexId,e.key,this.dn(h),i))}else r=r.add(new rs(t.indexId,e.key,Rl,i));return r}vn(e,t,r,i,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(h,d,m,y,w){const k=h.getIterator(),D=d.getIterator();let q=Nr(k),G=Nr(D);for(;q||G;){let $=!1,oe=!1;if(q&&G){const me=m(q,G);me<0?oe=!0:me>0&&($=!0)}else null!=q?oe=!0:$=!0;$?(y(G),G=Nr(D)):oe?(w(q),q=Nr(k)):(q=Nr(k),G=Nr(D))}}(i,s,Vr,h=>{a.push(this.Rn(e,t,r,h))},h=>{a.push(this.Pn(e,t,r,h))}),C.waitFor(a)}Tn(e){let t=1;return qu(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((a,h)=>Vr(a,h)).filter((a,h,d)=>!h||0!==Vr(a,d[h-1]));const i=[];i.push(e);for(const a of r){const h=Vr(a,e),d=Vr(a,t);if(0===h)i[0]=e.Je();else if(h>0&&d<0)i.push(a),i.push(a.Je());else if(d>0)break}i.push(t);const s=[];for(let a=0;a<i.length;a+=2){if(this.bn(i[a],i[a+1]))return[];s.push(IDBKeyRange.bound([i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Rl,[]],[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Rl,[]]))}return s}bn(e,t){return Vr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lm)}getMinOffset(e,t){return C.mapArray(this.cn(t),r=>this.an(e,r).next(i=>i||H())).next(lm)}}function cm(n){return Qe(n,"collectionParents")}function Vu(n){return Qe(n,"indexEntries")}function Dl(n){return Qe(n,"indexConfiguration")}function qu(n){return Qe(n,"indexState")}function lm(n){X(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;ki(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new bt(e.readTime,e.documentKey,t)}const hm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Tt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Tt(e,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function dm(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let h=0;const d=r.X({range:a},(y,w,k)=>(h++,k.delete()));s.push(d.next(()=>{X(1===h)}));const m=[];for(const y of t.mutations){const w=el(e,y.key.path,t.batchId);s.push(i.delete(w)),m.push(y.key)}return C.waitFor(s).next(()=>m)}function Pl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw H();e=n.noDocument}return JSON.stringify(e).length}Tt.DEFAULT_COLLECTION_PERCENTILE=10,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tt.DEFAULT=new Tt(41943040,Tt.DEFAULT_COLLECTION_PERCENTILE,Tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tt.DISABLED=new Tt(-1,0,0);class Ol{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(e,t,r,i){X(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Ol(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).X({index:"userMutationsIndex",range:r},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Lo(e),a=qr(e);return a.add({}).next(h=>{X("number"==typeof h);const d=new x(h,t,r,i),m=function(k,D,q){const G=q.baseMutations.map(oe=>Mu(k.fe,oe)),$=q.mutations.map(oe=>Mu(k.fe,oe));return{userId:D,batchId:q.batchId,localWriteTimeMs:q.localWriteTime.toMillis(),baseMutations:G,mutations:$}}(this.serializer,this.userId,d),y=[];let w=new De((k,D)=>ae(k.canonicalString(),D.canonicalString()));for(const k of i){const D=el(this.userId,k.key.path,h);w=w.add(k.key.path.popLast()),y.push(a.put(m)),y.push(s.put(D,$h))}return w.forEach(k=>{y.push(this.indexManager.addToCollectionParentIndex(e,k))}),e.addOnCommittedListener(()=>{this.Vn[h]=d.keys()}),C.waitFor(y).next(()=>d)})}lookupMutationBatch(e,t){return qr(e).get(t).next(r=>r?(X(r.userId===this.userId),ts(this.serializer,r)):null)}Sn(e,t){return this.Vn[t]?C.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Vn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return qr(e).X({index:"userMutationsIndex",range:i},(a,h,d)=>{h.userId===this.userId&&(X(h.batchId>=r),s=ts(this.serializer,h)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return qr(e).X({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{r=s.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qr(e).j("userMutationsIndex",t).next(r=>r.map(i=>ts(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=En(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Lo(e).X({range:i},(a,h,d)=>{const[m,y,w]=a,k=Lt(y);if(m===this.userId&&t.path.isEqual(k))return qr(e).get(w).next(D=>{if(!D)throw H();X(D.userId===this.userId),s.push(ts(this.serializer,D))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new De(ae);const i=[];return t.forEach(s=>{const a=En(this.userId,s.path),h=IDBKeyRange.lowerBound(a),d=Lo(e).X({range:h},(m,y,w)=>{const[k,D,q]=m,G=Lt(D);k===this.userId&&s.path.isEqual(G)?r=r.add(q):w.done()});i.push(d)}),C.waitFor(i).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=En(this.userId,r),a=IDBKeyRange.lowerBound(s);let h=new De(ae);return Lo(e).X({range:a},(d,m,y)=>{const[w,k,D]=d,q=Lt(k);w===this.userId&&r.isPrefixOf(q)?q.length===i&&(h=h.add(D)):y.done()}).next(()=>this.Dn(e,h))}Dn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(qr(e).get(s).next(a=>{if(null===a)throw H();X(a.userId===this.userId),r.push(ts(this.serializer,a))}))}),C.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return dm(e.ht,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),C.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Lo(e).X({range:r},(s,a,h)=>{if(s[0]===this.userId){const d=Lt(s[1]);i.push(d)}else h.done()}).next(()=>{X(0===i.length)})})}containsKey(e,t){return fm(e,this.userId,t)}xn(e){return pm(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fm(n,e,t){const r=En(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return Lo(n).X({range:s,Y:!0},(h,d,m)=>{const[y,w,k]=h;y===e&&w===i&&(a=!0),m.done()}).next(()=>a)}function qr(n){return Qe(n,"mutations")}function Lo(n){return Qe(n,"documentMutations")}function pm(n){return Qe(n,"mutationQueues")}class is{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new is(0)}static Mn(){return new is(-1)}}class cy{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const r=new is(t.highestTargetId);return t.highestTargetId=r.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>Y.fromTimestamp(new Oe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.$n(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.On(e,i)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(t,r),this.On(e,r))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Fo(e).delete(t.targetId)).next(()=>this.$n(e)).next(r=>(X(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Fo(e).X((a,h)=>{const d=Lu(h);d.sequenceNumber<=t&&null===r.get(d.targetId)&&(i++,s.push(this.removeTargetData(e,d)))}).next(()=>C.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Fo(e).X((r,i)=>{const s=Lu(i);t(s)})}$n(e){return mm(e).get("targetGlobalKey").next(t=>(X(null!==t),t))}On(e,t){return mm(e).put("targetGlobalKey",t)}Fn(e,t){return Fo(e).put(Jp(this.serializer,t))}Bn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Xn(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Fo(e).X({range:i,index:"queryTargetsIndex"},(a,h,d)=>{const m=Lu(h);Ui(t,m.target)&&(s=m,d.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Br(e);return t.forEach(a=>{const h=it(a.path);i.push(s.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,a))}),C.waitFor(i)}removeMatchingKeys(e,t,r){const i=Br(e);return C.forEach(t,s=>{const a=it(s.path);return C.waitFor([i.delete([r,a]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Br(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Br(e);let s=re();return i.X({range:r,Y:!0},(a,h,d)=>{const m=Lt(a[1]),y=new Z(m);s=s.add(y)}).next(()=>s)}containsKey(e,t){const r=it(t.path),i=IDBKeyRange.bound([r],[Hc(r)],!1,!0);let s=0;return Br(e).X({index:"documentTargetsIndex",Y:!0,range:i},([a,h],d,m)=>{0!==a&&(s++,m.done())}).next(()=>s>0)}le(e,t){return Fo(e).get(t).next(r=>r?Lu(r):null)}}function Fo(n){return Qe(n,"targets")}function mm(n){return Qe(n,"targetGlobal")}function Br(n){return Qe(n,"targetDocuments")}function gm([n,e],[t,r]){const i=ae(n,t);return 0===i?ae(e,r):i}class ly{constructor(e){this.Ln=e,this.buffer=new De(gm),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();gm(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _m{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){var t=this;U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,E.Z)(function*(){t.Gn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){vt(r)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Tn(r)}yield t.Qn(3e5)}))}}class hy{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return C.resolve(xt.ct);const r=new ly(t);return this.jn.forEachTarget(e,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(e,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(hm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hm):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let r,i,s,a,h,d,m;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(w=>(w>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),i=this.params.maximumSequenceNumbersToCollect):i=w,a=Date.now(),this.nthSequenceNumber(e,i))).next(w=>(r=w,h=Date.now(),this.removeTargets(e,r,t))).next(w=>(s=w,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(w=>(m=Date.now(),ja()<=je.in.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-y}ms\n\tDetermined least recently used ${i} in `+(h-a)+`ms\n\tRemoved ${s} targets in `+(d-h)+`ms\n\tRemoved ${w} documents in `+(m-d)+`ms\nTotal Duration: ${m-y}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:w})))}}class dy{constructor(e,t){this.db=e,this.garbageCollector=function ym(n,e){return new hy(n,e)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Jn(e){let t=0;return this.Wn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(r,i)=>t(i))}addReference(e,t,r){return Ml(e,r)}removeReference(e,t,r){return Ml(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ml(e,t)}Xn(e,t){return function(r,i){let s=!1;return pm(r).Z(a=>fm(r,a,i).next(h=>(h&&(s=!0),C.resolve(!h)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Yn(e,(a,h)=>{if(h<=t){const d=this.Xn(e,a).next(m=>{if(!m)return s++,r.getEntry(e,a).next(()=>(r.removeEntry(a,Y.min()),Br(e).delete([0,it(a.path)])))});i.push(d)}}).next(()=>C.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ml(e,t)}Yn(e,t){const r=Br(e);let i,s=xt.ct;return r.X({index:"documentTargetsIndex"},([a,h],{path:d,sequenceNumber:m})=>{0===a?(s!==xt.ct&&t(new Z(Lt(i)),s),s=m,i=d):s=xt.ct}).next(()=>{s!==xt.ct&&t(new Z(Lt(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ml(n,e){return Br(n).put((r=n.currentSequenceNumber,{targetId:0,path:it(e.path),sequenceNumber:r}));var r}class vm{constructor(){this.changes=new hn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Le.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class fy{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ss(e).put(r)}removeEntry(e,t,r){return ss(e).delete(function(i,s){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],kl(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Zn(e,r)))}getEntry(e,t){let r=Le.newInvalidDocument(t);return ss(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Bu(t))},(i,s)=>{r=this.ts(t,s)}).next(()=>r)}es(e,t){let r={size:0,document:Le.newInvalidDocument(t)};return ss(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Bu(t))},(i,s)=>{r={document:this.ts(t,s),size:Pl(s)}}).next(()=>r)}getEntries(e,t){let r=wt();return this.ns(e,t,(i,s)=>{const a=this.ts(i,s);r=r.insert(i,a)}).next(()=>r)}ss(e,t){let r=wt(),i=new xe(Z.comparator);return this.ns(e,t,(s,a)=>{const h=this.ts(s,a);r=r.insert(s,h),i=i.insert(s,Pl(a))}).next(()=>({documents:r,rs:i}))}ns(e,t,r){if(t.isEmpty())return C.resolve();let i=new De(Em);t.forEach(d=>i=i.add(d));const s=IDBKeyRange.bound(Bu(i.first()),Bu(i.last())),a=i.getIterator();let h=a.getNext();return ss(e).X({index:"documentKeyIndex",range:s},(d,m,y)=>{const w=Z.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;h&&Em(h,w)<0;)r(h,null),h=a.getNext();h&&h.isEqual(w)&&(r(h,m),h=a.hasNext()?a.getNext():null),h?y.G(Bu(h)):y.done()}).next(()=>{for(;h;)r(h,null),h=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,r,i){const s=t.path,a=[s.popLast().toArray(),s.lastSegment(),kl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ss(e).j(IDBKeyRange.bound(a,h,!0)).next(d=>{let m=wt();for(const y of d){const w=this.ts(Z.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);w.isFoundDocument()&&(Bi(t,w)||i.has(w.key))&&(m=m.insert(w.key,w))}return m})}getAllFromCollectionGroup(e,t,r,i){let s=wt();const a=Tm(t,r),h=Tm(t,bt.max());return ss(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,h,!0)},(d,m,y)=>{const w=this.ts(Z.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);s=s.insert(w.key,w),s.size===i&&y.done()}).next(()=>s)}newChangeBuffer(e){return new py(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return wm(e).get("remoteDocumentGlobalKey").next(t=>(X(!!t),t))}Zn(e,t){return wm(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const r=function J_(n,e){let t;if(e.document)t=$p(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Z.fromSegments(e.noDocument.path),i=es(e.noDocument.readTime);t=Le.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return H();{const r=Z.fromSegments(e.unknownDocument.path),i=es(e.unknownDocument.version);t=Le.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new Oe(r[0],r[1]);return Y.fromTimestamp(i)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(Y.min()))return r}return Le.newInvalidDocument(e)}}function Im(n){return new fy(n)}class py extends vm{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new hn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new De((s,a)=>ae(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const h=this.us.get(s);if(t.push(this.os.removeEntry(e,s,h.readTime)),a.isValidDocument()){const d=Xp(this.os.serializer,a);i=i.add(s.path.popLast());const m=Pl(d);r+=m-h.size,t.push(this.os.addEntry(e,s,d))}else if(r-=h.size,this.trackRemovals){const d=Xp(this.os.serializer,a.convertToNoDocument(Y.min()));t.push(this.os.addEntry(e,s,d))}}),i.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,r)),C.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(r=>(this.us.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:r,rs:i})=>(i.forEach((s,a)=>{this.us.set(s,{size:a,readTime:r.get(s).readTime})}),r))}}function wm(n){return Qe(n,"remoteDocumentGlobal")}function ss(n){return Qe(n,"remoteDocumentsV14")}function Bu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Tm(n,e){const t=e.documentKey.path.toArray();return[n,kl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Em(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ae(t[s],r[s]),i)return i;return i=ae(t.length,r.length),i||(i=ae(t[t.length-2],r[r.length-2]),i||ae(t[t.length-1],r[r.length-1]))}class my{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Am{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&Hi(r.mutation,i,It.empty(),Oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,t,r=re()){const i=Vt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Lr();return s.forEach((h,d)=>{a=a.insert(h,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Vt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,re()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,h)=>{t.set(a,h)})})}computeViews(e,t,r,i){let s=wt();const a=Gi(),h=Gi();return t.forEach((d,m)=>{const y=r.get(m.key);i.has(m.key)&&(void 0===y||y.mutation instanceof o)?s=s.insert(m.key,m):void 0!==y?(a.set(m.key,y.mutation.getFieldMask()),Hi(y.mutation,m,y.mutation.getFieldMask(),Oe.now())):a.set(m.key,It.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((m,y)=>a.set(m,y)),t.forEach((m,y)=>{var w;return h.set(m,new my(y,null!==(w=a.get(m))&&void 0!==w?w:null))}),h))}recalculateAndSaveOverlays(e,t){const r=Gi();let i=new xe((a,h)=>a-h),s=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const h of a)h.keys().forEach(d=>{const m=t.get(d);if(null===m)return;let y=r.get(d)||It.empty();y=h.applyToLocalView(m,y),r.set(d,y);const w=(i.get(h.batchId)||re()).add(d);i=i.insert(h.batchId,w)})}).next(()=>{const a=[],h=i.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),m=d.key,y=d.value,w=Su();y.forEach(k=>{if(!s.has(k)){const D=Do(t.get(k),r.get(k));null!==D&&w.set(k,D),s=s.add(k)}}),a.push(this.documentOverlayCache.saveOverlays(e,m,w))}return C.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return Z.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Or(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):C.resolve(Vt());let h=-1,d=s;return a.next(m=>C.forEach(m,(y,w)=>(h<w.largestBatchId&&(h=w.largestBatchId),s.get(y)?C.resolve():this.remoteDocumentCache.getEntry(e,y).next(k=>{d=d.insert(y,k)}))).next(()=>this.populateOverlays(e,m,s)).next(()=>this.computeViews(e,d,m,re())).next(y=>({batchId:h,changes:Ao(y)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Z(t)).next(r=>{let i=Lr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let s=Lr();return this.indexManager.getCollectionParents(e,i).next(a=>C.forEach(a,h=>{const d=(m=t,y=h.child(i),new ln(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,y;return this.getDocumentsMatchingCollectionQuery(e,d,r).next(m=>{m.forEach((y,w)=>{s=s.insert(y,w)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(s=>{i.forEach((h,d)=>{const m=d.getKey();null===s.get(m)&&(s=s.insert(m,Le.newInvalidDocument(m)))});let a=Lr();return s.forEach((h,d)=>{const m=i.get(h);void 0!==m&&Hi(m.mutation,d,It.empty(),Oe.now()),Bi(t,d)&&(a=a.insert(h,d))}),a})}}class gy{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return C.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:et(r.createTime)}),C.resolve()}getNamedQuery(e,t){return C.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(r=t).name,query:md(r.bundledQuery),readTime:et(r.readTime)}),C.resolve();var r}}class _y{constructor(){this.overlays=new xe(Z.comparator),this.ls=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vt();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.we(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.ls.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){const i=Vt(),s=t.length+1,a=new Z(t.child("")),h=this.overlays.getIteratorFrom(a);for(;h.hasNext();){const d=h.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===s&&d.largestBatchId>r&&i.set(d.getKey(),d)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new xe((m,y)=>m-y);const a=this.overlays.getIterator();for(;a.hasNext();){const m=a.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let y=s.get(m.largestBatchId);null===y&&(y=Vt(),s=s.insert(m.largestBatchId,y)),y.set(m.getKey(),m)}}const h=Vt(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,y)=>h.set(m,y)),!(h.size()>=i)););return C.resolve(h)}we(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const a=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new B(t,r));let s=this.ls.get(t);void 0===s&&(s=re(),this.ls.set(t,s)),this.ls.set(t,s.add(r.key))}}class Td{constructor(){this.fs=new De(ht.ds),this.ws=new De(ht._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const r=new ht(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new ht(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){const t=new Z(new _e([])),r=new ht(t,e),i=new ht(t,e+1),s=[];return this.ws.forEachInRange([r,i],a=>{this.ys(a),s.push(a.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Z(new _e([])),r=new ht(t,e),i=new ht(t,e+1);let s=re();return this.ws.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new ht(e,0),r=this.fs.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class ht{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Z.comparator(e.key,t.key)||ae(e.As,t.As)}static _s(e,t){return ae(e.As,t.As)||Z.comparator(e.key,t.key)}}class yy{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new De(ht.ds)}checkEmpty(e){return C.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.vs;this.vs++;const a=new x(s,t,r,i);this.mutationQueue.push(a);for(const h of i)this.Rs=this.Rs.add(new ht(h.key,s)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return C.resolve(a)}lookupMutationBatch(e,t){return C.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ht(t,0),i=new ht(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,i],a=>{const h=this.Ps(a.As);s.push(h)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new De(ae);return t.forEach(i=>{const s=new ht(i,0),a=new ht(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,a],h=>{r=r.add(h.As)})}),C.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Z.isDocumentKey(s)||(s=s.child(""));const a=new ht(new Z(s),0);let h=new De(ae);return this.Rs.forEachWhile(d=>{const m=d.key.path;return!!r.isPrefixOf(m)&&(m.length===i&&(h=h.add(d.As)),!0)},a),C.resolve(this.Vs(h))}Vs(e){const t=[];return e.forEach(r=>{const i=this.Ps(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){X(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let r=this.Rs;return C.forEach(t.mutations,i=>{const s=new ht(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){const r=new ht(t,0),i=this.Rs.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return C.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class vy{constructor(e){this.Ds=e,this.docs=new xe(Z.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():Le.newInvalidDocument(t))}getEntries(e,t){let r=wt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Le.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=wt();const a=t.path,h=new Z(a.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:m,value:{document:y}}=d.getNext();if(!a.isPrefixOf(m.path))break;m.path.length>a.length+1||ki(oo(y),r)<=0||(i.has(y.key)||Bi(t,y))&&(s=s.insert(y.key,y.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,r,i){H()}Cs(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Iy(this)}getSize(e){return C.resolve(this.size)}}class Iy extends vm{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class wy{constructor(e){this.persistence=e,this.xs=new hn(t=>Xn(t),Ui),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Td,this.targetCount=0,this.Ms=is.kn()}forEachTarget(e,t){return this.xs.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),C.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new is(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Fn(t),C.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.xs.forEach((a,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.xs.delete(a),s.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){const r=this.xs.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),C.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),C.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ks.Es(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this.ks.containsKey(t))}}class Ed{constructor(e,t){this.$s={},this.overlays={},this.Os=new xt(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new wy(this),this.indexManager=new ay,this.remoteDocumentCache=new vy(r=>this.referenceDelegate.Ls(r)),this.serializer=new Yp(t),this.qs=new gy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _y,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new yy(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const i=new Ty(this.Os.next());return this.referenceDelegate.Us(),r(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return C.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}}class Ty extends ao{constructor(e){super(),this.currentSequenceNumber=e}}class Ll{constructor(e){this.persistence=e,this.Qs=new Td,this.js=null}static zs(e){return new Ll(e)}get Ws(){if(this.js)return this.js;throw H()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),C.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.Ws,r=>{const i=Z.fromPath(r);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,Y.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return C.or([()=>C.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class Ey{constructor(e){this.serializer=e}O(e,t,r,i){const s=new Cr("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Jc,{unique:!0}),h.createObjectStore("documentMutations"),Sm(e),function(h){h.createObjectStore("remoteDocuments")}(e));let a=C.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),Sm(e)),a=a.next(()=>function(h){const d=h.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",m)}(s))),r<4&&i>=4&&(0!==r&&(a=a.next(()=>function(h,d){return d.store("mutations").j().next(m=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Jc,{unique:!0});const y=d.store("mutations"),w=m.map(k=>y.put(k));return C.waitFor(w)})}(e,s))),a=a.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(a=a.next(()=>this.Ys(s))),r<6&&i>=6&&(a=a.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),r<7&&i>=7&&(a=a.next(()=>this.Zs(s))),r<8&&i>=8&&(a=a.next(()=>this.ti(e,s))),r<9&&i>=9&&(a=a.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(a=a.next(()=>this.ei(s))),r<11&&i>=11&&(a=a.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(a=a.next(()=>{!function(h){const d=h.createObjectStore("documentOverlays",{keyPath:Qh});d.createIndex("collectionPathOverlayIndex",au,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",Yh,{unique:!1})}(e)})),r<13&&i>=13&&(a=a.next(()=>function(h){const d=h.createObjectStore("remoteDocumentsV14",{keyPath:nu});d.createIndex("documentKeyIndex",ru),d.createIndex("collectionGroupIndex",iu)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(a=a.next(()=>this.si(e,s))),r<15&&i>=15&&(a=a.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:Hh}).createIndex("sequenceNumberIndex",Kh,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:ou}).createIndex("documentKeyIndex",Wh,{unique:!1})}(e))),a}Xs(e){let t=0;return e.store("remoteDocuments").X((r,i)=>{t+=Pl(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.j().next(i=>C.forEach(i,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",a).next(h=>C.forEach(h,d=>{X(d.userId===s.userId);const m=ts(this.serializer,d);return dm(e,s.userId,m).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.X((a,h)=>{const d=new _e(a),m=[0,it(d)];s.push(t.get(m).next(y=>y?C.resolve():t.put({targetId:0,path:it(d),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>C.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:nl});const r=t.store("collectionParents"),i=new wd,s=a=>{if(i.add(a)){const h=a.lastSegment(),d=a.popLast();return r.put({collectionId:h,parent:it(d)})}};return t.store("remoteDocuments").X({Y:!0},(a,h)=>{const d=new _e(a);return s(d.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([a,h,d],m)=>{const y=Lt(h);return s(y.popLast())}))}ei(e){const t=e.store("targets");return t.X((r,i)=>{const s=Lu(i),a=Jp(this.serializer,s);return t.put(a)})}ni(e,t){const r=t.store("remoteDocuments"),i=[];return r.X((s,a)=>{const h=t.store("remoteDocumentsV14"),d=(m=a,m.document?new Z(_e.fromString(m.document.name).popFirst(5)):m.noDocument?Z.fromSegments(m.noDocument.path):m.unknownDocument?Z.fromSegments(m.unknownDocument.path):H()).path.toArray();var m;const y={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(h.put(y))}).next(()=>C.waitFor(i))}si(e,t){const r=t.store("mutations"),i=Im(this.serializer),s=new Ed(Ll.zs,this.serializer.fe);return r.j().next(a=>{const h=new Map;return a.forEach(d=>{var m;let y=null!==(m=h.get(d.userId))&&void 0!==m?m:re();ts(this.serializer,d).keys().forEach(w=>y=y.add(w)),h.set(d.userId,y)}),C.forEach(h,(d,m)=>{const y=new ze(m),w=Cl.de(this.serializer,y),k=s.getIndexManager(y),D=Ol.de(y,this.serializer,k,s.referenceDelegate);return new Am(i,D,w,k).recalculateAndSaveOverlaysForDocumentKeys(new Ri(t,xt.ct),d).next()})})}}function Sm(n){n.createObjectStore("targetDocuments",{keyPath:su}).createIndex("documentTargetsIndex",tl,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",jh,{unique:!0}),n.createObjectStore("targetGlobal")}const Ad="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Sd{constructor(e,t,r,i,s,a,h,d,m,y,w=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ii=s,this.window=a,this.document=h,this.ri=m,this.oi=y,this.ui=w,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=k=>Promise.resolve(),!Sd.D())throw new M(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dy(this,i),this.di=t+"main",this.serializer=new Yp(d),this.wi=new Zt(this.di,this.ui,new Ey(this.serializer)),this.Bs=new cy(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Im(this.serializer),this.qs=new ey,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===y&&Ve("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(N.FAILED_PRECONDITION,Ad);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new xt(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){var t=this;return this.fi=function(){var r=(0,E.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(function(){var t=(0,E.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((0,E.Z)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ul(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(vt(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return Gu(e).get("owner").next(t=>C.resolve(this.Ri(t)))}Pi(e){return Ul(e).delete(this.clientId)}bi(){var e=this;return(0,E.Z)(function*(){if(e.isPrimary&&!e.Vi(e.li,18e5)){e.li=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Qe(r,"clientMetadata");return i.j().next(s=>{const a=e.Si(s,18e5),h=s.filter(d=>-1===a.indexOf(d));return C.forEach(h,d=>i.delete(d.clientId)).next(()=>h)})}).catch(()=>[]);if(e._i)for(const r of t)e._i.removeItem(e.Di(r.clientId))}})()}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?C.resolve(!0):Gu(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new M(N.FAILED_PRECONDITION,Ad);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ul(e).j().next(r=>void 0===this.Si(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,E.Z)(function*(){e.Fs=!1,e.xi(),e.hi&&(e.hi.cancel(),e.hi=null),e.Ni(),e.ki(),yield e.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new Ri(t,xt.ct);return e.Ai(r).next(()=>e.Pi(r))}),e.wi.close(),e.Mi()})()}Si(e,t){return e.filter(r=>this.Vi(r.updateTimeMs,t)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Ul(e).j().next(t=>this.Si(t,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return Ol.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new uy(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Cl.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=15===(a=this.ui)?lo:14===a?co:13===a?il:12===a?uu:11===a?rl:void H();var a;let h;return this.wi.runTransaction(e,i,s,d=>(h=new Ri(d,this.Os?this.Os.next():xt.ct),"readwrite-primary"===t?this.Ti(h).next(m=>!!m||this.Ei(h)).next(m=>{if(!m)throw Ve(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new M(N.FAILED_PRECONDITION,Wc);return r(h)}).next(m=>this.vi(h).next(()=>m)):this.Oi(h).next(()=>r(h)))).then(d=>(h.raiseOnCommittedEvent(),d))}Oi(e){return Gu(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(N.FAILED_PRECONDITION,Ad)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gu(e).put("owner",t)}static D(){return Zt.D()}Ai(e){const t=Gu(e);return t.get("owner").next(r=>this.Ri(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):C.resolve())}Vi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Ve(`Detected an update time that is in the future: ${e} > ${r}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const t=/(?:Version|Mobile)\/1[456]/;(0,pe.G6)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const r=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ve("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Ve("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gu(n){return Qe(n,"owner")}function Ul(n){return Qe(n,"clientMetadata")}function bd(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class xd{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=i}static Li(e,t){let r=re(),i=re();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new xd(e,t.fromCache,r,i)}}class bm{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,r)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(To(t))return C.resolve(null);let r=ft(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Vi(t,null,"F"),r=ft(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=re(...s);return this.Ui.getDocuments(e,a).next(h=>this.indexManager.getMinOffset(e,r).next(d=>{const m=this.ji(t,h);return this.zi(t,m,a,d.readTime)?this.Ki(e,Vi(t,null,"F")):this.Wi(e,m,t,d)}))})))}Gi(e,t,r,i){return To(t)||i.isEqual(Y.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(s=>{const a=this.ji(t,s);return this.zi(t,a,r,i)?this.Qi(e,t):(ja()<=je.in.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(t)),this.Wi(e,a,t,Kc(i,-1)))})}ji(e,t){let r=new De(wl(e));return t.forEach((i,s)=>{Bi(e,s)&&(r=r.add(s))}),r}zi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return ja()<=je.in.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Au(t)),this.Ui.getDocumentsMatchingQuery(e,t,bt.min())}Wi(e,t,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class Ay{constructor(e,t,r,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new xe(ae),this.Yi=new hn(s=>Xn(s),Ui),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Am(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function xm(n,e,t,r){return new Ay(n,e,t,r)}function km(n,e){return kd.apply(this,arguments)}function kd(){return kd=(0,E.Z)(function*(n,e){const t=z(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],h=[];let d=re();for(const m of i){a.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}for(const m of s){h.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}return t.localDocuments.getDocuments(r,d).next(m=>({er:m,removedBatchIds:a,addedBatchIds:h}))})})}),kd.apply(this,arguments)}function Cm(n){const e=z(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function Nm(n,e,t){let r=re(),i=re();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=wt();return t.forEach((h,d)=>{const m=s.get(h);d.isFoundDocument()!==m.isFoundDocument()&&(i=i.add(h)),d.isNoDocument()&&d.version.isEqual(Y.min())?(e.removeEntry(h,d.readTime),a=a.insert(h,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||0===d.version.compareTo(m.version)&&m.hasPendingWrites?(e.addEntry(d),a=a.insert(h,d)):U("LocalStore","Ignoring outdated watch update for ",h,". Current version:",m.version," Watch version:",d.version)}),{nr:a,sr:i}})}function xy(n,e){const t=z(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Uo(n,e){const t=z(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Bs.getTargetData(r,e).next(s=>s?(i=s,C.resolve(i)):t.Bs.allocateTargetId(r).next(a=>(i=new ir(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ji.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}function Vo(n,e,t){return Cd.apply(this,arguments)}function Cd(){return Cd=(0,E.Z)(function*(n,e,t){const r=z(n),i=r.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!vt(a))throw a;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}),Cd.apply(this,arguments)}function Vl(n,e,t){const r=z(n);let i=Y.min(),s=re();return r.persistence.runTransaction("Execute query","readonly",a=>function(h,d,m){const y=z(h),w=y.Yi.get(m);return void 0!==w?C.resolve(y.Ji.get(w)):y.Bs.getTargetData(d,m)}(r,a,ft(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(a,h.targetId).next(d=>{s=d})}).next(()=>r.Hi.getDocumentsMatchingQuery(a,e,t?i:Y.min(),t?s:re())).next(h=>(Pm(r,Mr(e),h),{documents:h,ir:s})))}function Rm(n,e){const t=z(n),r=z(t.Bs),i=t.Ji.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.le(s,e).next(a=>a?a.target:null))}function Dm(n,e){const t=z(n),r=t.Xi.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Zi.getAllFromCollectionGroup(i,e,Kc(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Pm(t,e,i),i))}function Pm(n,e,t){let r=n.Xi.get(e)||Y.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Xi.set(e,r)}function Nd(){return Nd=(0,E.Z)(function*(n,e,t,r){const i=z(n);let s=re(),a=wt();for(const m of t){const y=e.rr(m.metadata.name);m.document&&(s=s.add(y));const w=e.ur(m);w.setReadTime(e.cr(m.metadata.readTime)),a=a.insert(y,w)}const h=i.Zi.newChangeBuffer({trackRemovals:!0}),d=yield Uo(i,(m=r,ft(Nn(_e.fromString(`__bundle__/docs/${m}`)))));var m;return i.persistence.runTransaction("Apply bundle documents","readwrite",m=>Nm(m,h,a).next(y=>(h.apply(m),y)).next(y=>i.Bs.removeMatchingKeysForTargetId(m,d.targetId).next(()=>i.Bs.addMatchingKeys(m,s,d.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(m,y.nr,y.sr)).next(()=>y.nr)))}),Nd.apply(this,arguments)}function Cy(n,e){return Rd.apply(this,arguments)}function Rd(){return Rd=(0,E.Z)(function*(n,e,t=re()){const r=yield Uo(n,ft(md(e.bundledQuery))),i=z(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const a=et(e.readTime);if(r.snapshotVersion.compareTo(a)>=0)return i.qs.saveNamedQuery(s,e);const h=r.withResumeToken(Ye.EMPTY_BYTE_STRING,a);return i.Ji=i.Ji.insert(h.targetId,h),i.Bs.updateTargetData(s,h).next(()=>i.Bs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Bs.addMatchingKeys(s,t,r.targetId)).next(()=>i.qs.saveNamedQuery(s,e))})}),Rd.apply(this,arguments)}function Om(n,e){return`firestore_clients_${n}_${e}`}function Mm(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Dd(n,e){return`firestore_targets_${n}_${e}`}class ql{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static ar(e,t,r){const i=JSON.parse(r);let s,a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code,a&&(s=new M(i.error.code,i.error.message))),a?new ql(e,t,i.state,s):(Ve("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static ar(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new M(r.error.code,r.error.message))),s?new Zu(e,r.state,i):(Ve("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=So();for(let a=0;i&&a<r.activeTargetIds.length;++a)i=Xc(r.activeTargetIds[a]),s=s.add(r.activeTargetIds[a]);return i?new Bl(e,s):(Ve("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Pd{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Pd(t.clientId,t.onlineState):(Ve("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Od{constructor(){this.activeTargetIds=So()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Md{constructor(e,t,r,i,s){this.window=e,this.ii=t,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new xe(ae),this.started=!1,this.yr=[];const a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=Om(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new Od),this.Tr=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.vr=`firestore_online_state_${this.persistenceKey}`,this.Rr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,E.Z)(function*(){const t=yield e.syncEngine.$i();for(const i of t){if(i===e.wr)continue;const s=e.getItem(Om(e.persistenceKey,i));if(s){const a=Bl.ar(i,s);a&&(e.gr=e.gr.insert(a.clientId,a))}}e.Pr();const r=e.storage.getItem(e.vr);if(r){const i=e.br(r);i&&e.Vr(i)}for(const i of e.yr)e.mr(i);e.yr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,r){this.Dr(e,t,r),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Dd(this.persistenceKey,e));if(r){const i=Zu.ar(e,r);i&&(t=i.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Dd(this.persistenceKey,e))}updateQueryState(e,t,r){this.kr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Cr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(U("SharedClientState","EVENT",r.key,r.newValue),r.key===this.pr)return void Ve("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((0,E.Z)(function*(){if(t.started){if(null!==r.key)if(t.Tr.test(r.key)){if(null==r.newValue){const i=t.Or(r.key);return t.Fr(i,null)}{const i=t.Br(r.key,r.newValue);if(i)return t.Fr(i.clientId,i)}}else if(t.Er.test(r.key)){if(null!==r.newValue){const i=t.Lr(r.key,r.newValue);if(i)return t.qr(i)}}else if(t.Ar.test(r.key)){if(null!==r.newValue){const i=t.Ur(r.key,r.newValue);if(i)return t.Kr(i)}}else if(r.key===t.vr){if(null!==r.newValue){const i=t.br(r.newValue);if(i)return t.Vr(i)}}else if(r.key===t.Ir){const i=function(s){let a=xt.ct;if(null!=s)try{const h=JSON.parse(s);X("number"==typeof h),a=h}catch(h){Ve("SharedClientState","Failed to read sequence number from WebStorage",h)}return a}(r.newValue);i!==xt.ct&&t.sequenceNumberHandler(i)}else if(r.key===t.Rr){const i=t.Gr(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.Qr(s)))}}else t.yr.push(r)}))}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,r){const i=new ql(this.currentUser,e,t,r),s=Mm(this.persistenceKey,this.currentUser,e);this.setItem(s,i.hr())}Cr(e){const t=Mm(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){this.storage.setItem(this.vr,JSON.stringify({clientId:this.wr,onlineState:e}))}kr(e,t,r){const i=Dd(this.persistenceKey,e),s=new Zu(e,t,r);this.setItem(i,s.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const r=this.Or(e);return Bl.ar(r,t)}Lr(e,t){const r=this.Er.exec(e),i=Number(r[1]);return ql.ar(new ze(void 0!==r[2]?r[2]:null),i,t)}Ur(e,t){const r=this.Ar.exec(e),i=Number(r[1]);return Zu.ar(i,t)}br(e){return Pd.ar(e)}Gr(e){return JSON.parse(e)}qr(e){var t=this;return(0,E.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.jr(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),s=this.Sr(r),a=[],h=[];return s.forEach(d=>{i.has(d)||a.push(d)}),i.forEach(d=>{s.has(d)||h.push(d)}),this.syncEngine.Wr(a,h).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=So();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Lm{constructor(){this.Hr=new Od,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Od,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ny{Yr(e){}shutdown(){}}class Fm{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Gl=null;function Ld(){return null===Gl?Gl=268435456+Math.round(2147483648*Math.random()):Gl++,"0x"+Gl.toString(16)}const Ry={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Dy{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Et="WebChannelConnection";class Py extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,i,s){const a=Ld(),h=this.To(e,t);U("RestConnection",`Sending RPC '${e}' ${a}:`,h,r);const d={};return this.Eo(d,i,s),this.Ao(e,h,d,r).then(m=>(U("RestConnection",`Received RPC '${e}' ${a}: `,m),m),m=>{throw Mt("RestConnection",`RPC '${e}' ${a} failed with error: `,m,"url: ",h,"request:",r),m})}vo(e,t,r,i,s,a){return this.Io(e,t,r,i,s)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+br,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${Ry[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,i){const s=Ld();return new Promise((a,h)=>{const d=new Op;d.setWithCredentials(!0),d.listenOnce(Fh.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case no.NO_ERROR:const y=d.getResponseJson();U(Et,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),a(y);break;case no.TIMEOUT:U(Et,`RPC '${e}' ${s} timed out`),h(new M(N.DEADLINE_EXCEEDED,"Request time out"));break;case no.HTTP_ERROR:const w=d.getStatus();if(U(Et,`RPC '${e}' ${s} failed with status:`,w,"response text:",d.getResponseText()),w>0){let k=d.getResponseJson();Array.isArray(k)&&(k=k[0]);const D=null==k?void 0:k.error;if(D&&D.status&&D.message){const q=function(G){const $=G.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf($)>=0?$:N.UNKNOWN}(D.status);h(new M(q,D.message))}else h(new M(N.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new M(N.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{U(Et,`RPC '${e}' ${s} completed.`)}});const m=JSON.stringify(i);U(Et,`RPC '${e}' ${s} sending request:`,i),d.send(t,"POST",m,r,15)})}Ro(e,t,r){const i=Ld(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Lh(),h=to(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;void 0!==m&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.xmlHttpFactory=new Pp({})),this.Eo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const y=s.join("");U(Et,`Creating RPC '${e}' stream ${i}: ${y}`,d);const w=a.createWebChannel(y,d);let k=!1,D=!1;const q=new Dy({ro:$=>{D?U(Et,`Not sending because RPC '${e}' stream ${i} is closed:`,$):(k||(U(Et,`Opening RPC '${e}' stream ${i} transport.`),w.open(),k=!0),U(Et,`RPC '${e}' stream ${i} sending:`,$),w.send($))},oo:()=>w.close()}),G=($,oe,me)=>{$.listen(oe,ue=>{try{me(ue)}catch(fe){setTimeout(()=>{throw fe},0)}})};return G(w,$n.EventType.OPEN,()=>{D||U(Et,`RPC '${e}' stream ${i} transport opened.`)}),G(w,$n.EventType.CLOSE,()=>{D||(D=!0,U(Et,`RPC '${e}' stream ${i} transport closed`),q.wo())}),G(w,$n.EventType.ERROR,$=>{D||(D=!0,Mt(Et,`RPC '${e}' stream ${i} transport errored:`,$),q.wo(new M(N.UNAVAILABLE,"The operation could not be completed")))}),G(w,$n.EventType.MESSAGE,$=>{var oe;if(!D){const me=$.data[0];X(!!me);const fe=me.error||(null===(oe=me[0])||void 0===oe?void 0:oe.error);if(fe){U(Et,`RPC '${e}' stream ${i} received error:`,fe);const ve=fe.status;let Ie=function(fs){const F_=he[fs];if(void 0!==F_)return ku(F_)}(ve),At=fe.message;void 0===Ie&&(Ie=N.INTERNAL,At="Unknown error status: "+ve+" with message "+fe.message),D=!0,q.wo(new M(Ie,At)),w.close()}else U(Et,`RPC '${e}' stream ${i} received:`,me),q._o(me)}}),G(h,Uh.STAT_EVENT,$=>{$.stat===Bc.PROXY?U(Et,`RPC '${e}' stream ${i} detected buffering proxy`):$.stat===Bc.NOPROXY&&U(Et,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{q.fo()},0),q}}function Um(){return typeof window<"u"?window:null}function Zl(){return typeof document<"u"?document:null}function zu(n){return new Z_(n,!0)}class Fd{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class Vm{constructor(e,t,r,i,s,a,h,d){this.ii=e,this.$o=r,this.Oo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Fd(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return(0,E.Z)(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return(0,E.Z)(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var r=this;return(0,E.Z)(function*(){r.Ho(),r.Jo(),r.qo.cancel(),r.Fo++,4!==e?r.qo.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Ve(t.toString()),Ve("Using maximum backoff delay to prevent overloading the backend."),r.qo.xo()):t&&t.code===N.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Yo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===t&&this.Zo(r,i)},r=>{e(()=>{const i=new M(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(e,t){const r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No((0,E.Z)(function*(){e.state=0,e.start()}))}tu(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Oy extends Vm{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function j_(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(d=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:H(),i=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(X(void 0===m||"string"==typeof m),Ye.fromBase64String(m||"")):(X(void 0===m||m instanceof Uint8Array),Ye.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,h=a&&function(d){const m=void 0===d.code?N.UNKNOWN:ku(d.code);return new M(m,d.message||"")}(a);t=new Lp(r,i,s,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Rn(n,r.document.name),s=et(r.document.updateTime),a=r.document.createTime?et(r.document.createTime):Y.min(),h=new Xe({mapValue:{fields:r.document.fields}}),d=Le.newFoundDocument(i,s,a,h);t=new Po(r.targetIds||[],r.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){const r=e.documentDelete,i=Rn(n,r.document),s=r.readTime?et(r.readTime):Y.min(),a=Le.newNoDocument(i,s);t=new Po([],r.removedTargetIds||[],a.key,a)}else if("documentRemove"in e){const r=e.documentRemove,i=Rn(n,r.document);t=new Po([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return H();{const r=e.filter,{count:i=0,unchangedNames:s}=r,a=new W(i,s);t=new Mp(r.targetId,a)}}var d;return t}(this.serializer,e),r=function(i){if(!("targetChange"in i))return Y.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Y.min():s.readTime?et(s.readTime):Y.min()}(e);return this.listener.nu(t,r)}su(e){const t={};t.database=Ou(this.serializer),t.addTarget=function(i,s){let a;const h=s.target;if(a=vo(h)?{documents:jp(i,h)}:{query:pd(i,h)},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=qp(i,s.resumeToken);const d=ld(i,s.expectedCount);null!==d&&(a.expectedCount=d)}else if(s.snapshotVersion.compareTo(Y.min())>0){a.readTime=Oo(i,s.snapshotVersion.toTimestamp());const d=ld(i,s.expectedCount);null!==d&&(a.expectedCount=d)}return a}(this.serializer,e);const r=function K_(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Wo(t)}iu(e){const t={};t.database=Ou(this.serializer),t.removeTarget=e,this.Wo(t)}}class My extends Vm{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(X(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function H_(n,e){return n&&n.length>0?(X(void 0!==e),n.map(t=>function(r,i){let s=et(r.updateTime?r.updateTime:i);return s.isEqual(Y.min())&&(s=et(i)),new $i(s,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=et(e.commitTime);return this.listener.cu(r,t)}return X(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Ou(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Mu(this.serializer,r))};this.Wo(t)}}class Ly extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new M(N.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new M(N.UNKNOWN,i.toString())})}vo(e,t,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.vo(e,t,r,s,a,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(N.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class Uy{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Ve(t),this.mu=!1):U("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class Vy{constructor(e,t,r,i,s){var a=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(h=>{r.enqueueAndForget((0,E.Z)(function*(){var d;Gr(a)&&(U("RemoteStore","Restarting streams for network reachability change."),yield(d=(0,E.Z)(function*(m){const y=z(m);y.vu.add(4),yield qo(y),y.bu.set("Unknown"),y.vu.delete(4),yield $u(y)}),function(m){return d.apply(this,arguments)})(a))}))}),this.bu=new Uy(r,i)}}function $u(n){return Vd.apply(this,arguments)}function Vd(){return Vd=(0,E.Z)(function*(n){if(Gr(n))for(const e of n.Ru)yield e(!0)}),Vd.apply(this,arguments)}function qo(n){return qd.apply(this,arguments)}function qd(){return qd=(0,E.Z)(function*(n){for(const e of n.Ru)yield e(!1)}),qd.apply(this,arguments)}function zl(n,e){const t=z(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),Zd(t)?Gd(t):Go(t).Ko()&&Bd(t,e))}function ju(n,e){const t=z(n),r=Go(t);t.Au.delete(e),r.Ko()&&qm(t,e),0===t.Au.size&&(r.Ko()?r.jo():Gr(t)&&t.bu.set("Unknown"))}function Bd(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Go(n).su(e)}function qm(n,e){n.Vu.qt(e),Go(n).iu(e)}function Gd(n){n.Vu=new V_({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),Go(n).start(),n.bu.gu()}function Zd(n){return Gr(n)&&!Go(n).Uo()&&n.Au.size>0}function Gr(n){return 0===z(n).vu.size}function Bm(n){n.Vu=void 0}function qy(n){return zd.apply(this,arguments)}function zd(){return zd=(0,E.Z)(function*(n){n.Au.forEach((e,t)=>{Bd(n,e)})}),zd.apply(this,arguments)}function By(n,e){return $d.apply(this,arguments)}function $d(){return $d=(0,E.Z)(function*(n,e){Bm(n),Zd(n)?(n.bu.Iu(e),Gd(n)):n.bu.set("Unknown")}),$d.apply(this,arguments)}function Gy(n,e,t){return jd.apply(this,arguments)}function jd(){return jd=(0,E.Z)(function*(n,e,t){if(n.bu.set("Online"),e instanceof Lp&&2===e.state&&e.cause)try{yield(r=(0,E.Z)(function*(i,s){const a=s.cause;for(const h of s.targetIds)i.Au.has(h)&&(yield i.remoteSyncer.rejectListen(h,a),i.Au.delete(h),i.Vu.removeTarget(h))}),function(i,s){return r.apply(this,arguments)})(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield $l(n,r)}else if(e instanceof Po?n.Vu.Ht(e):e instanceof Mp?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(Y.min()))try{const r=yield Cm(n.localStore);t.compareTo(r)>=0&&(yield function(i,s){const a=i.Vu.ce(s);return a.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const m=i.Au.get(d);m&&i.Au.set(d,m.withResumeToken(h.resumeToken,s))}}),a.targetMismatches.forEach((h,d)=>{const m=i.Au.get(h);if(!m)return;i.Au.set(h,m.withResumeToken(Ye.EMPTY_BYTE_STRING,m.snapshotVersion)),qm(i,h);const y=new ir(m.target,h,d,m.sequenceNumber);Bd(i,y)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield $l(n,r)}var r}),jd.apply(this,arguments)}function $l(n,e,t){return Hd.apply(this,arguments)}function Hd(){return Hd=(0,E.Z)(function*(n,e,t){if(!vt(e))throw e;n.vu.add(1),yield qo(n),n.bu.set("Offline"),t||(t=()=>Cm(n.localStore)),n.asyncQueue.enqueueRetryable((0,E.Z)(function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.vu.delete(1),yield $u(n)}))}),Hd.apply(this,arguments)}function Gm(n,e){return e().catch(t=>$l(n,t,e))}function Bo(n){return Kd.apply(this,arguments)}function Kd(){return Kd=(0,E.Z)(function*(n){const e=z(n),t=Zr(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;Zy(e);)try{const i=yield xy(e.localStore,r);if(null===i){0===e.Eu.length&&t.jo();break}r=i.batchId,zy(e,i)}catch(i){yield $l(e,i)}Zm(e)&&zm(e)}),Kd.apply(this,arguments)}function Zy(n){return Gr(n)&&n.Eu.length<10}function zy(n,e){n.Eu.push(e);const t=Zr(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function Zm(n){return Gr(n)&&!Zr(n).Uo()&&n.Eu.length>0}function zm(n){Zr(n).start()}function $y(n){return Wd.apply(this,arguments)}function Wd(){return Wd=(0,E.Z)(function*(n){Zr(n).hu()}),Wd.apply(this,arguments)}function jy(n){return Qd.apply(this,arguments)}function Qd(){return Qd=(0,E.Z)(function*(n){const e=Zr(n);for(const t of n.Eu)e.uu(t.mutations)}),Qd.apply(this,arguments)}function Hy(n,e,t){return Yd.apply(this,arguments)}function Yd(){return Yd=(0,E.Z)(function*(n,e,t){const r=n.Eu.shift(),i=F.from(r,e,t);yield Gm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Bo(n)}),Yd.apply(this,arguments)}function Ky(n,e){return Xd.apply(this,arguments)}function Xd(){return Xd=(0,E.Z)(function*(n,e){var t;e&&Zr(n).ou&&(yield(t=(0,E.Z)(function*(r,i){if(Ki(s=i.code)&&s!==N.ABORTED){const a=r.Eu.shift();Zr(r).Qo(),yield Gm(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,i)),yield Bo(r)}var s}),function(r,i){return t.apply(this,arguments)})(n,e)),Zm(n)&&zm(n)}),Xd.apply(this,arguments)}function $m(n,e){return Jd.apply(this,arguments)}function Jd(){return Jd=(0,E.Z)(function*(n,e){const t=z(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const r=Gr(t);t.vu.add(3),yield qo(t),r&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield $u(t)}),Jd.apply(this,arguments)}function ef(n,e){return tf.apply(this,arguments)}function tf(){return tf=(0,E.Z)(function*(n,e){const t=z(n);e?(t.vu.delete(2),yield $u(t)):e||(t.vu.add(2),yield qo(t),t.bu.set("Unknown"))}),tf.apply(this,arguments)}function Go(n){return n.Su||(n.Su=function(e,t,r){const i=z(e);return i.fu(),new Oy(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:qy.bind(null,n),ao:By.bind(null,n),nu:Gy.bind(null,n)}),n.Ru.push(function(){var e=(0,E.Z)(function*(t){t?(n.Su.Qo(),Zd(n)?Gd(n):n.bu.set("Unknown")):(yield n.Su.stop(),Bm(n))});return function(t){return e.apply(this,arguments)}}())),n.Su}function Zr(n){return n.Du||(n.Du=function(e,t,r){const i=z(e);return i.fu(),new My(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:$y.bind(null,n),ao:Ky.bind(null,n),au:jy.bind(null,n),cu:Hy.bind(null,n)}),n.Ru.push(function(){var e=(0,E.Z)(function*(t){t?(n.Du.Qo(),yield Bo(n)):(yield n.Du.stop(),n.Eu.length>0&&(U("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Du}class nf{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new We,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,t,r,i,s){const a=Date.now()+r,h=new nf(e,t,a,i,s);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new M(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Zo(n,e){if(Ve("AsyncQueue",`${e}: ${n}`),vt(n))return new M(N.UNAVAILABLE,`${e}: ${n}`);throw n}class zo{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Z.comparator(t.key,r.key):(t,r)=>Z.comparator(t.key,r.key),this.keyedMap=Lr(),this.sortedSet=new xe(this.comparator)}static emptySet(e){return new zo(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new zo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class jm{constructor(){this.Cu=new xe(Z.comparator)}track(e){const t=e.doc.key,r=this.Cu.get(t);r?0!==e.type&&3===r.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==r.type?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Cu=this.Cu.remove(t):1===e.type&&2===r.type?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):H():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}}class $o{constructor(e,t,r,i,s,a,h,d,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,i,s){const a=[];return t.forEach(h=>{a.push({type:0,doc:h})}),new $o(e,t,zo.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Wy{constructor(){this.Nu=void 0,this.listeners=[]}}class Qy{constructor(){this.queries=new hn(e=>Il(e),qi),this.onlineState="Unknown",this.ku=new Set}}function rf(n,e){return sf.apply(this,arguments)}function sf(){return sf=(0,E.Z)(function*(n,e){const t=z(n),r=e.query;let i=!1,s=t.queries.get(r);if(s||(i=!0,s=new Wy),i)try{s.Nu=yield t.onListen(r)}catch(a){const h=Zo(a,`Initialization of query '${Au(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&uf(t)}),sf.apply(this,arguments)}function of(n,e){return af.apply(this,arguments)}function af(){return af=(0,E.Z)(function*(n,e){const t=z(n),r=e.query;let i=!1;const s=t.queries.get(r);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),i=0===s.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),af.apply(this,arguments)}function Yy(n,e){const t=z(n);let r=!1;for(const i of e){const a=t.queries.get(i.query);if(a){for(const h of a.listeners)h.$u(i)&&(r=!0);a.Nu=i}}r&&uf(t)}function Xy(n,e,t){const r=z(n),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);r.queries.delete(e)}function uf(n){n.ku.forEach(e=>{e.next()})}class cf{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new $o(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=$o.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class Jy{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}class Hm{constructor(e){this.serializer=e}rr(e){return Rn(this.serializer,e)}ur(e){return e.metadata.exists?$p(this.serializer,e.document,!1):Le.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return et(e)}}class ev{constructor(e,t,r){this.ju=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Km(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const r=_e.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,r=new Hm(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.rr(i.metadata.name);for(const a of i.metadata.queries){const h=(t.get(a)||re()).add(s);t.set(a,h)}}return t}complete(){var e=this;return(0,E.Z)(function*(){const t=yield function ky(n,e,t,r){return Nd.apply(this,arguments)}(e.localStore,new Hm(e.serializer),e.documents,e.ju.id),r=e.Wu(e.documents);for(const i of e.queries)yield Cy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Hu:e.collectionGroups,Ju:t}})()}}function Km(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Wm{constructor(e){this.key=e}}class Qm{constructor(e){this.key=e}}class Ym{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=re(),this.mutatedKeys=re(),this.tc=wl(e),this.ec=new zo(this.tc)}get nc(){return this.Yu}sc(e,t){const r=t?t.ic:new jm,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,h=!1;const d="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,m="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((y,w)=>{const k=i.get(y),D=Bi(this.query,w)?w:null,q=!!k&&this.mutatedKeys.has(k.key),G=!!D&&(D.hasLocalMutations||this.mutatedKeys.has(D.key)&&D.hasCommittedMutations);let $=!1;k&&D?k.data.isEqual(D.data)?q!==G&&(r.track({type:3,doc:D}),$=!0):this.rc(k,D)||(r.track({type:2,doc:D}),$=!0,(d&&this.tc(D,d)>0||m&&this.tc(D,m)<0)&&(h=!0)):!k&&D?(r.track({type:0,doc:D}),$=!0):k&&!D&&(r.track({type:1,doc:k}),$=!0,(d||m)&&(h=!0)),$&&(D?(a=a.add(D),s=G?s.add(y):s.delete(y)):(a=a.delete(y),s=s.delete(y)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const y="F"===this.query.limitType?a.last():a.first();a=a.delete(y.key),s=s.delete(y.key),r.track({type:1,doc:y})}return{ec:a,ic:r,zi:h,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((m,y)=>function(w,k){const D=q=>{switch(q){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return D(w)-D(k)}(m.type,y.type)||this.tc(m.doc,y.doc)),this.oc(r);const a=t?this.uc():[],h=0===this.Zu.size&&this.current?1:0,d=h!==this.Xu;return this.Xu=h,0!==s.length||d?{snapshot:new $o(this.query,e.ec,i,s,e.mutatedKeys,0===h,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:a}:{cc:a}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new jm,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=re(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new Qm(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new Wm(r))}),t}hc(e){this.Yu=e.ir,this.Zu=re();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return $o.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class tv{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class nv{constructor(e){this.key=e,this.fc=!1}}class rv{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.dc={},this.wc=new hn(h=>Il(h),qi),this._c=new Map,this.mc=new Set,this.gc=new xe(Z.comparator),this.yc=new Map,this.Ic=new Td,this.Tc={},this.Ec=new Map,this.Ac=is.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function iv(n,e){return lf.apply(this,arguments)}function lf(){return lf=(0,E.Z)(function*(n,e){const t=Pf(n);let r,i;const s=t.wc.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const a=yield Uo(t.localStore,ft(e)),h=t.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,i=yield hf(t,e,r,"current"===h,a.resumeToken),t.isPrimaryClient&&zl(t.remoteStore,a)}return i}),lf.apply(this,arguments)}function hf(n,e,t,r,i){return df.apply(this,arguments)}function df(){return df=(0,E.Z)(function*(n,e,t,r,i){n.Rc=(w,k,D)=>{return(q=(0,E.Z)(function*(G,$,oe,me){let ue=$.view.sc(oe);ue.zi&&(ue=yield Vl(G.localStore,$.query,!1).then(({documents:Ie})=>$.view.sc(Ie,ue)));const fe=me&&me.targetChanges.get($.targetId),ve=$.view.applyChanges(ue,G.isPrimaryClient,fe);return Tf(G,$.targetId,ve.cc),ve.snapshot}),function(G,$,oe,me){return q.apply(this,arguments)})(n,w,k,D);var q};const s=yield Vl(n.localStore,e,!0),a=new Ym(e,s.ir),h=a.sc(s.documents),d=rr.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),m=a.applyChanges(h,n.isPrimaryClient,d);Tf(n,t,m.cc);const y=new tv(e,t,a);return n.wc.set(e,y),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),m.snapshot}),df.apply(this,arguments)}function sv(n,e){return ff.apply(this,arguments)}function ff(){return ff=(0,E.Z)(function*(n,e){const t=z(n),r=t.wc.get(e),i=t._c.get(r.targetId);if(i.length>1)return t._c.set(r.targetId,i.filter(s=>!qi(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Vo(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),ju(t.remoteStore,r.targetId),jo(t,r.targetId)}).catch(Tn))):(jo(t,r.targetId),yield Vo(t.localStore,r.targetId,!0))}),ff.apply(this,arguments)}function pf(){return pf=(0,E.Z)(function*(n,e,t){const r=Of(n);try{const i=yield function(s,a){const h=z(s),d=Oe.now(),m=a.reduce((k,D)=>k.add(D.key),re());let y,w;return h.persistence.runTransaction("Locally write mutations","readwrite",k=>{let D=wt(),q=re();return h.Zi.getEntries(k,m).next(G=>{D=G,D.forEach(($,oe)=>{oe.isValidDocument()||(q=q.add($))})}).next(()=>h.localDocuments.getOverlayedDocuments(k,D)).next(G=>{y=G;const $=[];for(const oe of a){const me=cd(oe,y.get(oe.key).overlayedDocument);null!=me&&$.push(new o(oe.key,me,hl(me.value.mapValue),Pe.exists(!0)))}return h.mutationQueue.addMutationBatch(k,d,$,a)}).next(G=>{w=G;const $=G.applyToLocalDocumentSet(y,q);return h.documentOverlayCache.saveOverlays(k,G.batchId,$)})}).then(()=>({batchId:w.batchId,changes:Ao(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,h){let d=s.Tc[s.currentUser.toKey()];d||(d=new xe(ae)),d=d.insert(a,h),s.Tc[s.currentUser.toKey()]=d}(r,i.batchId,t),yield sr(r,i.changes),yield Bo(r.remoteStore)}catch(i){const s=Zo(i,"Failed to persist write");t.reject(s)}}),pf.apply(this,arguments)}function Xm(n,e){return mf.apply(this,arguments)}function mf(){return mf=(0,E.Z)(function*(n,e){const t=z(n);try{const r=yield function by(n,e){const t=z(n),r=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const h=[];e.targetChanges.forEach((y,w)=>{const k=i.get(w);if(!k)return;h.push(t.Bs.removeMatchingKeys(s,y.removedDocuments,w).next(()=>t.Bs.addMatchingKeys(s,y.addedDocuments,w)));let D=k.withSequenceNumber(s.currentSequenceNumber);var q,G,$;null!==e.targetMismatches.get(w)?D=D.withResumeToken(Ye.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):y.resumeToken.approximateByteSize()>0&&(D=D.withResumeToken(y.resumeToken,r)),i=i.insert(w,D),G=D,$=y,(0===(q=k).resumeToken.approximateByteSize()||G.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=3e8||$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0)&&h.push(t.Bs.updateTargetData(s,D))});let d=wt(),m=re();if(e.documentUpdates.forEach(y=>{e.resolvedLimboDocuments.has(y)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(s,y))}),h.push(Nm(s,a,e.documentUpdates).next(y=>{d=y.nr,m=y.sr})),!r.isEqual(Y.min())){const y=t.Bs.getLastRemoteSnapshotVersion(s).next(w=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));h.push(y)}return C.waitFor(h).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,m)).next(()=>d)}).then(s=>(t.Ji=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.yc.get(s);a&&(X(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.fc=!0:i.modifiedDocuments.size>0?X(a.fc):i.removedDocuments.size>0&&(X(a.fc),a.fc=!1))}),yield sr(t,r,e)}catch(r){yield Tn(r)}}),mf.apply(this,arguments)}function Jm(n,e,t){const r=z(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.wc.forEach((s,a)=>{const h=a.view.Mu(e);h.snapshot&&i.push(h.snapshot)}),function(s,a){const h=z(s);h.onlineState=a;let d=!1;h.queries.forEach((m,y)=>{for(const w of y.listeners)w.Mu(a)&&(d=!0)}),d&&uf(h)}(r.eventManager,e),i.length&&r.dc.nu(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function av(n,e,t){return gf.apply(this,arguments)}function gf(){return gf=(0,E.Z)(function*(n,e,t){const r=z(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.yc.get(e),s=i&&i.key;if(s){let a=new xe(Z.comparator);a=a.insert(s,Le.newNoDocument(s,Y.min()));const h=re().add(s),d=new Xi(Y.min(),new Map,new xe(ae),a,h);yield Xm(r,d),r.gc=r.gc.remove(s),r.yc.delete(e),Ef(r)}else yield Vo(r.localStore,e,!1).then(()=>jo(r,e,t)).catch(Tn)}),gf.apply(this,arguments)}function uv(n,e){return _f.apply(this,arguments)}function _f(){return _f=(0,E.Z)(function*(n,e){const t=z(n),r=e.batch.batchId;try{const i=yield function Sy(n,e){const t=z(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(a,h,d,m){const y=d.batch,w=y.keys();let k=C.resolve();return w.forEach(D=>{k=k.next(()=>m.getEntry(h,D)).next(q=>{const G=d.docVersions.get(D);X(null!==G),q.version.compareTo(G)<0&&(y.applyToRemoteDocument(q,d),q.isValidDocument()&&(q.setReadTime(d.commitVersion),m.addEntry(q)))})}),k.next(()=>a.mutationQueue.removeMutationBatch(h,y))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let h=re();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(h=h.add(a.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);wf(t,r,null),If(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield sr(t,i)}catch(i){yield Tn(i)}}),_f.apply(this,arguments)}function cv(n,e,t){return yf.apply(this,arguments)}function yf(){return yf=(0,E.Z)(function*(n,e,t){const r=z(n);try{const i=yield function(s,a){const h=z(s);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return h.mutationQueue.lookupMutationBatch(d,a).next(y=>(X(null!==y),m=y.keys(),h.mutationQueue.removeMutationBatch(d,y))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,m,a)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>h.localDocuments.getDocuments(d,m))})}(r.localStore,e);wf(r,e,t),If(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield sr(r,i)}catch(i){yield Tn(i)}}),yf.apply(this,arguments)}function vf(){return vf=(0,E.Z)(function*(n,e){const t=z(n);Gr(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(s){const a=z(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>a.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.Ec.get(r)||[];i.push(e),t.Ec.set(r,i)}catch(r){const i=Zo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),vf.apply(this,arguments)}function If(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function wf(n,e,t){const r=z(n);let i=r.Tc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Tc[r.currentUser.toKey()]=i}}function jo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||eg(n,r)})}function eg(n,e){n.mc.delete(e.path.canonicalString());const t=n.gc.get(e);null!==t&&(ju(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),Ef(n))}function Tf(n,e,t){for(const r of t)r instanceof Wm?(n.Ic.addReference(r.key,e),hv(n,r)):r instanceof Qm?(U("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||eg(n,r.key)):H()}function hv(n,e){const t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(U("SyncEngine","New document in limbo: "+t),n.mc.add(r),Ef(n))}function Ef(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){const e=n.mc.values().next().value;n.mc.delete(e);const t=new Z(_e.fromString(e)),r=n.Ac.next();n.yc.set(r,new nv(t)),n.gc=n.gc.insert(t,r),zl(n.remoteStore,new ir(ft(Nn(t.path)),r,"TargetPurposeLimboResolution",xt.ct))}}function sr(n,e,t){return Af.apply(this,arguments)}function Af(){return Af=(0,E.Z)(function*(n,e,t){const r=z(n),i=[],s=[],a=[];var h;r.wc.isEmpty()||(r.wc.forEach((h,d)=>{a.push(r.Rc(d,e,t).then(m=>{if((m||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(d.targetId,null!=m&&m.fromCache?"not-current":"current"),m){i.push(m);const y=xd.Li(d.targetId,m);s.push(y)}}))}),yield Promise.all(a),r.dc.nu(i),yield(h=(0,E.Z)(function*(d,m){const y=z(d);try{yield y.persistence.runTransaction("notifyLocalViewChanges","readwrite",w=>C.forEach(m,k=>C.forEach(k.Fi,D=>y.persistence.referenceDelegate.addReference(w,k.targetId,D)).next(()=>C.forEach(k.Bi,D=>y.persistence.referenceDelegate.removeReference(w,k.targetId,D)))))}catch(w){if(!vt(w))throw w;U("LocalStore","Failed to update sequence numbers: "+w)}for(const w of m){const k=w.targetId;if(!w.fromCache){const D=y.Ji.get(k),G=D.withLastLimboFreeSnapshotVersion(D.snapshotVersion);y.Ji=y.Ji.insert(k,G)}}}),function(d,m){return h.apply(this,arguments)})(r.localStore,s))}),Af.apply(this,arguments)}function dv(n,e){return Sf.apply(this,arguments)}function Sf(){return Sf=(0,E.Z)(function*(n,e){const t=z(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const r=yield km(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(a=>{a.forEach(h=>{h.reject(new M(N.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield sr(t,r.er)}var i}),Sf.apply(this,arguments)}function fv(n,e){const t=z(n),r=t.yc.get(e);if(r&&r.fc)return re().add(r.key);{let i=re();const s=t._c.get(e);if(!s)return i;for(const a of s){const h=t.wc.get(a);i=i.unionWith(h.view.nc)}return i}}function pv(n,e){return bf.apply(this,arguments)}function bf(){return bf=(0,E.Z)(function*(n,e){const t=z(n),r=yield Vl(t.localStore,e.query,!0),i=e.view.hc(r);return t.isPrimaryClient&&Tf(t,e.targetId,i.cc),i}),bf.apply(this,arguments)}function mv(n,e){return xf.apply(this,arguments)}function xf(){return xf=(0,E.Z)(function*(n,e){const t=z(n);return Dm(t.localStore,e).then(r=>sr(t,r))}),xf.apply(this,arguments)}function gv(n,e,t,r){return kf.apply(this,arguments)}function kf(){return kf=(0,E.Z)(function*(n,e,t,r){const i=z(n),s=yield function(a,h){const d=z(a),m=z(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",y=>m.Sn(y,h).next(w=>w?d.localDocuments.getDocuments(y,w):C.resolve(null)))}(i.localStore,e);var h;null!==s?("pending"===t?yield Bo(i.remoteStore):"acknowledged"===t||"rejected"===t?(wf(i,e,r||null),If(i,e),h=e,z(z(i.localStore).mutationQueue).Cn(h)):H(),yield sr(i,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)}),kf.apply(this,arguments)}function Cf(){return Cf=(0,E.Z)(function*(n,e){const t=z(n);if(Pf(t),Of(t),!0===e&&!0!==t.vc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield tg(t,r.toArray());t.vc=!0,yield ef(t.remoteStore,!0);for(const s of i)zl(t.remoteStore,s)}else if(!1===e&&!1!==t.vc){const r=[];let i=Promise.resolve();t._c.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?r.push(a):i=i.then(()=>(jo(t,a),Vo(t.localStore,a,!0))),ju(t.remoteStore,a)}),yield i,yield tg(t,r),function(s){const a=z(s);a.yc.forEach((h,d)=>{ju(a.remoteStore,d)}),a.Ic.Ts(),a.yc=new Map,a.gc=new xe(Z.comparator)}(t),t.vc=!1,yield ef(t.remoteStore,!1)}}),Cf.apply(this,arguments)}function tg(n,e,t){return Nf.apply(this,arguments)}function Nf(){return Nf=(0,E.Z)(function*(n,e,t){const r=z(n),i=[],s=[];for(const a of e){let h;const d=r._c.get(a);if(d&&0!==d.length){h=yield Uo(r.localStore,ft(d[0]));for(const m of d){const y=r.wc.get(m),w=yield pv(r,y);w.snapshot&&s.push(w.snapshot)}}else{const m=yield Rm(r.localStore,a);h=yield Uo(r.localStore,m),yield hf(r,ng(m),a,!1,h.resumeToken)}i.push(h)}return r.dc.nu(s),i}),Nf.apply(this,arguments)}function ng(n){return vl(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function yv(n){const e=z(n);return z(z(e.localStore).persistence).$i()}function vv(n,e,t,r){return Rf.apply(this,arguments)}function Rf(){return Rf=(0,E.Z)(function*(n,e,t,r){const i=z(n);if(i.vc)return void U("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=yield Dm(i.localStore,Mr(s[0])),h=Xi.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,Ye.EMPTY_BYTE_STRING);yield sr(i,a,h);break}case"rejected":yield Vo(i.localStore,e,!0),jo(i,e,r);break;default:H()}}),Rf.apply(this,arguments)}function Iv(n,e,t){return Df.apply(this,arguments)}function Df(){return Df=(0,E.Z)(function*(n,e,t){const r=Pf(n);if(r.vc){for(const i of e){if(r._c.has(i)){U("SyncEngine","Adding an already active target "+i);continue}const s=yield Rm(r.localStore,i),a=yield Uo(r.localStore,s);yield hf(r,ng(s),a.targetId,!1,a.resumeToken),zl(r.remoteStore,a)}for(const i of t)r._c.has(i)&&(yield Vo(r.localStore,i,!1).then(()=>{ju(r.remoteStore,i),jo(r,i)}).catch(Tn))}}),Df.apply(this,arguments)}function Pf(n){const e=z(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=av.bind(null,e),e.dc.nu=Yy.bind(null,e.eventManager),e.dc.Pc=Xy.bind(null,e.eventManager),e}function Of(n){const e=z(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cv.bind(null,e),e}class Hu{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,E.Z)(function*(){t.serializer=zu(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return xm(this.persistence,new bm,e.initialUser,this.serializer)}createPersistence(e){return new Ed(Ll.zs,this.serializer)}createSharedClientState(e){return new Lm}terminate(){var e=this;return(0,E.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Mf extends Hu{constructor(e,t,r){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,E.Z)(function*(){yield t().call(r,e),yield r.Vc.initialize(r,e),yield Of(r.Vc.syncEngine),yield Bo(r.Vc.remoteStore),yield r.persistence.Ii(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return xm(this.persistence,new bm,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new _m(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new Yc(t,this.persistence);return new tu(e.asyncQueue,r)}createPersistence(e){const t=bd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Tt.withCacheSize(this.cacheSizeBytes):Tt.DEFAULT;return new Sd(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Um(),Zl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Lm}}class rg extends Mf{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,E.Z)(function*(){yield t().call(r,e);const i=r.Vc.syncEngine;r.sharedClientState instanceof Md&&(r.sharedClientState.syncEngine={jr:gv.bind(null,i),zr:vv.bind(null,i),Wr:Iv.bind(null,i),$i:yv.bind(null,i),Qr:mv.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.Ii(function(){var s=(0,E.Z)(function*(a){yield function _v(n,e){return Cf.apply(this,arguments)}(r.Vc.syncEngine,a),r.gcScheduler&&(a&&!r.gcScheduler.started?r.gcScheduler.start():a||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(a&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():a||r.indexBackfillerScheduler.stop())});return function(a){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const t=Um();if(!Md.D(t))throw new M(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=bd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Md(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Ho{initialize(e,t){var r=this;return(0,E.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Jm(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=dv.bind(null,r.syncEngine),yield ef(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Qy}createDatastore(e){const t=zu(e.databaseInfo.databaseId),r=new Py(e.databaseInfo);return new Ly(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,s=h=>Jm(this.syncEngine,h,0),a=Fm.D()?new Fm:new Ny,new Vy(t,r,i,s,a);var t,r,i,s,a}createSyncEngine(e,t){return function(r,i,s,a,h,d,m){const y=new rv(r,i,s,a,h,d);return m&&(y.vc=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,E.Z)(function*(t){const r=z(t);U("RemoteStore","RemoteStore shutting down."),r.vu.add(5),yield qo(r),r.Pu.shutdown(),r.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function ig(n,e=10240){let t=0;return{read:()=>(0,E.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,E.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class jl{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Ve("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Ev{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new We,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==r?void 0:r.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}getMetadata(){var e=this;return(0,E.Z)(function*(){return e.metadata.promise})()}bc(){var e=this;return(0,E.Z)(function*(){return yield e.getMetadata(),e.Nc()})()}Nc(){var e=this;return(0,E.Z)(function*(){const t=yield e.kc();if(null===t)return null;const r=e.xc.decode(t),i=Number(r);isNaN(i)&&e.Mc(`length string (${r}) is not valid number`);const s=yield e.$c(i);return new Jy(JSON.parse(s),t.length+i)})()}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}kc(){var e=this;return(0,E.Z)(function*(){for(;e.Oc()<0&&!(yield e.Fc()););if(0===e.buffer.length)return null;const t=e.Oc();t<0&&e.Mc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}$c(e){var t=this;return(0,E.Z)(function*(){for(;t.buffer.length<e;)(yield t.Fc())&&t.Mc("Reached the end of bundle when more is expected.");const r=t.xc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}Fc(){var e=this;return(0,E.Z)(function*(){const t=yield e.Cc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class Av{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,E.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new M(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,E.Z)(function*(s,a){const h=z(s),d=Ou(h.serializer)+"/documents",m={documents:a.map(D=>Pu(h.serializer,D))},y=yield h.vo("BatchGetDocuments",d,m,a.length),w=new Map;y.forEach(D=>{const q=function $_(n,e){return"found"in e?function(t,r){X(!!r.found);const i=Rn(t,r.found.name),s=et(r.found.updateTime),a=r.found.createTime?et(r.found.createTime):Y.min(),h=new Xe({mapValue:{fields:r.found.fields}});return Le.newFoundDocument(i,s,a,h)}(n,e):"missing"in e?function(t,r){X(!!r.missing),X(!!r.readTime);const i=Rn(t,r.missing),s=et(r.readTime);return Le.newNoDocument(i,s)}(n,e):H()}(h.serializer,D);w.set(q.key.toString(),q)});const k=[];return a.forEach(D=>{const q=w.get(D.toString());X(!!q),k.push(q)}),k}),function(s,a){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new g(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,E.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=Z.fromPath(i);e.mutations.push(new A(s,e.precondition(s)))}),yield(r=(0,E.Z)(function*(i,s){const a=z(i),h=Ou(a.serializer)+"/documents",d={writes:s.map(m=>Mu(a.serializer,m))};yield a.Io("Commit",h,d)}),function(i,s){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw H();t=Y.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new M(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?Pe.exists(!1):Pe.updateTime(t):Pe.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new M(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Pe.updateTime(t)}return Pe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Sv{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Bc=r.maxAttempts,this.qo=new Fd(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){var e=this;this.qo.No((0,E.Z)(function*(){const t=new Av(e.datastore),r=e.qc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.Uc(s)}))}).catch(i=>{e.Uc(i)})}))}qc(e){try{const t=this.updateFunction(e);return!Ni(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Ki(t)}return!1}}class bv{constructor(e,t,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ze.UNAUTHENTICATED,this.clientId=jc.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var a=(0,E.Z)(function*(h){U("FirestoreClient","Received user=",h.uid),yield s.authCredentialListener(h),s.user=h});return function(h){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(r,a=>(U("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}getConfiguration(){var e=this;return(0,E.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new We;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,E.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Zo(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Hl(n,e){return Lf.apply(this,arguments)}function Lf(){return Lf=(0,E.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,E.Z)(function*(s){r.isEqual(s)||(yield km(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),Lf.apply(this,arguments)}function Ff(n,e){return Uf.apply(this,arguments)}function Uf(){return Uf=(0,E.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Vf(n);U("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>$m(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>$m(e.remoteStore,s)),n._onlineComponents=e}),Uf.apply(this,arguments)}function sg(n){return"FirebaseError"===n.name?n.code===N.FAILED_PRECONDITION||n.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function Vf(n){return qf.apply(this,arguments)}function qf(){return qf=(0,E.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Hl(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!sg(t))throw t;Mt("Error using user provided cache. Falling back to memory cache: "+t),yield Hl(n,new Hu)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield Hl(n,new Hu);return n._offlineComponents}),qf.apply(this,arguments)}function Kl(n){return Bf.apply(this,arguments)}function Bf(){return Bf=(0,E.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield Ff(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield Ff(n,new Ho))),n._onlineComponents}),Bf.apply(this,arguments)}function og(n){return Vf(n).then(e=>e.persistence)}function Wl(n){return Vf(n).then(e=>e.localStore)}function ag(n){return Kl(n).then(e=>e.remoteStore)}function Gf(n){return Kl(n).then(e=>e.syncEngine)}function Ko(n){return Zf.apply(this,arguments)}function Zf(){return Zf=(0,E.Z)(function*(n){const e=yield Kl(n),t=e.eventManager;return t.onListen=iv.bind(null,e.syncEngine),t.onUnlisten=sv.bind(null,e.syncEngine),t}),Zf.apply(this,arguments)}function cg(n,e,t={}){const r=new We;return n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return function(i,s,a,h,d){const m=new jl({next:w=>{s.enqueueAndForget(()=>of(i,y));const k=w.docs.has(a);!k&&w.fromCache?d.reject(new M(N.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&w.fromCache&&h&&"server"===h.source?d.reject(new M(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(w)},error:w=>d.reject(w)}),y=new cf(Nn(a.path),m,{includeMetadataChanges:!0,Ku:!0});return rf(i,y)}(yield Ko(n),n.asyncQueue,e,t,r)})),r.promise}function lg(n,e,t={}){const r=new We;return n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return function(i,s,a,h,d){const m=new jl({next:w=>{s.enqueueAndForget(()=>of(i,y)),w.fromCache&&"server"===h.source?d.reject(new M(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(w)},error:w=>d.reject(w)}),y=new cf(a,m,{includeMetadataChanges:!0,Ku:!0});return rf(i,y)}(yield Ko(n),n.asyncQueue,e,t,r)})),r.promise}function hg(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const dg=new Map;function zf(n,e,t){if(!t)throw new M(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function fg(n,e,t,r){if(!0===e&&!0===r)throw new M(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pg(n){if(!Z.isDocumentKey(n))throw new M(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mg(n){if(Z.isDocumentKey(n))throw new M(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ql(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":H()}function ye(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ql(n);throw new M(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function gg(n,e){if(e<=0)throw new M(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class _g{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new M(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new M(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=hg(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ku{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _g({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new M(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _g(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Zc;switch(t.type){case"firstParty":return new zc(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new M(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=dg.get(e);t&&(U("ComponentProvider","Removing Datastore"),dg.delete(e),t.terminate())}(this),Promise.resolve()}}class qe{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qe(this.firestore,e,this._key)}}class pt{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pt(this.firestore,e,this._query)}}class Dn extends pt{constructor(e,t,r){super(e,t,Nn(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new Z(e))}withConverter(e){return new Dn(this.firestore,e,this._path)}}function vg(n,e,...t){if(n=(0,pe.m9)(n),zf("collection","path",e),n instanceof Ku){const r=_e.fromString(e,...t);return mg(r),new Dn(n,null,r)}{if(!(n instanceof qe||n instanceof Dn))throw new M(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(_e.fromString(e,...t));return mg(r),new Dn(n.firestore,null,r)}}function Yl(n,e,...t){if(n=(0,pe.m9)(n),1===arguments.length&&(e=jc.A()),zf("doc","path",e),n instanceof Ku){const r=_e.fromString(e,...t);return pg(r),new qe(n,null,new Z(r))}{if(!(n instanceof qe||n instanceof Dn))throw new M(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(_e.fromString(e,...t));return pg(r),new qe(n.firestore,n instanceof Dn?n.converter:null,new Z(r))}}function Ig(n,e){return n=(0,pe.m9)(n),e=(0,pe.m9)(e),(n instanceof qe||n instanceof Dn)&&(e instanceof qe||e instanceof Dn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function $f(n,e){return n=(0,pe.m9)(n),e=(0,pe.m9)(e),n instanceof pt&&e instanceof pt&&n.firestore===e.firestore&&qi(n._query,e._query)&&n.converter===e.converter}class Lv{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Fd(this,"async_queue_retry"),this.Xc=()=>{const t=Zl();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=Zl();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=Zl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new We;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return(0,E.Z)(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!vt(t))throw t;U("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{throw this.Wc=r,this.Hc=!1,Ve("INTERNAL UNHANDLED ERROR: ",function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),a}(r)),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=nf.createAndSchedule(this,e,t,r,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&H()}verifyOperationInProgress(){}sa(){var e=this;return(0,E.Z)(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function jf(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class Fv{constructor(){this._progressObserver={},this._taskCompletionResolver=new We,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Be extends Ku{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Lv,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||wg(this),this._firestoreClient.terminate()}}function tt(n){return n._firestoreClient||wg(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function wg(n){var e,t,r;const i=n._freezeSettings(),s=(h=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Jh(n._databaseId,h,n._persistenceKey,(m=i).host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,hg(m.experimentalLongPollingOptions),m.useFetchStreams));var h,m;n._firestoreClient=new bv(n._authCredentials,n._appCheckCredentials,n._queue,s),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(r=i.cache)&&void 0!==r&&r._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function Tg(n,e,t){const r=new We;return n.asyncQueue.enqueue((0,E.Z)(function*(){try{yield Hl(n,t),yield Ff(n,e),r.resolve()}catch(i){const s=i;if(!sg(s))throw s;Mt("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function Eg(n){if(n._initialized||n._terminated)throw new M(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pn(Ye.fromBase64String(e))}catch(t){throw new M(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pn(Ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class or{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new M(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Me(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class os{constructor(e){this._methodName=e}}class Xl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ae(this._lat,e._lat)||ae(this._long,e._long)}}const Kv=/^__.*__$/;class Wv{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new o(e,this.data,this.fieldMask,t,this.fieldTransforms):new c(e,this.data,t,this.fieldTransforms)}}class Ag{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new o(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Sg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}class Jl{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Jl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.fa(e),i}da(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return nh(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Sg(this.ca)&&Kv.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Qv{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||zu(e)}ya(e,t,r,i=!1){return new Jl({ca:e,methodName:t,ga:r,path:Me.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function as(n){const e=n._freezeSettings(),t=zu(n._databaseId);return new Qv(n._databaseId,!!e.ignoreUndefinedProperties,t)}function eh(n,e,t,r,i,s={}){const a=n.ya(s.merge||s.mergeFields?2:0,e,t,i);Qf("Data must be an object, but it was:",a,r);const h=kg(r,a);let d,m;if(s.merge)d=new It(a.fieldMask),m=a.fieldTransforms;else if(s.mergeFields){const y=[];for(const w of s.mergeFields){const k=Yu(e,w,t);if(!a.contains(k))throw new M(N.INVALID_ARGUMENT,`Field '${k}' is specified in your field mask but missing from your input data.`);Ng(y,k)||y.push(k)}d=new It(y),m=a.fieldTransforms.filter(w=>d.covers(w.field))}else d=null,m=a.fieldTransforms;return new Wv(new Xe(h),d,m)}class Qu extends os{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Qu}}function bg(n,e,t){return new Jl({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Hf extends os{_toFieldTransform(e){return new zi(e.path,new er)}isEqual(e){return e instanceof Hf}}class Yv extends os{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=bg(this,e,!0),r=this.pa.map(s=>us(s,t)),i=new tr(r);return new zi(e.path,i)}isEqual(e){return this===e}}class Xv extends os{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=bg(this,e,!0),r=this.pa.map(s=>us(s,t)),i=new nr(r);return new zi(e.path,i)}isEqual(e){return this===e}}class Jv extends os{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new Je(e.serializer,xo(e.serializer,this.Ia));return new zi(e.path,t)}isEqual(e){return this===e}}function Kf(n,e,t,r){const i=n.ya(1,e,t);Qf("Data must be an object, but it was:",i,r);const s=[],a=Xe.empty();An(r,(d,m)=>{const y=th(e,d,t);m=(0,pe.m9)(m);const w=i.da(y);if(m instanceof Qu)s.push(y);else{const k=us(m,w);null!=k&&(s.push(y),a.set(y,k))}});const h=new It(s);return new Ag(a,h,i.fieldTransforms)}function Wf(n,e,t,r,i,s){const a=n.ya(1,e,t),h=[Yu(e,r,t)],d=[i];if(s.length%2!=0)throw new M(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let k=0;k<s.length;k+=2)h.push(Yu(e,s[k])),d.push(s[k+1]);const m=[],y=Xe.empty();for(let k=h.length-1;k>=0;--k)if(!Ng(m,h[k])){const D=h[k];let q=d[k];q=(0,pe.m9)(q);const G=a.da(D);if(q instanceof Qu)m.push(D);else{const $=us(q,G);null!=$&&(m.push(D),y.set(D,$))}}const w=new It(m);return new Ag(y,w,a.fieldTransforms)}function xg(n,e,t,r=!1){return us(t,n.ya(r?4:3,e))}function us(n,e){if(Cg(n=(0,pe.m9)(n)))return Qf("Unsupported field value:",e,n),kg(n,e);if(n instanceof os)return function(t,r){if(!Sg(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,r){const i=[];let s=0;for(const a of t){let h=us(a,r.wa(s));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),s++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,pe.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return xo(r.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=Oe.fromDate(t);return{timestampValue:Oo(r.serializer,i)}}if(t instanceof Oe){const i=new Oe(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Oo(r.serializer,i)}}if(t instanceof Xl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Pn)return{bytesValue:qp(r.serializer,t._byteString)};if(t instanceof qe){const i=r.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:hd(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${Ql(t)}`)}(n,e)}function kg(n,e){const t={};return cu(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):An(n,(r,i)=>{const s=us(i,e.ha(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function Cg(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Oe||n instanceof Xl||n instanceof Pn||n instanceof qe||n instanceof os)}function Qf(n,e,t){if(!Cg(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=Ql(t);throw e._a("an object"===r?n+" a custom object":n+" "+r)}var r}function Yu(n,e,t){if((e=(0,pe.m9)(e))instanceof or)return e._internalPath;if("string"==typeof e)return th(n,e);throw nh("Field path arguments must be of type string or ",n,!1,void 0,t)}const e0=new RegExp("[~\\*/\\[\\]]");function th(n,e,t){if(e.search(e0)>=0)throw nh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new or(...e.split("."))._internalPath}catch{throw nh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function nh(n,e,t,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(s||a)&&(d+=" (found",s&&(d+=` in field ${r}`),a&&(d+=` in document ${i}`),d+=")"),new M(N.INVALID_ARGUMENT,h+n+d)}function Ng(n,e){return n.some(t=>t.isEqual(e))}class Xu{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new t0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(rh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class t0 extends Xu{data(){return super.data()}}function rh(n,e){return"string"==typeof e?th(n,e):e instanceof or?e._internalPath:e._delegate._internalPath}function Rg(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new M(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yf{}class Ju extends Yf{}function zr(n,e,...t){let r=[];e instanceof Yf&&r.push(e),r=r.concat(t),function(i){const s=i.filter(h=>h instanceof Wo).length,a=i.filter(h=>h instanceof ec).length;if(s>1||s>0&&a>0)throw new M(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class ec extends Ju{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ec(e,t,r)}_apply(e){const t=this._parse(e);return Mg(e._query,t),new pt(e.firestore,e.converter,Eu(e._query,t))}_parse(e){const t=as(e.firestore);return function(i,s,a,h,d,m,y){let w;if(d.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new M(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if("in"===m||"not-in"===m){Og(y,m);const k=[];for(const D of y)k.push(Pg(h,i,D));w={arrayValue:{values:k}}}else w=Pg(h,i,y)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||Og(y,m),w=xg(a,"where",y,"in"===m||"not-in"===m);return ge.create(d,m,w)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Wo extends Yf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Wo(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:Te.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(r,i){let s=r;const a=i.getFlattenedFilters();for(const h of a)Mg(s,h),s=Eu(s,h)}(e._query,t),new pt(e.firestore,e.converter,Eu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Xf extends Ju{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Xf(e,t)}_apply(e){const t=function(r,i,s){if(null!==r.startAt)throw new M(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new M(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Yn(i,s);return function(h,d){if(null===Tu(h)){const m=Eo(h);null!==m&&Lg(0,m,d.field)}}(r,a),a}(e._query,this._field,this._direction);return new pt(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new ln(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class ih extends Ju{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new ih(e,t,r)}_apply(e){return new pt(e.firestore,e.converter,Vi(e._query,this._limit,this._limitType))}}class sh extends Ju{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new sh(e,t,r)}_apply(e){const t=Dg(e,this.type,this._docOrFields,this._inclusive);return new pt(e.firestore,e.converter,(i=t,new ln((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class oh extends Ju{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new oh(e,t,r)}_apply(e){const t=Dg(e,this.type,this._docOrFields,this._inclusive);return new pt(e.firestore,e.converter,(i=t,new ln((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function Dg(n,e,t,r){if(t[0]=(0,pe.m9)(t[0]),t[0]instanceof Xu)return function(i,s,a,h,d){if(!h)throw new M(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const m=[];for(const y of Jn(i))if(y.field.isKeyField())m.push(Wn(s,h.key));else{const w=h.data.field(y.field);if(po(w))throw new M(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===w){const k=y.field.canonicalString();throw new M(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${k}' (used as the orderBy) does not exist.`)}m.push(w)}return new Qt(m,d)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=as(n.firestore);return function(s,a,h,d,m,y){const w=s.explicitOrderBy;if(m.length>w.length)throw new M(N.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const k=[];for(let D=0;D<m.length;D++){const q=m[D];if(w[D].field.isKeyField()){if("string"!=typeof q)throw new M(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof q}`);if(!Or(s)&&-1!==q.indexOf("/"))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${q}' contains a slash.`);const G=s.path.child(_e.fromString(q));if(!Z.isDocumentKey(G))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${G}' is not because it contains an odd number of segments.`);const $=new Z(G);k.push(Wn(a,$))}else{const G=xg(h,d,q);k.push(G)}}return new Qt(k,y)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Pg(n,e,t){if("string"==typeof(t=(0,pe.m9)(t))){if(""===t)throw new M(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Or(e)&&-1!==t.indexOf("/"))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(_e.fromString(t));if(!Z.isDocumentKey(r))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wn(n,new Z(r))}if(t instanceof qe)return Wn(n,t._key);throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ql(t)}.`)}function Og(n,e){if(!Array.isArray(n)||0===n.length)throw new M(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mg(n,e){if(e.isInequality()){const r=Eo(n),i=e.field;if(null!==r&&!r.isEqual(i))throw new M(N.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=Tu(n);null!==s&&Lg(0,i,s)}const t=function(r,i){for(const s of r)for(const a of s.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new M(N.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Lg(n,e,t){if(!t.isEqual(e))throw new M(N.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class Jf{convertValue(e,t="none"){switch(xn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ft(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw H()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return An(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new Xl($e(e.latitude),$e(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=mo(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Pi(e));default:return null}}convertTimestamp(e){const t=cn(e);return new Oe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=_e.fromString(e);X(Qp(r));const i=new Sn(r.get(1),r.get(3)),s=new Z(r.popFirst(5));return i.isEqual(t)||Ve(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function ah(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class h0 extends Jf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}}class cs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ar extends Xu{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new tc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(rh("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class tc extends ar{data(e={}){return super.data(e)}}class $r{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new cs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new tc(this._firestore,this._userDataWriter,r.key,r,new cs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(a=>({type:"added",doc:new tc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cs(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||3!==a.type).map(a=>{const h=new tc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new cs(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let d=-1,m=-1;return 0!==a.type&&(d=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),1!==a.type&&(s=s.add(a.doc),m=s.indexOf(a.doc.key)),{type:f0(a.type),doc:h,oldIndex:d,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function f0(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}function Ug(n,e){return n instanceof ar&&e instanceof ar?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof $r&&e instanceof $r&&n._firestore===e._firestore&&$f(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class jr extends Jf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,t)}}function Vg(n,e,t){n=ye(n,qe);const r=ye(n.firestore,Be),i=ah(n.converter,e,t);return Qo(r,[eh(as(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Pe.none())])}function qg(n,e,t,...r){n=ye(n,qe);const i=ye(n.firestore,Be),s=as(i);let a;return a="string"==typeof(e=(0,pe.m9)(e))||e instanceof or?Wf(s,"updateDoc",n._key,e,t,r):Kf(s,"updateDoc",n._key,e),Qo(i,[a.toMutation(n._key,Pe.exists(!0))])}function Bg(n,...e){var t,r,i;n=(0,pe.m9)(n);let s={includeMetadataChanges:!1},a=0;"object"!=typeof e[a]||jf(e[a])||(s=e[a],a++);const h={includeMetadataChanges:s.includeMetadataChanges};if(jf(e[a])){const w=e[a];e[a]=null===(t=w.next)||void 0===t?void 0:t.bind(w),e[a+1]=null===(r=w.error)||void 0===r?void 0:r.bind(w),e[a+2]=null===(i=w.complete)||void 0===i?void 0:i.bind(w)}let d,m,y;if(n instanceof qe)m=ye(n.firestore,Be),y=Nn(n._key.path),d={next:w=>{e[a]&&e[a](ep(m,n,w))},error:e[a+1],complete:e[a+2]};else{const w=ye(n,pt);m=ye(w.firestore,Be),y=w._query;const k=new jr(m);d={next:D=>{e[a]&&e[a](new $r(m,k,w,D))},error:e[a+1],complete:e[a+2]},Rg(n._query)}return function(w,k,D,q){const G=new jl(q),$=new cf(k,G,D);return w.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return rf(yield Ko(w),$)})),()=>{G.Dc(),w.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return of(yield Ko(w),$)}))}}(tt(m),y,h,d)}function Qo(n,e){return function(t,r){const i=new We;return t.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return function ov(n,e,t){return pf.apply(this,arguments)}(yield Gf(t),r,i)})),i.promise}(tt(n),e)}function ep(n,e,t){const r=t.docs.get(e._key),i=new jr(n);return new ar(n,i,e._key,r,new cs(t.hasPendingWrites,t.fromCache),e.converter)}const R0={maxAttempts:5};class Gg{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=as(e)}set(e,t,r){this._verifyNotCommitted();const i=Hr(e,this._firestore),s=ah(i.converter,t,r),a=eh(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(a.toMutation(i._key,Pe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=Hr(e,this._firestore);let a;return a="string"==typeof(t=(0,pe.m9)(t))||t instanceof or?Wf(this._dataReader,"WriteBatch.update",s._key,t,r,i):Kf(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Pe.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Hr(e,this._firestore);return this._mutations=this._mutations.concat(new g(t._key,Pe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Hr(n,e){if((n=(0,pe.m9)(n)).firestore!==e)throw new M(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class D0 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=as(e)}get(e){const t=Hr(e,this._firestore),r=new h0(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return H();const s=i[0];if(s.isFoundDocument())return new Xu(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new Xu(this._firestore,r,t._key,null,t.converter);throw H()})}set(e,t,r){const i=Hr(e,this._firestore),s=ah(i.converter,t,r),a=eh(this._dataReader,"Transaction.set",i._key,s,null!==i.converter,r);return this._transaction.set(i._key,a),this}update(e,t,r,...i){const s=Hr(e,this._firestore);let a;return a="string"==typeof(t=(0,pe.m9)(t))||t instanceof or?Wf(this._dataReader,"Transaction.update",s._key,t,r,i):Kf(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,a),this}delete(e){const t=Hr(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Hr(e,this._firestore),r=new jr(this._firestore);return super.get(e).then(i=>new ar(this._firestore,r,t._key,i._document,new cs(!1,!1),t.converter))}}function tp(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new M("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function zg(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function $g(){if(!function lu(){return typeof atob<"u"}())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){br=V.SDK_VERSION,(0,V._registerComponent)(new lt.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const s=t.getProvider("app").getImmediate(),a=new Be(new Vh(t.getProvider("auth-internal")),new qh(t.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new M(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sn(h.options.projectId,d)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),(0,V.registerVersion)(Gc,"3.13.0",n),(0,V.registerVersion)(Gc,"3.13.0","esm2017")}();class nc{constructor(e){this._delegate=e}static fromBase64String(e){return $g(),new nc(Pn.fromBase64String(e))}static fromUint8Array(e){return zg(),new nc(Pn.fromUint8Array(e))}toBase64(){return $g(),this._delegate.toBase64()}toUint8Array(){return zg(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function np(n){return function B0(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class G0{enableIndexedDbPersistence(e,t){return function Vv(n,e){Eg(n=ye(n,Be));const t=tt(n);if(t._uninitializedComponentsProvider)throw new M(N.FAILED_PRECONDITION,"SDK cache is already specified.");Mt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new Ho;return Tg(t,i,new Mf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function qv(n){Eg(n=ye(n,Be));const e=tt(n);if(e._uninitializedComponentsProvider)throw new M(N.FAILED_PRECONDITION,"SDK cache is already specified.");Mt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new Ho;return Tg(e,r,new rg(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Bv(n){if(n._initialized&&!n._terminated)throw new M(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new We;return n._queue.enqueueAndForgetEvenWhileRestricted((0,E.Z)(function*(){try{yield(t=(0,E.Z)(function*(r){if(!Zt.D())return Promise.resolve();const i=r+"main";yield Zt.delete(i)}),function(r){return t.apply(this,arguments)})(bd(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class jg{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Sn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Mt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function yg(n,e,t,r={}){var i;const s=(n=ye(n,Ku))._getSettings(),a=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&Mt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let h,d;if("string"==typeof r.mockUserToken)h=r.mockUserToken,d=ze.MOCK_USER;else{h=(0,pe.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new M(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ze(m)}n._authCredentials=new Wa(new io(h,d))}}(this._delegate,e,t,r)}enableNetwork(){return function Zv(n){return function xv(n){return n.asyncQueue.enqueue((0,E.Z)(function*(){const e=yield og(n),t=yield ag(n);return e.setNetworkEnabled(!0),function(r){const i=z(r);return i.vu.delete(0),$u(i)}(t)}))}(tt(n=ye(n,Be)))}(this._delegate)}disableNetwork(){return function zv(n){return function kv(n){return n.asyncQueue.enqueue((0,E.Z)(function*(){const e=yield og(n),t=yield ag(n);return e.setNetworkEnabled(!1),(r=(0,E.Z)(function*(i){const s=z(i);s.vu.add(0),yield qo(s),s.bu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(tt(n=ye(n,Be)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,fg("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Gv(n){return function(e){const t=new We;return e.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return function lv(n,e){return vf.apply(this,arguments)}(yield Gf(e),t)})),t.promise}(tt(n=ye(n,Be)))}(this._delegate)}onSnapshotsInSync(e){return function T0(n,e){return function Rv(n,e){const t=new jl(e);return n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return r=yield Ko(n),i=t,z(r).ku.add(i),void i.next();var r,i})),()=>{t.Dc(),n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return r=yield Ko(n),i=t,void z(r).ku.delete(i);var r,i}))}}(tt(n=ye(n,Be)),jf(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Yo(this,vg(this._delegate,e))}catch(t){throw kt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Yt(this,Yl(this._delegate,e))}catch(t){throw kt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ct(this,function Mv(n,e){if(n=ye(n,Ku),zf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new pt(n,null,(t=e,new ln(_e.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw kt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function P0(n,e,t){n=ye(n,Be);const r=Object.assign(Object.assign({},R0),t);return function(i){if(i.maxAttempts<1)throw new M(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,a){const h=new We;return i.asyncQueue.enqueueAndForget((0,E.Z)(function*(){const d=yield function ug(n){return Kl(n).then(e=>e.datastore)}(i);new Sv(i.asyncQueue,d,a,s,h).run()})),h.promise}(tt(n),i=>e(new D0(n,i)),r)}(this._delegate,t=>e(new Hg(this,t)))}batch(){return tt(this._delegate),new Kg(new Gg(this._delegate,e=>Qo(this._delegate,e)))}loadBundle(e){return function $v(n,e){const t=tt(n=ye(n,Be)),r=new Fv;return function Dv(n,e,t,r){const i=function(s,a){let h;return h="string"==typeof s?Cu().encode(s):s,d=function(d,m){if(d instanceof Uint8Array)return ig(d,m);if(d instanceof ArrayBuffer)return ig(new Uint8Array(d),m);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new Ev(d,a);var d}(t,zu(e));n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){!function wv(n,e,t){const r=z(n);var i;(i=(0,E.Z)(function*(s,a,h){try{const d=yield a.getMetadata();if(yield function(k,D){const q=z(k),G=et(D.createTime);return q.persistence.runTransaction("hasNewerBundle","readonly",$=>q.qs.getBundleMetadata($,D.id)).then($=>!!$&&$.createTime.compareTo(G)>=0)}(s.localStore,d))return yield a.close(),h._completeWith({taskState:"Success",documentsLoaded:(k=d).totalDocuments,bytesLoaded:k.totalBytes,totalDocuments:k.totalDocuments,totalBytes:k.totalBytes}),Promise.resolve(new Set);h._updateProgress(Km(d));const m=new ev(d,s.localStore,a.serializer);let y=yield a.bc();for(;y;){const k=yield m.zu(y);k&&h._updateProgress(k),y=yield a.bc()}const w=yield m.complete();return yield sr(s,w.Ju,void 0),yield function(k,D){const q=z(k);return q.persistence.runTransaction("Save bundle","readwrite",G=>q.qs.saveBundleMetadata(G,D))}(s.localStore,d),h._completeWith(w.progress),Promise.resolve(w.Hu)}catch(d){return Mt("SyncEngine",`Loading bundle failed with ${d}`),h._failWith(d),Promise.resolve(new Set)}var k}),function(s,a,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Gf(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function jv(n,e){return function Pv(n,e){return n.asyncQueue.enqueue((0,E.Z)(function*(){return function(t,r){const i=z(t);return i.persistence.runTransaction("Get named query","readonly",s=>i.qs.getNamedQuery(s,r))}(yield Wl(n),e)}))}(tt(n=ye(n,Be)),e).then(t=>t?new pt(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ct(this,t):null)}}class uh extends Jf{constructor(e){super(),this.firestore=e}convertBytes(e){return new nc(new Pn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Yt.forKey(t,this.firestore,null)}}class Hg{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new uh(e)}get(e){const t=hs(e);return this._delegate.get(t).then(r=>new rc(this._firestore,new ar(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=hs(e);return r?(tp("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=hs(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=hs(e);return this._delegate.delete(t),this}}class Kg{constructor(e){this._delegate=e}set(e,t,r){const i=hs(e);return r?(tp("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=hs(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=hs(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ls{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new tc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ic(this._firestore,r),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ls.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new ls(e,new uh(e),t),i.set(t,s)),s}}ls.INSTANCES=new WeakMap;class Yt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new uh(e)}static forPath(e,t,r){if(e.length%2!=0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Yt(t,new qe(t._delegate,r,new Z(e)))}static forKey(e,t,r){return new Yt(t,new qe(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Yo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Yo(this.firestore,vg(this._delegate,e))}catch(t){throw kt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,pe.m9)(e))instanceof qe&&Ig(this._delegate,e)}set(e,t){t=tp("DocumentReference.set",t);try{return t?Vg(this._delegate,e,t):Vg(this._delegate,e)}catch(r){throw kt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?qg(this._delegate,e):qg(this._delegate,e,t,...r)}catch(i){throw kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return function I0(n){return Qo(ye(n.firestore,Be),[new g(n._key,Pe.none())])}(this._delegate)}onSnapshot(...e){const t=Wg(e),r=Qg(e,i=>new rc(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Bg(this._delegate,t,r)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function m0(n){n=ye(n,qe);const e=ye(n.firestore,Be),t=tt(e),r=new jr(e);return function Cv(n,e){const t=new We;return n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return(r=(0,E.Z)(function*(i,s,a){try{const h=yield function(d,m){const y=z(d);return y.persistence.runTransaction("read document","readonly",w=>y.localDocuments.getDocument(w,m))}(i,s);h.isFoundDocument()?a.resolve(h):h.isNoDocument()?a.resolve(null):a.reject(new M(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const d=Zo(h,`Failed to get document '${s} from cache`);a.reject(d)}}),function(i,s,a){return r.apply(this,arguments)})(yield Wl(n),e,t);var r})),t.promise}(t,n._key).then(i=>new ar(e,r,n._key,i,new cs(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function g0(n){n=ye(n,qe);const e=ye(n.firestore,Be);return cg(tt(e),n._key,{source:"server"}).then(t=>ep(e,n,t))}(this._delegate):function p0(n){n=ye(n,qe);const e=ye(n.firestore,Be);return cg(tt(e),n._key).then(t=>ep(e,n,t))}(this._delegate),t.then(r=>new rc(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Yt(this.firestore,this._delegate.withConverter(e?ls.getInstance(this.firestore,e):null))}}function kt(n,e,t){return n.message=n.message.replace(e,t),n}function Wg(n){for(const e of n)if("object"==typeof e&&!np(e))return e;return{}}function Qg(n,e){var t,r;let i;return i=np(n[0])?n[0]:np(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class rc{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Yt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Ug(this._delegate,e._delegate)}}class ic extends rc{data(e){const t=this._delegate.data(e);return function ro(n,e){n||H()}(void 0!==t),t}}class Ct{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new uh(e)}where(e,t,r){try{return new Ct(this.firestore,zr(this._delegate,function n0(n,e,t){const r=e,i=rh("where",n);return ec._create(i,r,t)}(e,t,r)))}catch(i){throw kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ct(this.firestore,zr(this._delegate,function r0(n,e="asc"){const t=e,r=rh("orderBy",n);return Xf._create(r,t)}(e,t)))}catch(r){throw kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ct(this.firestore,zr(this._delegate,function s0(n){return gg("limit",n),ih._create("limit",n,"F")}(e)))}catch(t){throw kt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ct(this.firestore,zr(this._delegate,function o0(n){return gg("limitToLast",n),ih._create("limitToLast",n,"L")}(e)))}catch(t){throw kt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ct(this.firestore,zr(this._delegate,function a0(...n){return sh._create("startAt",n,!0)}(...e)))}catch(t){throw kt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ct(this.firestore,zr(this._delegate,function u0(...n){return sh._create("startAfter",n,!1)}(...e)))}catch(t){throw kt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ct(this.firestore,zr(this._delegate,function c0(...n){return oh._create("endBefore",n,!1)}(...e)))}catch(t){throw kt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ct(this.firestore,zr(this._delegate,function l0(...n){return oh._create("endAt",n,!0)}(...e)))}catch(t){throw kt(t,"endAt()","Query.endAt()")}}isEqual(e){return $f(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function y0(n){n=ye(n,pt);const e=ye(n.firestore,Be),t=tt(e),r=new jr(e);return function Nv(n,e){const t=new We;return n.asyncQueue.enqueueAndForget((0,E.Z)(function*(){return(r=(0,E.Z)(function*(i,s,a){try{const h=yield Vl(i,s,!0),d=new Ym(s,h.ir),m=d.sc(h.documents),y=d.applyChanges(m,!1);a.resolve(y.snapshot)}catch(h){const d=Zo(h,`Failed to execute query '${s} against cache`);a.reject(d)}}),function(i,s,a){return r.apply(this,arguments)})(yield Wl(n),e,t);var r})),t.promise}(t,n._query).then(i=>new $r(e,r,n,i))}(this._delegate):"server"===(null==e?void 0:e.source)?function v0(n){n=ye(n,pt);const e=ye(n.firestore,Be),t=tt(e),r=new jr(e);return lg(t,n._query,{source:"server"}).then(i=>new $r(e,r,n,i))}(this._delegate):function _0(n){n=ye(n,pt);const e=ye(n.firestore,Be),t=tt(e),r=new jr(e);return Rg(n._query),lg(t,n._query).then(i=>new $r(e,r,n,i))}(this._delegate),t.then(r=>new rp(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=Wg(e),r=Qg(e,i=>new rp(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Bg(this._delegate,t,r)}withConverter(e){return new Ct(this.firestore,this._delegate.withConverter(e?ls.getInstance(this.firestore,e):null))}}class z0{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ic(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class rp{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ct(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ic(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new z0(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ic(this._firestore,r))})}isEqual(e){return Ug(this._delegate,e._delegate)}}class Yo extends Ct{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Yt(this.firestore,e):null}doc(e){try{return new Yt(this.firestore,void 0===e?Yl(this._delegate):Yl(this._delegate,e))}catch(t){throw kt(t,"doc()","CollectionReference.doc()")}}add(e){return function w0(n,e){const t=ye(n.firestore,Be),r=Yl(n),i=ah(n.converter,e);return Qo(t,[eh(as(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Pe.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Yt(this.firestore,t))}isEqual(e){return Ig(this._delegate,e._delegate)}withConverter(e){return new Yo(this.firestore,this._delegate.withConverter(e?ls.getInstance(this.firestore,e):null))}}function hs(n){return ye(n,qe)}class ip{constructor(...e){this._delegate=new or(...e)}static documentId(){return new ip(Me.keyField().canonicalString())}isEqual(e){return(e=(0,pe.m9)(e))instanceof or&&this._delegate._internalPath.isEqual(e._internalPath)}}class ds{constructor(e){this._delegate=e}static serverTimestamp(){const e=function M0(){return new Hf("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new ds(e)}static delete(){const e=function O0(){return new Qu("deleteField")}();return e._methodName="FieldValue.delete",new ds(e)}static arrayUnion(...e){const t=function L0(...n){return new Yv("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new ds(t)}static arrayRemove(...e){const t=function F0(...n){return new Xv("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new ds(t)}static increment(e){const t=function U0(n){return new Jv("increment",n)}(e);return t._methodName="FieldValue.increment",new ds(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const $0={Firestore:jg,GeoPoint:Xl,Timestamp:Oe,Blob:nc,Transaction:Hg,WriteBatch:Kg,DocumentReference:Yt,DocumentSnapshot:rc,Query:Ct,QueryDocumentSnapshot:ic,QuerySnapshot:rp,CollectionReference:Yo,FieldPath:ip,FieldValue:ds,setLogLevel:function Z0(n){!function Ha(n){be.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function H0(n){(function j0(n,e){n.INTERNAL.registerComponent(new lt.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},$0)))})(n,(e,t)=>new jg(e,t,new G0)),n.registerVersion("@firebase/firestore-compat","0.3.12")}(Ae.Z);var Yg=ne(8645),K0=ne(3019),ch=ne(3093),Kr=ne(4664),W0=ne(4552);class Q0 extends Yg.x{constructor(e=1/0,t=1/0,r=W0.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:a}=this;t||(r.push(e),!i&&r.push(s.now()+a)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let a=0;a<s.length&&!e.closed;a+=r?1:2)e.next(s[a]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const a=t.now();let h=0;for(let d=1;d<r.length&&r[d]<=a;d+=2)h=d;h&&r.splice(0,h+1)}}}var Y0=ne(3020);function Xg(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=null!=n?n:1/0,(0,Y0.B)({connector:()=>new Q0(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}var X0=ne(1374),J0=ne(4674);function Jg(n,e){return(0,J0.m)(e)?(0,Kr.w)(()=>n,e):(0,Kr.w)(()=>n)}var sp=ne(5137);ne(4097);var ap=ne(4303);const up=new Map,t_={activated:!1,tokenObservers:[]},iI={initialized:!1,enabled:!1};function He(n){return up.get(n)||Object.assign({},t_)}function hh(){return iI}const cp="https://content-firebaseappcheck.googleapis.com/v1",uI="exchangeDebugToken",n_={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class lI{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,E.Z)(function*(){t.stop();try{t.pending=new pe.BH,yield function hI(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new pe.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const mt=new pe.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function lp(n){if(!He(n).activated)throw mt.create("use-before-activation",{appName:n.name})}function ph(n,e){return dp.apply(this,arguments)}function dp(){return dp=(0,E.Z)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const w=yield i.getHeartbeatsHeader();w&&(r["X-Firebase-Client"]=w)}const s={method:"POST",body:JSON.stringify(e),headers:r};let a,h;try{a=yield fetch(n,s)}catch(w){throw mt.create("fetch-network-error",{originalErrorMessage:null==w?void 0:w.message})}if(200!==a.status)throw mt.create("fetch-status-error",{httpStatus:a.status});try{h=yield a.json()}catch(w){throw mt.create("fetch-parse-error",{originalErrorMessage:null==w?void 0:w.message})}const d=h.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw mt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(d[1]),y=Date.now();return{token:h.token,expireTimeMillis:y+m,issuedAtTimeMillis:y}}),dp.apply(this,arguments)}function r_(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${cp}/projects/${t}/apps/${r}:${uI}?key=${i}`,body:{debug_token:e}}}const mI="firebase-app-check-database",gI=1,sc="firebase-app-check-store";let mh=null;function fp(){return fp=(0,E.Z)(function*(n,e){const r=(yield function s_(){return mh||(mh=new Promise((n,e)=>{try{const t=indexedDB.open(mI,gI);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(mt.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(sc,{keyPath:"compositeKey"})}}catch(t){e(mt.create("storage-open",{originalErrorMessage:null==t?void 0:t.message}))}}),mh)}()).transaction(sc,"readwrite"),s=r.objectStore(sc).put({compositeKey:n,value:e});return new Promise((a,h)=>{s.onsuccess=d=>{a()},r.onerror=d=>{var m;h(mt.create("storage-set",{originalErrorMessage:null===(m=d.target.error)||void 0===m?void 0:m.message}))}})}),fp.apply(this,arguments)}const oc=new je.Yd("@firebase/app-check");function gp(n,e){return(0,pe.hl)()?function yI(n,e){return function o_(n,e){return fp.apply(this,arguments)}(function u_(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{oc.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function yp(){return hh().enabled}function vp(){return Ip.apply(this,arguments)}function Ip(){return Ip=(0,E.Z)(function*(){const n=hh();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),Ip.apply(this,arguments)}const AI={error:"UNKNOWN_ERROR"};function SI(n){return pe.US.encodeString(JSON.stringify(n),!1)}function gh(n){return wp.apply(this,arguments)}function wp(){return wp=(0,E.Z)(function*(n,e=!1){const t=n.app;lp(t);const r=He(t);let s,i=r.token;if(i&&!Xo(i)&&(r.token=void 0,i=void 0),!i){const d=yield r.cachedTokenPromise;d&&(Xo(d)?i=d:yield gp(t,void 0))}if(!e&&i&&Xo(i))return{token:i.token};let h,a=!1;if(yp()){r.exchangeTokenPromise||(r.exchangeTokenPromise=ph(r_(t,yield vp()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),a=!0);const d=yield r.exchangeTokenPromise;return yield gp(t,d),r.token=d,{token:d.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),a=!0),i=yield He(t).exchangeTokenPromise}catch(d){"appCheck/throttled"===d.code?oc.warn(d.message):oc.error(d),s=d}return i?s?h=Xo(i)?{token:i.token,internalError:s}:d_(s):(h={token:i.token},r.token=i,yield gp(t,i)):h=d_(s),a&&function h_(n,e){const t=He(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}(t,h),h}),wp.apply(this,arguments)}function Tp(){return Tp=(0,E.Z)(function*(n){const e=n.app;lp(e);const{provider:t}=He(e);if(yp()){const r=yield vp(),{token:i}=yield ph(r_(e,r),n.heartbeatServiceProvider);return{token:i}}{const{token:r}=yield t.getToken();return{token:r}}}),Tp.apply(this,arguments)}function Ap(n,e){const t=He(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function l_(n){const{app:e}=n,t=He(e);let r=t.tokenRefresher;r||(r=function bI(n){const{app:e}=n;return new lI((0,E.Z)(function*(){let r;if(r=He(e).token?yield gh(n,!0):yield gh(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=He(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},n_.RETRIAL_MIN_WAIT,n_.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Xo(n){return n.expireTimeMillis-Date.now()>0}function d_(n){return{token:SI(AI),error:n}}class xI{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=He(this.app);for(const t of e)Ap(this.app,t.next);return Promise.resolve()}}const I_="app-check-internal";!function BI(){(0,ap.Xd)(new lt.wA("app-check",n=>function kI(n,e){return new xI(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(I_).initialize()})),(0,ap.Xd)(new lt.wA(I_,n=>function CI(n){return{getToken:e=>gh(n,e),getLimitedUseToken:()=>function c_(n){return Tp.apply(this,arguments)}(n),addTokenListener:e=>function Ep(n,e,t,r){const{app:i}=n,s=He(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:r,type:e}],s.token&&Xo(s.token)){const h=s.token;Promise.resolve().then(()=>{t({token:h.token}),l_(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>l_(n))}(n,"INTERNAL",e),removeTokenListener:e=>Ap(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ap.KN)("@firebase/app-check","0.8.0")}();class kp{constructor(){return(0,b.vb)("app-check")}}typeof window<"u"&&window,ne(120);const T_=new v.OlP("angularfire2.auth.use-emulator"),E_=new v.OlP("angularfire2.auth.settings"),A_=new v.OlP("angularfire2.auth.tenant-id"),S_=new v.OlP("angularfire2.auth.langugage-code"),b_=new v.OlP("angularfire2.auth.use-device-language"),x_=new v.OlP("angularfire.auth.persistence"),k_=(n,e,t,r,i,s,a,h)=>(0,ct.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const d=e.runOutsideAngular(()=>n.auth());if(t&&d.useEmulator(...t),r&&(d.tenantId=r),d.languageCode=i,s&&d.useDeviceLanguage(),a)for(const[m,y]of Object.entries(a))d.settings[m]=y;return h&&d.setPersistence(h),d},[t,r,i,s,a,h]);let C_=(()=>{class n{constructor(t,r,i,s,a,h,d,m,y,w,k,D){const q=new Yg.x,G=(0,T.of)(void 0).pipe((0,ch.Q)(a.outsideAngular),(0,Kr.w)(()=>s.runOutsideAngular(()=>Promise.resolve().then(ne.bind(ne,8977)))),(0,ce.U)(()=>(0,ct.on)(t,s,r)),(0,ce.U)($=>k_($,s,h,m,y,w,d,k)),Xg({bufferSize:1,refCount:!1}));if((0,S.PM)(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,T.of)(null);else{G.pipe((0,X0.P)()).subscribe();const oe=G.pipe((0,Kr.w)(fe=>fe.getRedirectResult().then(ve=>ve,()=>null)),b.iC,Xg({bufferSize:1,refCount:!1})),me=G.pipe((0,Kr.w)(fe=>new te.y(ve=>({unsubscribe:s.runOutsideAngular(()=>fe.onAuthStateChanged(Ie=>ve.next(Ie),Ie=>ve.error(Ie),()=>ve.complete()))})))),ue=G.pipe((0,Kr.w)(fe=>new te.y(ve=>({unsubscribe:s.runOutsideAngular(()=>fe.onIdTokenChanged(Ie=>ve.next(Ie),Ie=>ve.error(Ie),()=>ve.complete()))}))));this.authState=oe.pipe(Jg(me),(0,sp.R)(a.outsideAngular),(0,ch.Q)(a.insideAngular)),this.user=oe.pipe(Jg(ue),(0,sp.R)(a.outsideAngular),(0,ch.Q)(a.insideAngular)),this.idToken=this.user.pipe((0,Kr.w)(fe=>fe?(0,_.D)(fe.getIdToken()):(0,T.of)(null))),this.idTokenResult=this.user.pipe((0,Kr.w)(fe=>fe?(0,_.D)(fe.getIdTokenResult()):(0,T.of)(null))),this.credential=(0,K0.T)(oe,q,this.authState.pipe((0,Ce.h)(fe=>!fe))).pipe((0,ce.U)(fe=>null!=fe&&fe.user?fe:null),(0,sp.R)(a.outsideAngular),(0,ch.Q)(a.insideAngular))}return(0,ct.pX)(this,G,s,{spy:{apply:($,oe,me)=>{($.startsWith("signIn")||$.startsWith("createUser"))&&me.then(ue=>q.next(ue))}}})}}return n.\u0275fac=function(t){return new(t||n)(v.LFG(ct.Dh),v.LFG(ct.xv,8),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(b.HU),v.LFG(T_,8),v.LFG(E_,8),v.LFG(A_,8),v.LFG(S_,8),v.LFG(b_,8),v.LFG(x_,8),v.LFG(kp,8))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();function N_(n,e){return function HI(n,e=ee.z){return new te.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=r&&r()}})}(n,e)}function Np(n,e){return N_(n,e).pipe((0,ce.U)(t=>({payload:t,type:"query"})))}function yh(n,e){return Np(n,e).pipe((0,O.O)(void 0),Q(),(0,ce.U)(([t,r])=>{const i=r.payload.docChanges(),s=i.map(a=>({type:a.type,payload:a}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,h)=>{const d=i.find(y=>y.doc.ref.isEqual(a.ref)),m=null==t?void 0:t.payload.docs.find(y=>y.ref.isEqual(a.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(a.metadata)||!d&&m&&JSON.stringify(m.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:a}})}),s}))}function R_(n,e,t){return yh(n,t).pipe((0,ke.R)((r,i)=>function WI(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function QI(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Rp(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Rp(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Rp(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),(0,Ee.x)(),(0,ce.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function Rp(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function D_(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class P_{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=yh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ce.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe((0,O.O)(void 0),Q(),(0,Ce.h)(([r,i])=>i.length>0||!r),(0,ce.U)(([r,i])=>i),b.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ke.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=D_(e);return R_(this.query,t,this.afs.schedulers.outsideAngular).pipe(b.iC)}valueChanges(e={}){return Np(this.query,this.afs.schedulers.outsideAngular).pipe((0,ce.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),b.iC)}get(e){return(0,_.D)(this.query.get(e)).pipe(b.iC)}add(e){return this.ref.add(e)}doc(e){return new O_(this.ref.doc(e),this.afs)}}class O_{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=M_(r,t);return new P_(i,s,this.afs)}snapshotChanges(){return function KI(n,e){return N_(n,e).pipe((0,O.O)(void 0),Q(),(0,ce.U)(([t,r])=>r.exists?null!=t&&t.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(b.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ce.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,_.D)(this.ref.get(e)).pipe(b.iC)}}class YI{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?yh(this.query,this.afs.schedulers.outsideAngular).pipe((0,ce.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),(0,Ce.h)(t=>t.length>0),b.iC):yh(this.query,this.afs.schedulers.outsideAngular).pipe(b.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,ke.R)((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=D_(e);return R_(this.query,t,this.afs.schedulers.outsideAngular).pipe(b.iC)}valueChanges(e={}){return Np(this.query,this.afs.schedulers.outsideAngular).pipe((0,ce.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),b.iC)}get(e){return(0,_.D)(this.query.get(e)).pipe(b.iC)}}const XI=new v.OlP("angularfire2.enableFirestorePersistence"),JI=new v.OlP("angularfire2.firestore.persistenceSettings"),ew=new v.OlP("angularfire2.firestore.settings"),tw=new v.OlP("angularfire2.firestore.use-emulator");function M_(n,e=(t=>t)){return{query:e(n),ref:n}}let nw=(()=>{class n{constructor(t,r,i,s,a,h,d,m,y,w,k,D,q,G,$,oe,me){this.schedulers=d;const ue=(0,ct.on)(t,h,r),fe=y;w&&k_(ue,h,k,q,G,$,D,oe),[this.firestore,this.persistenceEnabled$]=(0,ct.cc)(`${ue.name}.firestore`,"AngularFirestore",ue.name,()=>{const ve=h.runOutsideAngular(()=>ue.firestore());if(s&&ve.settings(s),fe&&ve.useEmulator(...fe),i&&!(0,S.PM)(a)){const Ie=()=>{try{return(0,_.D)(ve.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(At){return typeof console<"u"&&console.warn(At),(0,T.of)(!1)}};return[ve,h.runOutsideAngular(Ie)]}return[ve,(0,T.of)(!1)]},[s,fe,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:a}=M_(i,r),h=this.schedulers.ngZone.run(()=>s);return new P_(h,a,this)}collectionGroup(t,r){const i=r||(a=>a),s=this.firestore.collectionGroup(t);return new YI(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new O_(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(v.LFG(ct.Dh),v.LFG(ct.xv,8),v.LFG(XI,8),v.LFG(ew,8),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(b.HU),v.LFG(JI,8),v.LFG(tw,8),v.LFG(C_,8),v.LFG(T_,8),v.LFG(E_,8),v.LFG(A_,8),v.LFG(S_,8),v.LFG(b_,8),v.LFG(x_,8),v.LFG(kp,8))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();var L_=ne(4414),rw=ne(8755);const iw=["range"];function sw(n,e){if(1&n){const t=v.EpF();v.TgZ(0,"ion-button",6),v.NdJ("click",function(){v.CHM(t);const i=v.oxw();return v.KtG(i.togglePlayer(!1))}),v._UZ(1,"ion-icon",7),v.qZA()}}function ow(n,e){if(1&n){const t=v.EpF();v.TgZ(0,"ion-button",6),v.NdJ("click",function(){v.CHM(t);const i=v.oxw();return v.KtG(i.togglePlayer(!0))}),v._UZ(1,"ion-icon",8),v.qZA()}}let aw=(()=>{var n;class e{constructor(){this.player=new rw.Howl({src:["assets/song/for you.mp3"],onplay:()=>{this.isPlaying=!0,this.updateProgress()},autoplay:!0,format:"mp3",mute:!1}),this.isPlaying=!1,this.progress=0,this.reproducirAgain=!1}ngOnInit(){this.player.play()}start(){this.player&&this.player.stop(),this.player.play()}togglePlayer(r){this.isPlaying=!r,this.player?r?this.player.pause():this.player.play():this.start()}seek(){var r;console.log("seek");let i=+this.range.value,s=null===(r=this.player)||void 0===r?void 0:r.duration();var a;s&&(null===(a=this.player)||void 0===a||a.seek(s*(i/100)))}updateProgress(){if(this.player){let r=this.player.seek();this.progress=r/this.player.duration()*100||0,this.progress>90&&(this.reproducirAgain=!0),0==this.progress&&0==r&&1==this.reproducirAgain&&this.start(),setTimeout(()=>{this.updateProgress()},1e3)}}}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275cmp=v.Xpm({type:n,selectors:[["app-reproductor"]],viewQuery:function(r,i){if(1&r&&v.Gf(iw,5),2&r){let s;v.iGM(s=v.CRH())&&(i.range=s.first)}},decls:10,vars:3,consts:[["size","1"],["size","2"],["fill","clear","color","dark",3,"click",4,"ngIf"],["size","7"],["max","100","color","dark",3,"ngModel","ngModelChange","touchend","mouseup"],["range",""],["fill","clear","color","dark",3,"click"],["slot","icon-only","name","play"],["slot","icon-only","name","pause"]],template:function(r,i){1&r&&(v.TgZ(0,"ion-grid")(1,"ion-row"),v._UZ(2,"ion-col",0),v.TgZ(3,"ion-col",1),v.YNc(4,sw,2,0,"ion-button",2),v.YNc(5,ow,2,0,"ion-button",2),v.qZA(),v.TgZ(6,"ion-col",3)(7,"ion-range",4,5),v.NdJ("ngModelChange",function(a){return i.progress=a})("touchend",function(){return i.seek()})("mouseup",function(){return i.seek()}),v.qZA()(),v._UZ(9,"ion-col",1),v.qZA()()),2&r&&(v.xp6(4),v.Q6J("ngIf",!i.isPlaying),v.xp6(1),v.Q6J("ngIf",i.isPlaying),v.xp6(2),v.Q6J("ngModel",i.progress))},dependencies:[S.O5,I.JJ,I.On,de.YG,de.wI,de.jY,de.gu,de.I_,de.Nd,de.QI]}),e})(),uw=(()=>{var n;class e{constructor(){this._second=1e3,this._minute=60*this._second,this._hour=60*this._minute,this._day=24*this._hour,this.source=J(0,1e3)}ngOnInit(){this.clock=this.source.subscribe(r=>{this.now=new Date,this.end=new Date("01/20/2024 17:00"),this.showDate()})}showDate(){let r=this.end-this.now;this.day=Math.floor(r/this._day),this.hours=Math.floor(r%this._day/this._hour),this.minutes=Math.floor(r%this._hour/this._minute),this.seconds=Math.floor(r%this._minute/this._second),this.minutes<0&&this.seconds&&(this.day=0,this.hours=0,this.minutes=0,this.seconds=0)}}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275cmp=v.Xpm({type:n,selectors:[["app-contador"]],decls:37,vars:4,consts:[[1,"ion-text-center","texto","move",2,"color","#efb810"],[1,"timer1"],[2,"max-width","20%"],[1,"dias"],[1,"letra"],[2,"max-width","6%"]],template:function(r,i){1&r&&(v.TgZ(0,"ion-label",0),v._uU(1,"Faltan"),v.qZA(),v.TgZ(2,"ion-grid")(3,"ion-row",1)(4,"ion-col",2)(5,"ion-label",3),v._uU(6),v.qZA(),v._UZ(7,"br"),v.TgZ(8,"ion-label",4),v._uU(9,"D\xedas"),v.qZA()(),v.TgZ(10,"ion-col",5)(11,"ion-label",3),v._uU(12,":"),v.qZA()(),v.TgZ(13,"ion-col",2)(14,"ion-label",3),v._uU(15),v.qZA(),v._UZ(16,"br"),v.TgZ(17,"ion-label",4),v._uU(18,"Hrs"),v.qZA()(),v.TgZ(19,"ion-col",5)(20,"ion-label",3),v._uU(21,":"),v.qZA()(),v.TgZ(22,"ion-col",2)(23,"ion-label",3),v._uU(24),v.qZA(),v._UZ(25,"br"),v.TgZ(26,"ion-label",4),v._uU(27,"Min"),v.qZA()(),v.TgZ(28,"ion-col",5)(29,"ion-label",3),v._uU(30,":"),v.qZA()(),v.TgZ(31,"ion-col")(32,"ion-label",3),v._uU(33),v.qZA(),v._UZ(34,"br"),v.TgZ(35,"ion-label",4),v._uU(36,"S"),v.qZA()()()()),2&r&&(v.xp6(6),v.Oqu(i.day),v.xp6(9),v.Oqu(i.hours),v.xp6(9),v.Oqu(i.minutes),v.xp6(9),v.Oqu(i.seconds))},dependencies:[de.wI,de.jY,de.Q$,de.Nd],styles:[".timer1[_ngcontent-%COMP%]{max-width:100%;padding:10px;background:linear-gradient(#03C0FA,#000180);color:#fff;border-radius:10px;border:2px solid linear-gradient(#03C0FA,#000180);margin:10px;text-align:center;font-family:Nunito}.letra[_ngcontent-%COMP%]{font-size:15px}.dias[_ngcontent-%COMP%]{font-size:1.8em}.texto[_ngcontent-%COMP%]{text-align:center;font-family:GreatVibes;display:flex;justify-content:center;width:100%;font-size:40px}"]}),e})();function cw(n,e){if(1&n){const t=v.EpF();v.TgZ(0,"ion-col")(1,"ion-radio-group",38),v.NdJ("ngModelChange",function(i){v.CHM(t);const s=v.oxw().$implicit;return v.KtG(s.Status=i)})("ionChange",function(i){v.CHM(t);const s=v.oxw().$implicit,a=v.oxw();return v.KtG(a.handleChange(i,s.Id))}),v.TgZ(2,"ion-radio",39),v._uU(3,"S\xed"),v.qZA(),v._uU(4," \xa0\xa0 "),v.TgZ(5,"ion-radio",40),v._uU(6,"No"),v.qZA()()()}if(2&n){const t=v.oxw().$implicit;v.xp6(1),v.Q6J("ngModel",t.Status)}}function lw(n,e){if(1&n){const t=v.EpF();v.TgZ(0,"ion-col")(1,"ion-radio-group",41),v.NdJ("ngModelChange",function(i){v.CHM(t);const s=v.oxw().$implicit;return v.KtG(s.Status=i)}),v.TgZ(2,"ion-radio",42),v._uU(3,"S\xed"),v.qZA(),v._uU(4," \xa0\xa0 "),v.TgZ(5,"ion-radio",43),v._uU(6,"No"),v.qZA()()()}if(2&n){const t=v.oxw().$implicit;v.xp6(1),v.Q6J("ngModel",t.Status)}}function hw(n,e){if(1&n&&(v.TgZ(0,"ion-row")(1,"ion-col"),v._uU(2),v.qZA(),v.YNc(3,cw,7,1,"ion-col",37),v.YNc(4,lw,7,1,"ion-col",37),v.qZA()),2&n){const t=e.$implicit,r=v.oxw();v.xp6(2),v.hij(" ",t.Nombre," "),v.xp6(1),v.Q6J("ngIf",!r.disabledButtons),v.xp6(1),v.Q6J("ngIf",r.disabledButtons)}}const dw=[{path:"",component:(()=>{var n;class e{constructor(r,i,s,a,h){this.meta=r,this.route=i,this.db=s,this.alertController=a,this.toastController=h,this.alertButtons=[{text:"Ver invitaci\xf3n",cssClass:"alertBtn"}],this.list=[],this.source=J(0,1e3),this.disabledButtons=!1,this._second=1e3,this._minute=60*this._second,this._hour=60*this._minute,this._day=24*this._hour,this.isAlertOpen=!1}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.id&&this.db.collection(this.id).valueChanges().subscribe(r=>{this.list=r}),this.clock=this.source.subscribe(r=>{this.now=new Date,this.end=new Date("01/10/2024"),Math.floor((this.end-this.now)/this._day)<0&&(this.disabledButtons=!0)}),this.showAlert()}openMapaLocal(){window.open("https://maps.app.goo.gl/K9HaeGag7v4RaWR37")}openMapaMisa(){window.open("https://maps.app.goo.gl/2CpKzeotPr8VxByu7")}handleChange(r,i){var s=this,a="",h="light",d=JSON.stringify(r.target.value).replace(/^"(.*)"$/,"$1");"Asistir\xe9"==d?(a="Asistencia Confirmada",h="success"):"No Asistir\xe9"==d&&(h="danger",a="Asistencia No Confirmada"),this.db.collection(this.id).doc(i).ref.update({Status:d}).then(function(){var m=(0,E.Z)(function*(y){(yield s.toastController.create({message:a,duration:2e3,position:"top",animated:!0,color:h})).present().then()});return function(y){return m.apply(this,arguments)}}())}showAlert(){var r=this;return(0,E.Z)(function*(){yield(yield r.alertController.create({header:"Has recibido una invitaci\xf3n a nuestra boda",subHeader:"J & M",message:"20-01-2024",cssClass:"default-alert",buttons:[{text:"Ver invitaci\xf3n"}]})).present()})()}trackItems(r,i){return i.id}}return(n=e).\u0275fac=function(r){return new(r||n)(v.Y36(f.h_),v.Y36(P.gz),v.Y36(nw),v.Y36(L_.Br),v.Y36(L_.yF))},n.\u0275cmp=v.Xpm({type:n,selectors:[["app-home"]],decls:125,vars:2,consts:[["color","light"],[1,"principal"],[1,"nombres"],[1,"separador"],[1,"noscasamos",2,"color","#C0C0C0","font-weight","bold"],[2,"text-align","center"],["src","assets/imagenes/anillos1.png","height","75"],[1,"ion-text-center","ion-padding","move"],[1,"move"],[2,"border-right","solid 3px #efb810"],[1,"papas"],[1,"ion-text-center","move"],[1,"square",2,"text-align","center"],["src","assets/imagenes/flores4.png","height","100"],[1,"move","secundarios"],[1,"frase",2,"color","white"],[1,"ion-padding","move"],[1,"ion-text-center","fecha"],[1,"datos"],[1,"datosLabel"],[1,"dia"],["src","assets/imagenes/flores5.png","height","100"],[1,"frase",2,"color","white","padding-bottom","0px"],[2,"padding-bottom","0px"],[2,"border-right","dashed 1px white"],[2,"padding-top","0px","padding-bottom","0px"],["src","assets/imagenes/church.png","height","50"],["src","assets/imagenes/brindis.png","height","50"],[2,"padding-top","0px"],[1,"linksBtn",3,"click"],["slot","end","name","map"],[1,"titulo","move"],["src","assets/imagenes/test123.png","height","100"],[1,"ion-text-center","ion-padding"],[1,"ion-padding"],[2,"font-weight","bold"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[3,"ngModel","ngModelChange","ionChange"],["value","Asistir\xe9","labelPlacement","start"],["value","No Asistir\xe9","labelPlacement","start"],[3,"ngModel","ngModelChange"],["value","Asistir\xe9","labelPlacement","start","disabled",""],["value","No Asistir\xe9","labelPlacement","start","disabled",""]],template:function(r,i){1&r&&(v.TgZ(0,"ion-content",0)(1,"ion-card",1)(2,"ion-card-header")(3,"ion-card-subtitle"),v._uU(4,"Dios decidi\xf3 el tiempo perfecto para unir nuestros caminos."),v.qZA(),v.TgZ(5,"ion-card-title",2),v._uU(6,"Josu\xe9"),v.qZA(),v.TgZ(7,"ion-card-title",3),v._uU(8,"&"),v.qZA(),v.TgZ(9,"ion-card-title",2),v._uU(10,"Mar\xeda de Jes\xfas"),v.qZA()(),v.TgZ(11,"ion-card-content",4),v._uU(12," \xa1Nos Casamos! "),v.qZA()(),v._UZ(13,"app-reproductor"),v.TgZ(14,"div",5),v._UZ(15,"img",6),v.qZA(),v.TgZ(16,"ion-label",7),v._uU(17,"Con nuestro amor, la presencia de Dios entre nosotros y la bendici\xf3n de nuestros padres."),v.qZA(),v.TgZ(18,"ion-grid",8)(19,"ion-row")(20,"ion-col",9)(21,"ion-label",10),v._uU(22,"Novia:"),v.qZA(),v._UZ(23,"br"),v._uU(24," Guillermina Delgado Castellanos "),v._UZ(25,"br")(26,"br"),v._uU(27," Juan Manuel Arechiga Rodr\xedguez "),v.qZA(),v.TgZ(28,"ion-col")(29,"ion-label",10),v._uU(30,"Novio:"),v.qZA(),v._UZ(31,"br"),v._uU(32," Mar\xeda del Carmen Nu\xf1o Fregoso "),v._UZ(33,"br")(34,"br"),v._uU(35," Rafael Garc\xeda Nande "),v.qZA()()(),v._UZ(36,"br"),v.TgZ(37,"ion-label",11),v._uU(38,"Y acompa\xf1ados por nuestros padrinos:"),v.qZA(),v.TgZ(39,"ion-label",11),v._uU(40,"Sara Garc\xeda Nande"),v.qZA(),v.TgZ(41,"ion-label",11),v._uU(42,"Rafael Villegas Garc\xeda"),v.qZA(),v._UZ(43,"br")(44,"br"),v.TgZ(45,"div",12),v._UZ(46,"img",13),v.qZA(),v._UZ(47,"br"),v.TgZ(48,"ion-card",14)(49,"ion-card-content",15),v._uU(50," Hay momentos en la vida que son especiales por si solos, pero compartirlos con las personas que amamos los hace inolvidables. "),v._UZ(51,"br"),v._uU(52," Tenemos el honor de invitarlos a nuestro enlace matrimonial. "),v.qZA()(),v._UZ(53,"br"),v.TgZ(54,"ion-grid",16)(55,"ion-label",17),v._uU(56,"S\xe1bado"),v.qZA(),v.TgZ(57,"ion-row")(58,"ion-col",18)(59,"ion-label",19),v._uU(60,"Enero"),v.qZA()(),v.TgZ(61,"ion-col",20),v._uU(62," 20 "),v.qZA(),v.TgZ(63,"ion-col",18)(64,"ion-label",19),v._uU(65,"2024"),v.qZA()()()(),v._UZ(66,"app-contador"),v.TgZ(67,"div",5),v._UZ(68,"img",21),v.qZA(),v._UZ(69,"br"),v.TgZ(70,"ion-card",14)(71,"ion-card-content",22)(72,"ion-grid",23)(73,"ion-row")(74,"ion-col",24),v._uU(75," Acomp\xe1\xf1anos en nuestra ceremonia religiosa: "),v.qZA(),v.TgZ(76,"ion-col"),v._uU(77," Para luego celebrar con una recepci\xf3n: "),v.qZA()()(),v.TgZ(78,"ion-grid",25)(79,"ion-row")(80,"ion-col",24),v._UZ(81,"img",26),v.qZA(),v.TgZ(82,"ion-col"),v._UZ(83,"img",27),v.qZA()()(),v.TgZ(84,"ion-grid",25)(85,"ion-row")(86,"ion-col",24),v._uU(87," Hora: 5:00 pm "),v._UZ(88,"br"),v._uU(89," Parroquia de San Miguel Arc\xe1ngel "),v.qZA(),v.TgZ(90,"ion-col"),v._uU(91," Hora: 7:00 pm "),v._UZ(92,"br"),v._uU(93," Terraza Rondinela"),v._UZ(94,"br"),v._uU(95," Calle San Diego #597, Cocula, Jal. "),v.qZA()()()(),v.TgZ(96,"ion-grid",28)(97,"ion-row")(98,"ion-col",24)(99,"ion-button",29),v.NdJ("click",function(){return i.openMapaMisa()}),v._uU(100," Ver mapa "),v._UZ(101,"ion-icon",30),v.qZA()(),v.TgZ(102,"ion-col")(103,"ion-button",29),v.NdJ("click",function(){return i.openMapaLocal()}),v._uU(104," Ver mapa "),v._UZ(105,"ion-icon",30),v.qZA()()()()(),v._UZ(106,"br"),v.TgZ(107,"ion-label",7),v._uU(108,"Nos encantar\xeda contar con su presencia en nuestra boda."),v.qZA(),v._UZ(109,"br"),v.TgZ(110,"ion-label",31)(111,"b"),v._uU(112,"Te esperamos."),v.qZA()(),v._UZ(113,"br"),v.TgZ(114,"div",5),v._UZ(115,"img",32),v.qZA(),v._UZ(116,"br"),v.TgZ(117,"ion-label",33),v._uU(118," Por favor, confirme su asistencia antes del 10 de Enero para que podamos planificar con anticipaci\xf3n y hacer que su experiencia sea lo m\xe1s c\xf3moda y placentera posible. "),v.qZA(),v.TgZ(119,"ion-grid",34)(120,"ion-row"),v._UZ(121,"ion-col",35),v.TgZ(122,"ion-col",35),v._uU(123," \xbfAsistir\xe1s? "),v.qZA()(),v.YNc(124,hw,5,3,"ion-row",36),v.qZA()()),2&r&&(v.xp6(124),v.Q6J("ngForOf",i.list)("ngForTrackBy",i.trackItems))},dependencies:[S.sg,S.O5,I.JJ,I.On,de.YG,de.PM,de.FN,de.Zi,de.tO,de.Dq,de.wI,de.W2,de.jY,de.gu,de.Q$,de.B7,de.se,de.Nd,de.U5,de.QI,aw,uw],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.principal[_ngcontent-%COMP%], .secundarios[_ngcontent-%COMP%]{background:linear-gradient(#03C0FA,#000180);margin-left:0%;margin-right:0%;border-radius:0%}.confirmacionBtn[_ngcontent-%COMP%]{--background: #00018A;color:#fff}.linksBtn[_ngcontent-%COMP%]{--background: #C0C0C0;color:#000180}.nombres[_ngcontent-%COMP%]{--color: white;text-align:center;font-family:GreatVibes;font-size:50px}.separador[_ngcontent-%COMP%]{text-align:center;font-family:GreatVibes;font-size:40px;--color: white}ion-card-subtitle[_ngcontent-%COMP%]{--color: #002247;text-align:center;font-family:Kanit;font-size:17px}.noscasamos[_ngcontent-%COMP%]{--color: white;text-align:center;font-family:Nunito;font-size:20px}ion-label[_ngcontent-%COMP%]{text-align:center;font-family:Nunito;display:flex;justify-content:center;width:100%}ion-grid[_ngcontent-%COMP%]{text-align:center;font-family:Nunito}.frase[_ngcontent-%COMP%]{--color: white;text-align:center;font-family:Nunito;font-size:17px}ion-title[_ngcontent-%COMP%]{text-align:center;font-family:Nunito;display:flex;justify-content:center;width:100%}.titulo[_ngcontent-%COMP%]{text-align:center;font-family:Nunito;display:flex;justify-content:center;width:100%;font-size:20px}.fecha[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.datos[_ngcontent-%COMP%]{text-align:center;font-family:Nunito;display:flex;justify-content:center;align-items:center;width:100%;font-size:20px;font-weight:700}.datosLabel[_ngcontent-%COMP%]{border-top:2px solid #efb810;border-bottom:2px solid #efb810;padding-top:5%;padding-bottom:5%}.dia[_ngcontent-%COMP%]{text-align:center;font-family:Nunito;display:flex;justify-content:center;width:100%;font-size:50px;font-weight:700;color:#efb810;padding:0}.papas[_ngcontent-%COMP%]{color:#efb810;font-weight:700;font-size:18px}ion-radio[_ngcontent-%COMP%]{--border-radius: 4px;--inner-border-radius: 4px;--color: #ddd;--color-checked: #efb810}ion-radio.ios[_ngcontent-%COMP%]::part(container){width:20px;height:20px;border:2px solid #ddd;border-radius:4px}.radio-checked.ios[_ngcontent-%COMP%]::part(container){border-color:#efb810}"]}),e})()}];let fw=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=v.oAB({type:n}),n.\u0275inj=v.cJS({imports:[P.Bz.forChild(dw),P.Bz]}),e})(),pw=(()=>{var n;class e{}return(n=e).\u0275fac=function(r){return new(r||n)},n.\u0275mod=v.oAB({type:n}),n.\u0275inj=v.cJS({imports:[S.ez,I.u5,de.Pc,fw]}),e})()},8755:(vh,ur)=>{var S;!function(){"use strict";var de=function(){this.init()};de.prototype={init:function(){var f=this||I;return f._counter=1e3,f._html5AudioPool=[],f.html5PoolSize=10,f._codecs={},f._howls=[],f._muted=!1,f._volume=1,f._canPlayEvent="canplaythrough",f._navigator=typeof window<"u"&&window.navigator?window.navigator:null,f.masterGain=null,f.noAudio=!1,f.usingWebAudio=!0,f.autoSuspend=!0,f.ctx=null,f.autoUnlock=!0,f._setup(),f},volume:function(f){var _=this||I;if(f=parseFloat(f),_.ctx||v(),typeof f<"u"&&f>=0&&f<=1){if(_._volume=f,_._muted)return _;_.usingWebAudio&&_.masterGain.gain.setValueAtTime(f,I.ctx.currentTime);for(var T=0;T<_._howls.length;T++)if(!_._howls[T]._webAudio)for(var b=_._howls[T]._getSoundIds(),O=0;O<b.length;O++){var L=_._howls[T]._soundById(b[O]);L&&L._node&&(L._node.volume=L._volume*f)}return _}return _._volume},mute:function(f){var _=this||I;_.ctx||v(),_._muted=f,_.usingWebAudio&&_.masterGain.gain.setValueAtTime(f?0:_._volume,I.ctx.currentTime);for(var T=0;T<_._howls.length;T++)if(!_._howls[T]._webAudio)for(var b=_._howls[T]._getSoundIds(),O=0;O<b.length;O++){var L=_._howls[T]._soundById(b[O]);L&&L._node&&(L._node.muted=!!f||L._muted)}return _},stop:function(){for(var f=this||I,_=0;_<f._howls.length;_++)f._howls[_].stop();return f},unload:function(){for(var f=this||I,_=f._howls.length-1;_>=0;_--)f._howls[_].unload();return f.usingWebAudio&&f.ctx&&typeof f.ctx.close<"u"&&(f.ctx.close(),f.ctx=null,v()),f},codecs:function(f){return(this||I)._codecs[f.replace(/^x-/,"")]},_setup:function(){var f=this||I;if(f.state=f.ctx&&f.ctx.state||"suspended",f._autoSuspend(),!f.usingWebAudio)if(typeof Audio<"u")try{typeof(new Audio).oncanplaythrough>"u"&&(f._canPlayEvent="canplay")}catch{f.noAudio=!0}else f.noAudio=!0;try{(new Audio).muted&&(f.noAudio=!0)}catch{}return f.noAudio||f._setupCodecs(),f},_setupCodecs:function(){var f=this||I,_=null;try{_=typeof Audio<"u"?new Audio:null}catch{return f}if(!_||"function"!=typeof _.canPlayType)return f;var T=_.canPlayType("audio/mpeg;").replace(/^no$/,""),b=f._navigator?f._navigator.userAgent:"",O=b.match(/OPR\/(\d+)/g),L=O&&parseInt(O[0].split("/")[1],10)<33,R=-1!==b.indexOf("Safari")&&-1===b.indexOf("Chrome"),Q=b.match(/Version\/(.*?) /),ce=R&&Q&&parseInt(Q[1],10)<15;return f._codecs={mp3:!(L||!T&&!_.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!T,opus:!!_.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(_.canPlayType('audio/wav; codecs="1"')||_.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!_.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!_.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(_.canPlayType("audio/x-m4a;")||_.canPlayType("audio/m4a;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(_.canPlayType("audio/x-m4b;")||_.canPlayType("audio/m4b;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(_.canPlayType("audio/x-mp4;")||_.canPlayType("audio/mp4;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(ce||!_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(ce||!_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!_.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(_.canPlayType("audio/x-flac;")||_.canPlayType("audio/flac;")).replace(/^no$/,"")},f},_unlockAudio:function(){var f=this||I;if(!f._audioUnlocked&&f.ctx){f._audioUnlocked=!1,f.autoUnlock=!1,!f._mobileUnloaded&&44100!==f.ctx.sampleRate&&(f._mobileUnloaded=!0,f.unload()),f._scratchBuffer=f.ctx.createBuffer(1,1,22050);var _=function(T){for(;f._html5AudioPool.length<f.html5PoolSize;)try{var b=new Audio;b._unlocked=!0,f._releaseHtml5Audio(b)}catch{f.noAudio=!0;break}for(var O=0;O<f._howls.length;O++)if(!f._howls[O]._webAudio)for(var L=f._howls[O]._getSoundIds(),R=0;R<L.length;R++){var Q=f._howls[O]._soundById(L[R]);Q&&Q._node&&!Q._node._unlocked&&(Q._node._unlocked=!0,Q._node.load())}f._autoResume();var ce=f.ctx.createBufferSource();ce.buffer=f._scratchBuffer,ce.connect(f.ctx.destination),typeof ce.start>"u"?ce.noteOn(0):ce.start(0),"function"==typeof f.ctx.resume&&f.ctx.resume(),ce.onended=function(){ce.disconnect(0),f._audioUnlocked=!0,document.removeEventListener("touchstart",_,!0),document.removeEventListener("touchend",_,!0),document.removeEventListener("click",_,!0),document.removeEventListener("keydown",_,!0);for(var ke=0;ke<f._howls.length;ke++)f._howls[ke]._emit("unlock")}};return document.addEventListener("touchstart",_,!0),document.addEventListener("touchend",_,!0),document.addEventListener("click",_,!0),document.addEventListener("keydown",_,!0),f}},_obtainHtml5Audio:function(){var f=this||I;if(f._html5AudioPool.length)return f._html5AudioPool.pop();var _=(new Audio).play();return _&&typeof Promise<"u"&&(_ instanceof Promise||"function"==typeof _.then)&&_.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(f){var _=this||I;return f._unlocked&&_._html5AudioPool.push(f),_},_autoSuspend:function(){var f=this;if(f.autoSuspend&&f.ctx&&!(typeof f.ctx.suspend>"u")&&I.usingWebAudio){for(var _=0;_<f._howls.length;_++)if(f._howls[_]._webAudio)for(var T=0;T<f._howls[_]._sounds.length;T++)if(!f._howls[_]._sounds[T]._paused)return f;return f._suspendTimer&&clearTimeout(f._suspendTimer),f._suspendTimer=setTimeout(function(){if(f.autoSuspend){f._suspendTimer=null,f.state="suspending";var b=function(){f.state="suspended",f._resumeAfterSuspend&&(delete f._resumeAfterSuspend,f._autoResume())};f.ctx.suspend().then(b,b)}},3e4),f}},_autoResume:function(){var f=this;if(f.ctx&&!(typeof f.ctx.resume>"u")&&I.usingWebAudio)return"running"===f.state&&"interrupted"!==f.ctx.state&&f._suspendTimer?(clearTimeout(f._suspendTimer),f._suspendTimer=null):"suspended"===f.state||"running"===f.state&&"interrupted"===f.ctx.state?(f.ctx.resume().then(function(){f.state="running";for(var _=0;_<f._howls.length;_++)f._howls[_]._emit("resume")}),f._suspendTimer&&(clearTimeout(f._suspendTimer),f._suspendTimer=null)):"suspending"===f.state&&(f._resumeAfterSuspend=!0),f}};var I=new de,P=function(f){f.src&&0!==f.src.length?this.init(f):console.error("An array of source files must be passed with any new Howl.")};P.prototype={init:function(f){var _=this;return I.ctx||v(),_._autoplay=f.autoplay||!1,_._format="string"!=typeof f.format?f.format:[f.format],_._html5=f.html5||!1,_._muted=f.mute||!1,_._loop=f.loop||!1,_._pool=f.pool||5,_._preload="boolean"!=typeof f.preload&&"metadata"!==f.preload||f.preload,_._rate=f.rate||1,_._sprite=f.sprite||{},_._src="string"!=typeof f.src?f.src:[f.src],_._volume=void 0!==f.volume?f.volume:1,_._xhr={method:f.xhr&&f.xhr.method?f.xhr.method:"GET",headers:f.xhr&&f.xhr.headers?f.xhr.headers:null,withCredentials:!(!f.xhr||!f.xhr.withCredentials)&&f.xhr.withCredentials},_._duration=0,_._state="unloaded",_._sounds=[],_._endTimers={},_._queue=[],_._playLock=!1,_._onend=f.onend?[{fn:f.onend}]:[],_._onfade=f.onfade?[{fn:f.onfade}]:[],_._onload=f.onload?[{fn:f.onload}]:[],_._onloaderror=f.onloaderror?[{fn:f.onloaderror}]:[],_._onplayerror=f.onplayerror?[{fn:f.onplayerror}]:[],_._onpause=f.onpause?[{fn:f.onpause}]:[],_._onplay=f.onplay?[{fn:f.onplay}]:[],_._onstop=f.onstop?[{fn:f.onstop}]:[],_._onmute=f.onmute?[{fn:f.onmute}]:[],_._onvolume=f.onvolume?[{fn:f.onvolume}]:[],_._onrate=f.onrate?[{fn:f.onrate}]:[],_._onseek=f.onseek?[{fn:f.onseek}]:[],_._onunlock=f.onunlock?[{fn:f.onunlock}]:[],_._onresume=[],_._webAudio=I.usingWebAudio&&!_._html5,typeof I.ctx<"u"&&I.ctx&&I.autoUnlock&&I._unlockAudio(),I._howls.push(_),_._autoplay&&_._queue.push({event:"play",action:function(){_.play()}}),_._preload&&"none"!==_._preload&&_.load(),_},load:function(){var f=this,_=null;if(I.noAudio)f._emit("loaderror",null,"No audio support.");else{"string"==typeof f._src&&(f._src=[f._src]);for(var T=0;T<f._src.length;T++){var b,O;if(f._format&&f._format[T])b=f._format[T];else{if("string"!=typeof(O=f._src[T])){f._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(b=/^data:audio\/([^;,]+);/i.exec(O))||(b=/\.([^.]+)$/.exec(O.split("?",1)[0])),b&&(b=b[1].toLowerCase())}if(b||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),b&&I.codecs(b)){_=f._src[T];break}}if(_)return f._src=_,f._state="loading","https:"===window.location.protocol&&"http:"===_.slice(0,5)&&(f._html5=!0,f._webAudio=!1),new E(f),f._webAudio&&ee(f),f;f._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(f,_){var T=this,b=null;if("number"==typeof f)b=f,f=null;else{if("string"==typeof f&&"loaded"===T._state&&!T._sprite[f])return null;if(typeof f>"u"&&(f="__default",!T._playLock)){for(var O=0,L=0;L<T._sounds.length;L++)T._sounds[L]._paused&&!T._sounds[L]._ended&&(O++,b=T._sounds[L]._id);1===O?f=null:b=null}}var R=b?T._soundById(b):T._inactiveSound();if(!R)return null;if(b&&!f&&(f=R._sprite||"__default"),"loaded"!==T._state){R._sprite=f,R._ended=!1;var Q=R._id;return T._queue.push({event:"play",action:function(){T.play(Q)}}),Q}if(b&&!R._paused)return _||T._loadQueue("play"),R._id;T._webAudio&&I._autoResume();var ce=Math.max(0,R._seek>0?R._seek:T._sprite[f][0]/1e3),ke=Math.max(0,(T._sprite[f][0]+T._sprite[f][1])/1e3-ce),Ee=1e3*ke/Math.abs(R._rate),Ce=T._sprite[f][0]/1e3,ct=(T._sprite[f][0]+T._sprite[f][1])/1e3;R._sprite=f,R._ended=!1;var Xt=function(){R._paused=!1,R._seek=ce,R._start=Ce,R._stop=ct,R._loop=!(!R._loop&&!T._sprite[f][2])};if(!(ce>=ct)){var Ae=R._node;if(T._webAudio){var V=function(){T._playLock=!1,Xt(),T._refreshBuffer(R),Ae.gain.setValueAtTime(R._muted||T._muted?0:R._volume,I.ctx.currentTime),R._playStart=I.ctx.currentTime,typeof Ae.bufferSource.start>"u"?Ae.bufferSource.noteGrainOn(0,ce,R._loop?86400:ke):Ae.bufferSource.start(0,ce,R._loop?86400:ke),Ee!==1/0&&(T._endTimers[R._id]=setTimeout(T._ended.bind(T,R),Ee)),_||setTimeout(function(){T._emit("play",R._id),T._loadQueue()},0)};"running"===I.state&&"interrupted"!==I.ctx.state?V():(T._playLock=!0,T.once("resume",V),T._clearTimer(R._id))}else{var lt=function(){Ae.currentTime=ce,Ae.muted=R._muted||T._muted||I._muted||Ae.muted,Ae.volume=R._volume*I.volume(),Ae.playbackRate=R._rate;try{var zt=Ae.play();if(zt&&typeof Promise<"u"&&(zt instanceof Promise||"function"==typeof zt.then)?(T._playLock=!0,Xt(),zt.then(function(){T._playLock=!1,Ae._unlocked=!0,_?T._loadQueue():T._emit("play",R._id)}).catch(function(){T._playLock=!1,T._emit("playerror",R._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),R._ended=!0,R._paused=!0})):_||(T._playLock=!1,Xt(),T._emit("play",R._id)),Ae.playbackRate=R._rate,Ae.paused)return void T._emit("playerror",R._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==f||R._loop?T._endTimers[R._id]=setTimeout(T._ended.bind(T,R),Ee):(T._endTimers[R._id]=function(){T._ended(R),Ae.removeEventListener("ended",T._endTimers[R._id],!1)},Ae.addEventListener("ended",T._endTimers[R._id],!1))}catch(gt){T._emit("playerror",R._id,gt)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===Ae.src&&(Ae.src=T._src,Ae.load());var je=window&&window.ejecta||!Ae.readyState&&I._navigator.isCocoonJS;if(Ae.readyState>=3||je)lt();else{T._playLock=!0,T._state="loading";var pe=function(){T._state="loaded",lt(),Ae.removeEventListener(I._canPlayEvent,pe,!1)};Ae.addEventListener(I._canPlayEvent,pe,!1),T._clearTimer(R._id)}}return R._id}T._ended(R)},pause:function(f){var _=this;if("loaded"!==_._state||_._playLock)return _._queue.push({event:"pause",action:function(){_.pause(f)}}),_;for(var T=_._getSoundIds(f),b=0;b<T.length;b++){_._clearTimer(T[b]);var O=_._soundById(T[b]);if(O&&!O._paused&&(O._seek=_.seek(T[b]),O._rateSeek=0,O._paused=!0,_._stopFade(T[b]),O._node))if(_._webAudio){if(!O._node.bufferSource)continue;typeof O._node.bufferSource.stop>"u"?O._node.bufferSource.noteOff(0):O._node.bufferSource.stop(0),_._cleanBuffer(O._node)}else(!isNaN(O._node.duration)||O._node.duration===1/0)&&O._node.pause();arguments[1]||_._emit("pause",O?O._id:null)}return _},stop:function(f,_){var T=this;if("loaded"!==T._state||T._playLock)return T._queue.push({event:"stop",action:function(){T.stop(f)}}),T;for(var b=T._getSoundIds(f),O=0;O<b.length;O++){T._clearTimer(b[O]);var L=T._soundById(b[O]);L&&(L._seek=L._start||0,L._rateSeek=0,L._paused=!0,L._ended=!0,T._stopFade(b[O]),L._node&&(T._webAudio?L._node.bufferSource&&(typeof L._node.bufferSource.stop>"u"?L._node.bufferSource.noteOff(0):L._node.bufferSource.stop(0),T._cleanBuffer(L._node)):(!isNaN(L._node.duration)||L._node.duration===1/0)&&(L._node.currentTime=L._start||0,L._node.pause(),L._node.duration===1/0&&T._clearSound(L._node))),_||T._emit("stop",L._id))}return T},mute:function(f,_){var T=this;if("loaded"!==T._state||T._playLock)return T._queue.push({event:"mute",action:function(){T.mute(f,_)}}),T;if(typeof _>"u"){if("boolean"!=typeof f)return T._muted;T._muted=f}for(var b=T._getSoundIds(_),O=0;O<b.length;O++){var L=T._soundById(b[O]);L&&(L._muted=f,L._interval&&T._stopFade(L._id),T._webAudio&&L._node?L._node.gain.setValueAtTime(f?0:L._volume,I.ctx.currentTime):L._node&&(L._node.muted=!!I._muted||f),T._emit("mute",L._id))}return T},volume:function(){var T,b,R,f=this,_=arguments;if(0===_.length)return f._volume;if(1===_.length||2===_.length&&typeof _[1]>"u"?f._getSoundIds().indexOf(_[0])>=0?b=parseInt(_[0],10):T=parseFloat(_[0]):_.length>=2&&(T=parseFloat(_[0]),b=parseInt(_[1],10)),!(typeof T<"u"&&T>=0&&T<=1))return(R=b?f._soundById(b):f._sounds[0])?R._volume:0;if("loaded"!==f._state||f._playLock)return f._queue.push({event:"volume",action:function(){f.volume.apply(f,_)}}),f;typeof b>"u"&&(f._volume=T),b=f._getSoundIds(b);for(var Q=0;Q<b.length;Q++)(R=f._soundById(b[Q]))&&(R._volume=T,_[2]||f._stopFade(b[Q]),f._webAudio&&R._node&&!R._muted?R._node.gain.setValueAtTime(T,I.ctx.currentTime):R._node&&!R._muted&&(R._node.volume=T*I.volume()),f._emit("volume",R._id));return f},fade:function(f,_,T,b){var O=this;if("loaded"!==O._state||O._playLock)return O._queue.push({event:"fade",action:function(){O.fade(f,_,T,b)}}),O;f=Math.min(Math.max(0,parseFloat(f)),1),_=Math.min(Math.max(0,parseFloat(_)),1),T=parseFloat(T),O.volume(f,b);for(var L=O._getSoundIds(b),R=0;R<L.length;R++){var Q=O._soundById(L[R]);if(Q){if(b||O._stopFade(L[R]),O._webAudio&&!Q._muted){var ce=I.ctx.currentTime,ke=ce+T/1e3;Q._volume=f,Q._node.gain.setValueAtTime(f,ce),Q._node.gain.linearRampToValueAtTime(_,ke)}O._startFadeInterval(Q,f,_,T,L[R],typeof b>"u")}}return O},_startFadeInterval:function(f,_,T,b,O,L){var R=this,Q=_,ce=T-_,ke=Math.abs(ce/.01),Ee=Math.max(4,ke>0?b/ke:b),Ce=Date.now();f._fadeTo=T,f._interval=setInterval(function(){var ct=(Date.now()-Ce)/b;Ce=Date.now(),Q+=ce*ct,Q=Math.round(100*Q)/100,Q=ce<0?Math.max(T,Q):Math.min(T,Q),R._webAudio?f._volume=Q:R.volume(Q,f._id,!0),L&&(R._volume=Q),(T<_&&Q<=T||T>_&&Q>=T)&&(clearInterval(f._interval),f._interval=null,f._fadeTo=null,R.volume(T,f._id),R._emit("fade",f._id))},Ee)},_stopFade:function(f){var _=this,T=_._soundById(f);return T&&T._interval&&(_._webAudio&&T._node.gain.cancelScheduledValues(I.ctx.currentTime),clearInterval(T._interval),T._interval=null,_.volume(T._fadeTo,f),T._fadeTo=null,_._emit("fade",f)),_},loop:function(){var T,b,O,f=this,_=arguments;if(0===_.length)return f._loop;if(1===_.length){if("boolean"!=typeof _[0])return!!(O=f._soundById(parseInt(_[0],10)))&&O._loop;f._loop=T=_[0]}else 2===_.length&&(T=_[0],b=parseInt(_[1],10));for(var L=f._getSoundIds(b),R=0;R<L.length;R++)(O=f._soundById(L[R]))&&(O._loop=T,f._webAudio&&O._node&&O._node.bufferSource&&(O._node.bufferSource.loop=T,T&&(O._node.bufferSource.loopStart=O._start||0,O._node.bufferSource.loopEnd=O._stop,f.playing(L[R])&&(f.pause(L[R],!0),f.play(L[R],!0)))));return f},rate:function(){var T,b,R,f=this,_=arguments;if(0===_.length?b=f._sounds[0]._id:1===_.length?f._getSoundIds().indexOf(_[0])>=0?b=parseInt(_[0],10):T=parseFloat(_[0]):2===_.length&&(T=parseFloat(_[0]),b=parseInt(_[1],10)),"number"!=typeof T)return(R=f._soundById(b))?R._rate:f._rate;if("loaded"!==f._state||f._playLock)return f._queue.push({event:"rate",action:function(){f.rate.apply(f,_)}}),f;typeof b>"u"&&(f._rate=T),b=f._getSoundIds(b);for(var Q=0;Q<b.length;Q++)if(R=f._soundById(b[Q])){f.playing(b[Q])&&(R._rateSeek=f.seek(b[Q]),R._playStart=f._webAudio?I.ctx.currentTime:R._playStart),R._rate=T,f._webAudio&&R._node&&R._node.bufferSource?R._node.bufferSource.playbackRate.setValueAtTime(T,I.ctx.currentTime):R._node&&(R._node.playbackRate=T);var ce=f.seek(b[Q]),Ee=1e3*((f._sprite[R._sprite][0]+f._sprite[R._sprite][1])/1e3-ce)/Math.abs(R._rate);(f._endTimers[b[Q]]||!R._paused)&&(f._clearTimer(b[Q]),f._endTimers[b[Q]]=setTimeout(f._ended.bind(f,R),Ee)),f._emit("rate",R._id)}return f},seek:function(){var T,b,f=this,_=arguments;if(0===_.length?f._sounds.length&&(b=f._sounds[0]._id):1===_.length?f._getSoundIds().indexOf(_[0])>=0?b=parseInt(_[0],10):f._sounds.length&&(b=f._sounds[0]._id,T=parseFloat(_[0])):2===_.length&&(T=parseFloat(_[0]),b=parseInt(_[1],10)),typeof b>"u")return 0;if("number"==typeof T&&("loaded"!==f._state||f._playLock))return f._queue.push({event:"seek",action:function(){f.seek.apply(f,_)}}),f;var R=f._soundById(b);if(R){if(!("number"==typeof T&&T>=0)){if(f._webAudio){var Ee=f.playing(b)?I.ctx.currentTime-R._playStart:0;return R._seek+((R._rateSeek?R._rateSeek-R._seek:0)+Ee*Math.abs(R._rate))}return R._node.currentTime}var Q=f.playing(b);Q&&f.pause(b,!0),R._seek=T,R._ended=!1,f._clearTimer(b),!f._webAudio&&R._node&&!isNaN(R._node.duration)&&(R._node.currentTime=T);var ce=function(){Q&&f.play(b,!0),f._emit("seek",b)};if(Q&&!f._webAudio){var ke=function(){f._playLock?setTimeout(ke,0):ce()};setTimeout(ke,0)}else ce()}return f},playing:function(f){var _=this;if("number"==typeof f){var T=_._soundById(f);return!!T&&!T._paused}for(var b=0;b<_._sounds.length;b++)if(!_._sounds[b]._paused)return!0;return!1},duration:function(f){var _=this,T=_._duration,b=_._soundById(f);return b&&(T=_._sprite[b._sprite][1]/1e3),T},state:function(){return this._state},unload:function(){for(var f=this,_=f._sounds,T=0;T<_.length;T++)_[T]._paused||f.stop(_[T]._id),f._webAudio||(f._clearSound(_[T]._node),_[T]._node.removeEventListener("error",_[T]._errorFn,!1),_[T]._node.removeEventListener(I._canPlayEvent,_[T]._loadFn,!1),_[T]._node.removeEventListener("ended",_[T]._endFn,!1),I._releaseHtml5Audio(_[T]._node)),delete _[T]._node,f._clearTimer(_[T]._id);var b=I._howls.indexOf(f);b>=0&&I._howls.splice(b,1);var O=!0;for(T=0;T<I._howls.length;T++)if(I._howls[T]._src===f._src||f._src.indexOf(I._howls[T]._src)>=0){O=!1;break}return te&&O&&delete te[f._src],I.noAudio=!1,f._state="unloaded",f._sounds=[],f=null,null},on:function(f,_,T,b){return"function"==typeof _&&this["_on"+f].push(b?{id:T,fn:_,once:b}:{id:T,fn:_}),this},off:function(f,_,T){var b=this,O=b["_on"+f],L=0;if("number"==typeof _&&(T=_,_=null),_||T)for(L=0;L<O.length;L++){var R=T===O[L].id;if(_===O[L].fn&&R||!_&&R){O.splice(L,1);break}}else if(f)b["_on"+f]=[];else{var Q=Object.keys(b);for(L=0;L<Q.length;L++)0===Q[L].indexOf("_on")&&Array.isArray(b[Q[L]])&&(b[Q[L]]=[])}return b},once:function(f,_,T){return this.on(f,_,T,1),this},_emit:function(f,_,T){for(var b=this,O=b["_on"+f],L=O.length-1;L>=0;L--)(!O[L].id||O[L].id===_||"load"===f)&&(setTimeout(function(R){R.call(this,_,T)}.bind(b,O[L].fn),0),O[L].once&&b.off(f,O[L].fn,O[L].id));return b._loadQueue(f),b},_loadQueue:function(f){var _=this;if(_._queue.length>0){var T=_._queue[0];T.event===f&&(_._queue.shift(),_._loadQueue()),f||T.action()}return _},_ended:function(f){var _=this,T=f._sprite;if(!_._webAudio&&f._node&&!f._node.paused&&!f._node.ended&&f._node.currentTime<f._stop)return setTimeout(_._ended.bind(_,f),100),_;var b=!(!f._loop&&!_._sprite[T][2]);if(_._emit("end",f._id),!_._webAudio&&b&&_.stop(f._id,!0).play(f._id),_._webAudio&&b){_._emit("play",f._id),f._seek=f._start||0,f._rateSeek=0,f._playStart=I.ctx.currentTime;var O=1e3*(f._stop-f._start)/Math.abs(f._rate);_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),O)}return _._webAudio&&!b&&(f._paused=!0,f._ended=!0,f._seek=f._start||0,f._rateSeek=0,_._clearTimer(f._id),_._cleanBuffer(f._node),I._autoSuspend()),!_._webAudio&&!b&&_.stop(f._id,!0),_},_clearTimer:function(f){var _=this;if(_._endTimers[f]){if("function"!=typeof _._endTimers[f])clearTimeout(_._endTimers[f]);else{var T=_._soundById(f);T&&T._node&&T._node.removeEventListener("ended",_._endTimers[f],!1)}delete _._endTimers[f]}return _},_soundById:function(f){for(var _=this,T=0;T<_._sounds.length;T++)if(f===_._sounds[T]._id)return _._sounds[T];return null},_inactiveSound:function(){var f=this;f._drain();for(var _=0;_<f._sounds.length;_++)if(f._sounds[_]._ended)return f._sounds[_].reset();return new E(f)},_drain:function(){var f=this,_=f._pool,T=0,b=0;if(!(f._sounds.length<_)){for(b=0;b<f._sounds.length;b++)f._sounds[b]._ended&&T++;for(b=f._sounds.length-1;b>=0;b--){if(T<=_)return;f._sounds[b]._ended&&(f._webAudio&&f._sounds[b]._node&&f._sounds[b]._node.disconnect(0),f._sounds.splice(b,1),T--)}}},_getSoundIds:function(f){if(typeof f>"u"){for(var T=[],b=0;b<this._sounds.length;b++)T.push(this._sounds[b]._id);return T}return[f]},_refreshBuffer:function(f){return f._node.bufferSource=I.ctx.createBufferSource(),f._node.bufferSource.buffer=te[this._src],f._node.bufferSource.connect(f._panner?f._panner:f._node),f._node.bufferSource.loop=f._loop,f._loop&&(f._node.bufferSource.loopStart=f._start||0,f._node.bufferSource.loopEnd=f._stop||0),f._node.bufferSource.playbackRate.setValueAtTime(f._rate,I.ctx.currentTime),this},_cleanBuffer:function(f){var T=I._navigator&&I._navigator.vendor.indexOf("Apple")>=0;if(!f.bufferSource)return this;if(I._scratchBuffer&&f.bufferSource&&(f.bufferSource.onended=null,f.bufferSource.disconnect(0),T))try{f.bufferSource.buffer=I._scratchBuffer}catch{}return f.bufferSource=null,this},_clearSound:function(f){/MSIE |Trident\//.test(I._navigator&&I._navigator.userAgent)||(f.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var E=function(f){this._parent=f,this.init()};E.prototype={init:function(){var f=this,_=f._parent;return f._muted=_._muted,f._loop=_._loop,f._volume=_._volume,f._rate=_._rate,f._seek=0,f._paused=!0,f._ended=!0,f._sprite="__default",f._id=++I._counter,_._sounds.push(f),f.create(),f},create:function(){var f=this,_=f._parent,T=I._muted||f._muted||f._parent._muted?0:f._volume;return _._webAudio?(f._node=typeof I.ctx.createGain>"u"?I.ctx.createGainNode():I.ctx.createGain(),f._node.gain.setValueAtTime(T,I.ctx.currentTime),f._node.paused=!0,f._node.connect(I.masterGain)):I.noAudio||(f._node=I._obtainHtml5Audio(),f._errorFn=f._errorListener.bind(f),f._node.addEventListener("error",f._errorFn,!1),f._loadFn=f._loadListener.bind(f),f._node.addEventListener(I._canPlayEvent,f._loadFn,!1),f._endFn=f._endListener.bind(f),f._node.addEventListener("ended",f._endFn,!1),f._node.src=_._src,f._node.preload=!0===_._preload?"auto":_._preload,f._node.volume=T*I.volume(),f._node.load()),f},reset:function(){var f=this,_=f._parent;return f._muted=_._muted,f._loop=_._loop,f._volume=_._volume,f._rate=_._rate,f._seek=0,f._rateSeek=0,f._paused=!0,f._ended=!0,f._sprite="__default",f._id=++I._counter,f},_errorListener:function(){var f=this;f._parent._emit("loaderror",f._id,f._node.error?f._node.error.code:0),f._node.removeEventListener("error",f._errorFn,!1)},_loadListener:function(){var f=this,_=f._parent;_._duration=Math.ceil(10*f._node.duration)/10,0===Object.keys(_._sprite).length&&(_._sprite={__default:[0,1e3*_._duration]}),"loaded"!==_._state&&(_._state="loaded",_._emit("load"),_._loadQueue()),f._node.removeEventListener(I._canPlayEvent,f._loadFn,!1)},_endListener:function(){var f=this,_=f._parent;_._duration===1/0&&(_._duration=Math.ceil(10*f._node.duration)/10,_._sprite.__default[1]===1/0&&(_._sprite.__default[1]=1e3*_._duration),_._ended(f)),f._node.removeEventListener("ended",f._endFn,!1)}};var te={},ee=function(f){var _=f._src;if(te[_])return f._duration=te[_].duration,void J(f);if(/^data:[^;]+;base64,/.test(_)){for(var T=atob(_.split(",")[1]),b=new Uint8Array(T.length),O=0;O<T.length;++O)b[O]=T.charCodeAt(O);ie(b.buffer,f)}else{var L=new XMLHttpRequest;L.open(f._xhr.method,_,!0),L.withCredentials=f._xhr.withCredentials,L.responseType="arraybuffer",f._xhr.headers&&Object.keys(f._xhr.headers).forEach(function(R){L.setRequestHeader(R,f._xhr.headers[R])}),L.onload=function(){var R=(L.status+"")[0];"0"===R||"2"===R||"3"===R?ie(L.response,f):f._emit("loaderror",null,"Failed loading audio file with status: "+L.status+".")},L.onerror=function(){f._webAudio&&(f._html5=!0,f._webAudio=!1,f._sounds=[],delete te[_],f.load())},Ge(L)}},Ge=function(f){try{f.send()}catch{f.onerror()}},ie=function(f,_){var T=function(){_._emit("loaderror",null,"Decoding audio data failed.")},b=function(O){O&&_._sounds.length>0?(te[_._src]=O,J(_,O)):T()};typeof Promise<"u"&&1===I.ctx.decodeAudioData.length?I.ctx.decodeAudioData(f).then(b).catch(T):I.ctx.decodeAudioData(f,b,T)},J=function(f,_){_&&!f._duration&&(f._duration=_.duration),0===Object.keys(f._sprite).length&&(f._sprite={__default:[0,1e3*f._duration]}),"loaded"!==f._state&&(f._state="loaded",f._emit("load"),f._loadQueue())},v=function(){if(I.usingWebAudio){try{typeof AudioContext<"u"?I.ctx=new AudioContext:typeof webkitAudioContext<"u"?I.ctx=new webkitAudioContext:I.usingWebAudio=!1}catch{I.usingWebAudio=!1}I.ctx||(I.usingWebAudio=!1);var f=/iP(hone|od|ad)/.test(I._navigator&&I._navigator.platform),_=I._navigator&&I._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),T=_?parseInt(_[1],10):null;if(f&&T&&T<9){var b=/safari/.test(I._navigator&&I._navigator.userAgent.toLowerCase());I._navigator&&!b&&(I.usingWebAudio=!1)}I.usingWebAudio&&(I.masterGain=typeof I.ctx.createGain>"u"?I.ctx.createGainNode():I.ctx.createGain(),I.masterGain.gain.setValueAtTime(I._muted?0:I._volume,I.ctx.currentTime),I.masterGain.connect(I.ctx.destination)),I._setup()}};void 0!==(S=function(){return{Howler:I,Howl:P}}.apply(ur,[]))&&(vh.exports=S),ur.Howler=I,ur.Howl=P,typeof global<"u"?(global.HowlerGlobal=de,global.Howler=I,global.Howl=P,global.Sound=E):typeof window<"u"&&(window.HowlerGlobal=de,window.Howler=I,window.Howl=P,window.Sound=E)}(),function(){"use strict";var I;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(I){var P=this;if(!P.ctx||!P.ctx.listener)return P;for(var E=P._howls.length-1;E>=0;E--)P._howls[E].stereo(I);return P},HowlerGlobal.prototype.pos=function(I,P,E){var te=this;return te.ctx&&te.ctx.listener?"number"!=typeof I?te._pos:(te._pos=[I,P="number"!=typeof P?te._pos[1]:P,E="number"!=typeof E?te._pos[2]:E],typeof te.ctx.listener.positionX<"u"?(te.ctx.listener.positionX.setTargetAtTime(te._pos[0],Howler.ctx.currentTime,.1),te.ctx.listener.positionY.setTargetAtTime(te._pos[1],Howler.ctx.currentTime,.1),te.ctx.listener.positionZ.setTargetAtTime(te._pos[2],Howler.ctx.currentTime,.1)):te.ctx.listener.setPosition(te._pos[0],te._pos[1],te._pos[2]),te):te},HowlerGlobal.prototype.orientation=function(I,P,E,te,ee,Ge){var ie=this;if(!ie.ctx||!ie.ctx.listener)return ie;var J=ie._orientation;return"number"!=typeof I?J:(ie._orientation=[I,P="number"!=typeof P?J[1]:P,E="number"!=typeof E?J[2]:E,te="number"!=typeof te?J[3]:te,ee="number"!=typeof ee?J[4]:ee,Ge="number"!=typeof Ge?J[5]:Ge],typeof ie.ctx.listener.forwardX<"u"?(ie.ctx.listener.forwardX.setTargetAtTime(I,Howler.ctx.currentTime,.1),ie.ctx.listener.forwardY.setTargetAtTime(P,Howler.ctx.currentTime,.1),ie.ctx.listener.forwardZ.setTargetAtTime(E,Howler.ctx.currentTime,.1),ie.ctx.listener.upX.setTargetAtTime(te,Howler.ctx.currentTime,.1),ie.ctx.listener.upY.setTargetAtTime(ee,Howler.ctx.currentTime,.1),ie.ctx.listener.upZ.setTargetAtTime(Ge,Howler.ctx.currentTime,.1)):ie.ctx.listener.setOrientation(I,P,E,te,ee,Ge),ie)},Howl.prototype.init=(I=Howl.prototype.init,function(P){var E=this;return E._orientation=P.orientation||[1,0,0],E._stereo=P.stereo||null,E._pos=P.pos||null,E._pannerAttr={coneInnerAngle:typeof P.coneInnerAngle<"u"?P.coneInnerAngle:360,coneOuterAngle:typeof P.coneOuterAngle<"u"?P.coneOuterAngle:360,coneOuterGain:typeof P.coneOuterGain<"u"?P.coneOuterGain:0,distanceModel:typeof P.distanceModel<"u"?P.distanceModel:"inverse",maxDistance:typeof P.maxDistance<"u"?P.maxDistance:1e4,panningModel:typeof P.panningModel<"u"?P.panningModel:"HRTF",refDistance:typeof P.refDistance<"u"?P.refDistance:1,rolloffFactor:typeof P.rolloffFactor<"u"?P.rolloffFactor:1},E._onstereo=P.onstereo?[{fn:P.onstereo}]:[],E._onpos=P.onpos?[{fn:P.onpos}]:[],E._onorientation=P.onorientation?[{fn:P.onorientation}]:[],I.call(this,P)}),Howl.prototype.stereo=function(I,P){var E=this;if(!E._webAudio)return E;if("loaded"!==E._state)return E._queue.push({event:"stereo",action:function(){E.stereo(I,P)}}),E;var te=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof P>"u"){if("number"!=typeof I)return E._stereo;E._stereo=I,E._pos=[I,0,0]}for(var ee=E._getSoundIds(P),Ge=0;Ge<ee.length;Ge++){var ie=E._soundById(ee[Ge]);if(ie){if("number"!=typeof I)return ie._stereo;ie._stereo=I,ie._pos=[I,0,0],ie._node&&(ie._pannerAttr.panningModel="equalpower",(!ie._panner||!ie._panner.pan)&&de(ie,te),"spatial"===te?typeof ie._panner.positionX<"u"?(ie._panner.positionX.setValueAtTime(I,Howler.ctx.currentTime),ie._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),ie._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):ie._panner.setPosition(I,0,0):ie._panner.pan.setValueAtTime(I,Howler.ctx.currentTime)),E._emit("stereo",ie._id)}}return E},Howl.prototype.pos=function(I,P,E,te){var ee=this;if(!ee._webAudio)return ee;if("loaded"!==ee._state)return ee._queue.push({event:"pos",action:function(){ee.pos(I,P,E,te)}}),ee;if(P="number"!=typeof P?0:P,E="number"!=typeof E?-.5:E,typeof te>"u"){if("number"!=typeof I)return ee._pos;ee._pos=[I,P,E]}for(var Ge=ee._getSoundIds(te),ie=0;ie<Ge.length;ie++){var J=ee._soundById(Ge[ie]);if(J){if("number"!=typeof I)return J._pos;J._pos=[I,P,E],J._node&&((!J._panner||J._panner.pan)&&de(J,"spatial"),typeof J._panner.positionX<"u"?(J._panner.positionX.setValueAtTime(I,Howler.ctx.currentTime),J._panner.positionY.setValueAtTime(P,Howler.ctx.currentTime),J._panner.positionZ.setValueAtTime(E,Howler.ctx.currentTime)):J._panner.setPosition(I,P,E)),ee._emit("pos",J._id)}}return ee},Howl.prototype.orientation=function(I,P,E,te){var ee=this;if(!ee._webAudio)return ee;if("loaded"!==ee._state)return ee._queue.push({event:"orientation",action:function(){ee.orientation(I,P,E,te)}}),ee;if(P="number"!=typeof P?ee._orientation[1]:P,E="number"!=typeof E?ee._orientation[2]:E,typeof te>"u"){if("number"!=typeof I)return ee._orientation;ee._orientation=[I,P,E]}for(var Ge=ee._getSoundIds(te),ie=0;ie<Ge.length;ie++){var J=ee._soundById(Ge[ie]);if(J){if("number"!=typeof I)return J._orientation;J._orientation=[I,P,E],J._node&&(J._panner||(J._pos||(J._pos=ee._pos||[0,0,-.5]),de(J,"spatial")),typeof J._panner.orientationX<"u"?(J._panner.orientationX.setValueAtTime(I,Howler.ctx.currentTime),J._panner.orientationY.setValueAtTime(P,Howler.ctx.currentTime),J._panner.orientationZ.setValueAtTime(E,Howler.ctx.currentTime)):J._panner.setOrientation(I,P,E)),ee._emit("orientation",J._id)}}return ee},Howl.prototype.pannerAttr=function(){var E,te,ee,I=this,P=arguments;if(!I._webAudio)return I;if(0===P.length)return I._pannerAttr;if(1===P.length){if("object"!=typeof P[0])return(ee=I._soundById(parseInt(P[0],10)))?ee._pannerAttr:I._pannerAttr;E=P[0],typeof te>"u"&&(E.pannerAttr||(E.pannerAttr={coneInnerAngle:E.coneInnerAngle,coneOuterAngle:E.coneOuterAngle,coneOuterGain:E.coneOuterGain,distanceModel:E.distanceModel,maxDistance:E.maxDistance,refDistance:E.refDistance,rolloffFactor:E.rolloffFactor,panningModel:E.panningModel}),I._pannerAttr={coneInnerAngle:typeof E.pannerAttr.coneInnerAngle<"u"?E.pannerAttr.coneInnerAngle:I._coneInnerAngle,coneOuterAngle:typeof E.pannerAttr.coneOuterAngle<"u"?E.pannerAttr.coneOuterAngle:I._coneOuterAngle,coneOuterGain:typeof E.pannerAttr.coneOuterGain<"u"?E.pannerAttr.coneOuterGain:I._coneOuterGain,distanceModel:typeof E.pannerAttr.distanceModel<"u"?E.pannerAttr.distanceModel:I._distanceModel,maxDistance:typeof E.pannerAttr.maxDistance<"u"?E.pannerAttr.maxDistance:I._maxDistance,refDistance:typeof E.pannerAttr.refDistance<"u"?E.pannerAttr.refDistance:I._refDistance,rolloffFactor:typeof E.pannerAttr.rolloffFactor<"u"?E.pannerAttr.rolloffFactor:I._rolloffFactor,panningModel:typeof E.pannerAttr.panningModel<"u"?E.pannerAttr.panningModel:I._panningModel})}else 2===P.length&&(E=P[0],te=parseInt(P[1],10));for(var Ge=I._getSoundIds(te),ie=0;ie<Ge.length;ie++)if(ee=I._soundById(Ge[ie])){var J=ee._pannerAttr;J={coneInnerAngle:typeof E.coneInnerAngle<"u"?E.coneInnerAngle:J.coneInnerAngle,coneOuterAngle:typeof E.coneOuterAngle<"u"?E.coneOuterAngle:J.coneOuterAngle,coneOuterGain:typeof E.coneOuterGain<"u"?E.coneOuterGain:J.coneOuterGain,distanceModel:typeof E.distanceModel<"u"?E.distanceModel:J.distanceModel,maxDistance:typeof E.maxDistance<"u"?E.maxDistance:J.maxDistance,refDistance:typeof E.refDistance<"u"?E.refDistance:J.refDistance,rolloffFactor:typeof E.rolloffFactor<"u"?E.rolloffFactor:J.rolloffFactor,panningModel:typeof E.panningModel<"u"?E.panningModel:J.panningModel};var v=ee._panner;v||(ee._pos||(ee._pos=I._pos||[0,0,-.5]),de(ee,"spatial"),v=ee._panner),v.coneInnerAngle=J.coneInnerAngle,v.coneOuterAngle=J.coneOuterAngle,v.coneOuterGain=J.coneOuterGain,v.distanceModel=J.distanceModel,v.maxDistance=J.maxDistance,v.refDistance=J.refDistance,v.rolloffFactor=J.rolloffFactor,v.panningModel=J.panningModel}return I},Sound.prototype.init=function(I){return function(){var P=this,E=P._parent;P._orientation=E._orientation,P._stereo=E._stereo,P._pos=E._pos,P._pannerAttr=E._pannerAttr,I.call(this),P._stereo?E.stereo(P._stereo):P._pos&&E.pos(P._pos[0],P._pos[1],P._pos[2],P._id)}}(Sound.prototype.init),Sound.prototype.reset=function(I){return function(){var P=this,E=P._parent;return P._orientation=E._orientation,P._stereo=E._stereo,P._pos=E._pos,P._pannerAttr=E._pannerAttr,P._stereo?E.stereo(P._stereo):P._pos?E.pos(P._pos[0],P._pos[1],P._pos[2],P._id):P._panner&&(P._panner.disconnect(0),P._panner=void 0,E._refreshBuffer(P)),I.call(this)}}(Sound.prototype.reset);var de=function(I,P){"spatial"===(P=P||"spatial")?(I._panner=Howler.ctx.createPanner(),I._panner.coneInnerAngle=I._pannerAttr.coneInnerAngle,I._panner.coneOuterAngle=I._pannerAttr.coneOuterAngle,I._panner.coneOuterGain=I._pannerAttr.coneOuterGain,I._panner.distanceModel=I._pannerAttr.distanceModel,I._panner.maxDistance=I._pannerAttr.maxDistance,I._panner.refDistance=I._pannerAttr.refDistance,I._panner.rolloffFactor=I._pannerAttr.rolloffFactor,I._panner.panningModel=I._pannerAttr.panningModel,typeof I._panner.positionX<"u"?(I._panner.positionX.setValueAtTime(I._pos[0],Howler.ctx.currentTime),I._panner.positionY.setValueAtTime(I._pos[1],Howler.ctx.currentTime),I._panner.positionZ.setValueAtTime(I._pos[2],Howler.ctx.currentTime)):I._panner.setPosition(I._pos[0],I._pos[1],I._pos[2]),typeof I._panner.orientationX<"u"?(I._panner.orientationX.setValueAtTime(I._orientation[0],Howler.ctx.currentTime),I._panner.orientationY.setValueAtTime(I._orientation[1],Howler.ctx.currentTime),I._panner.orientationZ.setValueAtTime(I._orientation[2],Howler.ctx.currentTime)):I._panner.setOrientation(I._orientation[0],I._orientation[1],I._orientation[2])):(I._panner=Howler.ctx.createStereoPanner(),I._panner.pan.setValueAtTime(I._stereo,Howler.ctx.currentTime)),I._panner.connect(I._node),I._paused||I._parent.pause(I._id,!0).play(I._id,!0)}}()},8977:(vh,ur,ne)=>{"use strict";ne.r(ur);var S=ne(5861),de=ne(3399),I=ne(9058),P=ne(7592),E=ne(7582),te=ne(7879),ee=ne(4537);const ie={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const b=function _(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},O=function T(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},L=new I.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Q=new te.Yd("@firebase/auth");function ke(c,...o){Q.logLevel<=te.in.ERROR&&Q.error(`Auth (${P.SDK_VERSION}): ${c}`,...o)}function Ee(c,...o){throw Ae(c,...o)}function Ce(c,...o){return Ae(c,...o)}function ct(c,o,u){const l=Object.assign(Object.assign({},O()),{[o]:u});return new I.LL("auth","Firebase",l).create(o,{appName:c.name})}function Xt(c,o,u){if(!(o instanceof u))throw u.name!==o.constructor.name&&Ee(c,"argument-error"),ct(c,"argument-error",`Type of ${o.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ae(c,...o){if("string"!=typeof c){const u=o[0],l=[...o.slice(1)];return l[0]&&(l[0].appName=c.name),c._errorFactory.create(u,...l)}return L.create(c,...o)}function V(c,o,...u){if(!c)throw Ae(o,...u)}function lt(c){const o="INTERNAL ASSERTION FAILED: "+c;throw ke(o),new Error(o)}function je(c,o){c||lt(o)}function pe(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.href)||""}function zt(){return"http:"===gt()||"https:"===gt()}function gt(){var c;return typeof self<"u"&&(null===(c=self.location)||void 0===c?void 0:c.protocol)||null}class se{constructor(o,u){this.shortDelay=o,this.longDelay=u,je(u>o,"Short delay should be less than long delay!"),this.isMobile=(0,I.uI)()||(0,I.b$)()}get(){return function j(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(zt()||(0,I.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cr(c,o){je(c.emulator,"Emulator should always be set here");const{url:u}=c.emulator;return o?`${u}${o.startsWith("/")?o.slice(1):o}`:u}class lr{static initialize(o,u,l){this.fetchImpl=o,u&&(this.headersImpl=u),l&&(this.responseImpl=l)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ih={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ea=new se(3e4,6e4);function Fe(c,o){return c.tenantId&&!o.tenantId?Object.assign(Object.assign({},o),{tenantId:c.tenantId}):o}function Ze(c,o,u,l){return ta.apply(this,arguments)}function ta(){return(ta=(0,S.Z)(function*(c,o,u,l,p={}){return st(c,p,(0,S.Z)(function*(){let g={},A={};l&&("GET"===o?A=l:g={body:JSON.stringify(l)});const x=(0,I.xO)(Object.assign({key:c.config.apiKey},A)).slice(1),F=yield c._getAdditionalHeaders();return F["Content-Type"]="application/json",c.languageCode&&(F["X-Firebase-Locale"]=c.languageCode),lr.fetch()(ac(c,c.config.apiHost,u,x),Object.assign({method:o,headers:F,referrerPolicy:"no-referrer"},g))}))})).apply(this,arguments)}function st(c,o,u){return hr.apply(this,arguments)}function hr(){return(hr=(0,S.Z)(function*(c,o,u){c._canInitEmulator=!1;const l=Object.assign(Object.assign({},Ih),o);try{const p=new uc(c),g=yield Promise.race([u(),p.promise]);p.clearNetworkTimeout();const A=yield g.json();if("needConfirmation"in A)throw On(c,"account-exists-with-different-credential",A);if(g.ok&&!("errorMessage"in A))return A;{const x=g.ok?A.errorMessage:A.error.message,[F,B]=x.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===F)throw On(c,"credential-already-in-use",A);if("EMAIL_EXISTS"===F)throw On(c,"email-already-in-use",A);if("USER_DISABLED"===F)throw On(c,"user-disabled",A);const K=l[F]||F.toLowerCase().replace(/[_\s]+/g,"-");if(B)throw ct(c,K,B);Ee(c,K)}}catch(p){if(p instanceof I.ZR)throw p;Ee(c,"network-request-failed",{message:String(p)})}})).apply(this,arguments)}function Ne(c,o,u,l){return $t.apply(this,arguments)}function $t(){return($t=(0,S.Z)(function*(c,o,u,l,p={}){const g=yield Ze(c,o,u,l,p);return"mfaPendingCredential"in g&&Ee(c,"multi-factor-auth-required",{_serverResponse:g}),g})).apply(this,arguments)}function ac(c,o,u,l){const p=`${o}${u}?${l}`;return c.config.emulator?cr(c.config,p):`${c.config.apiScheme}://${p}`}class uc{constructor(o){this.auth=o,this.timer=null,this.promise=new Promise((u,l)=>{this.timer=setTimeout(()=>l(Ce(this.auth,"network-request-failed")),ea.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function On(c,o,u){const l={appName:c.name};u.email&&(l.email=u.email),u.phoneNumber&&(l.phoneNumber=u.phoneNumber);const p=Ce(c,o,l);return p.customData._tokenResponse=u,p}function nt(){return(nt=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:delete",o)})).apply(this,arguments)}function Mn(){return(Mn=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Nt(){return(Nt=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:lookup",o)})).apply(this,arguments)}function Ln(c){if(c)try{const o=new Date(Number(c));if(!isNaN(o.getTime()))return o.toUTCString()}catch{}}function pn(){return(pn=(0,S.Z)(function*(c,o=!1){const u=(0,I.m9)(c),l=yield u.getIdToken(o),p=dr(l);V(p&&p.exp&&p.auth_time&&p.iat,u.auth,"internal-error");const g="object"==typeof p.firebase?p.firebase:void 0,A=null==g?void 0:g.sign_in_provider;return{claims:p,token:l,authTime:Ln(ms(p.auth_time)),issuedAtTime:Ln(ms(p.iat)),expirationTime:Ln(ms(p.exp)),signInProvider:A||null,signInSecondFactor:(null==g?void 0:g.sign_in_second_factor)||null}})).apply(this,arguments)}function ms(c){return 1e3*Number(c)}function dr(c){const[o,u,l]=c.split(".");if(void 0===o||void 0===u||void 0===l)return ke("JWT malformed, contained fewer than 3 sections"),null;try{const p=(0,I.tV)(u);return p?JSON.parse(p):(ke("Failed to decode base64 JWT payload"),null)}catch(p){return ke("Caught error parsing JWT payload as JSON",null==p?void 0:p.toString()),null}}function Jt(c,o){return gs.apply(this,arguments)}function gs(){return(gs=(0,S.Z)(function*(c,o,u=!1){if(u)return o;try{return yield o}catch(l){throw l instanceof I.ZR&&function na({code:c}){return"auth/user-disabled"===c||"auth/user-token-expired"===c}(l)&&c.auth.currentUser===c&&(yield c.auth.signOut()),l}})).apply(this,arguments)}class ra{constructor(o){this.user=o,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(o){var u;if(o){const l=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),l}{this.errorBackoff=3e4;const p=(null!==(u=this.user.stsTokenManager.expirationTime)&&void 0!==u?u:0)-Date.now()-3e5;return Math.max(0,p)}}schedule(o=!1){var u=this;if(!this.isRunning)return;const l=this.getInterval(o);this.timerId=setTimeout((0,S.Z)(function*(){yield u.iteration()}),l)}iteration(){var o=this;return(0,S.Z)(function*(){try{yield o.user.getIdToken(!0)}catch(u){return void("auth/network-request-failed"===(null==u?void 0:u.code)&&o.schedule(!0))}o.schedule()})()}}class _s{constructor(o,u){this.createdAt=o,this.lastLoginAt=u,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ln(this.lastLoginAt),this.creationTime=Ln(this.createdAt)}_copy(o){this.createdAt=o.createdAt,this.lastLoginAt=o.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Fn(c){return Wr.apply(this,arguments)}function Wr(){return Wr=(0,S.Z)(function*(c){var o;const u=c.auth,l=yield c.getIdToken(),p=yield Jt(c,function ps(c,o){return Nt.apply(this,arguments)}(u,{idToken:l}));V(null==p?void 0:p.users.length,u,"internal-error");const g=p.users[0];c._notifyReloadListener(g);const A=null!==(o=g.providerUserInfo)&&void 0!==o&&o.length?function Eh(c){return c.map(o=>{var{providerId:u}=o,l=(0,E._T)(o,["providerId"]);return{providerId:u,uid:l.rawId||"",displayName:l.displayName||null,email:l.email||null,phoneNumber:l.phoneNumber||null,photoURL:l.photoUrl||null}})}(g.providerUserInfo):[],x=function Qr(c,o){return[...c.filter(l=>!o.some(p=>p.providerId===l.providerId)),...o]}(c.providerData,A),K=!!c.isAnonymous&&!(c.email&&g.passwordHash||null!=x&&x.length),W={uid:g.localId,displayName:g.displayName||null,photoURL:g.photoUrl||null,email:g.email||null,emailVerified:g.emailVerified||!1,phoneNumber:g.phoneNumber||null,tenantId:g.tenantId||null,providerData:x,metadata:new _s(g.createdAt,g.lastLoginAt),isAnonymous:K};Object.assign(c,W)}),Wr.apply(this,arguments)}function ia(){return(ia=(0,S.Z)(function*(c){const o=(0,I.m9)(c);yield Fn(o),yield o.auth._persistUserIfCurrent(o),o.auth._notifyListenersIfCurrent(o)})).apply(this,arguments)}function sa(){return(sa=(0,S.Z)(function*(c,o){const u=yield st(c,{},(0,S.Z)(function*(){const l=(0,I.xO)({grant_type:"refresh_token",refresh_token:o}).slice(1),{tokenApiHost:p,apiKey:g}=c.config,A=ac(c,p,"/v1/token",`key=${g}`),x=yield c._getAdditionalHeaders();return x["Content-Type"]="application/x-www-form-urlencoded",lr.fetch()(A,{method:"POST",headers:x,body:l})}));return{accessToken:u.access_token,expiresIn:u.expires_in,refreshToken:u.refresh_token}})).apply(this,arguments)}class Xr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(o){V(o.idToken,"internal-error"),V(typeof o.idToken<"u","internal-error"),V(typeof o.refreshToken<"u","internal-error");const u="expiresIn"in o&&typeof o.expiresIn<"u"?Number(o.expiresIn):function lc(c){const o=dr(c);return V(o,"internal-error"),V(typeof o.exp<"u","internal-error"),V(typeof o.iat<"u","internal-error"),Number(o.exp)-Number(o.iat)}(o.idToken);this.updateTokensAndExpiration(o.idToken,o.refreshToken,u)}getToken(o,u=!1){var l=this;return(0,S.Z)(function*(){return V(!l.accessToken||l.refreshToken,o,"user-token-expired"),u||!l.accessToken||l.isExpired?l.refreshToken?(yield l.refresh(o,l.refreshToken),l.accessToken):null:l.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(o,u){var l=this;return(0,S.Z)(function*(){const{accessToken:p,refreshToken:g,expiresIn:A}=yield function Yr(c,o){return sa.apply(this,arguments)}(o,u);l.updateTokensAndExpiration(p,g,Number(A))})()}updateTokensAndExpiration(o,u,l){this.refreshToken=u||null,this.accessToken=o||null,this.expirationTime=Date.now()+1e3*l}static fromJSON(o,u){const{refreshToken:l,accessToken:p,expirationTime:g}=u,A=new Xr;return l&&(V("string"==typeof l,"internal-error",{appName:o}),A.refreshToken=l),p&&(V("string"==typeof p,"internal-error",{appName:o}),A.accessToken=p),g&&(V("number"==typeof g,"internal-error",{appName:o}),A.expirationTime=g),A}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(o){this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,this.expirationTime=o.expirationTime}_clone(){return Object.assign(new Xr,this.toJSON())}_performRefresh(){return lt("not implemented")}}function qt(c,o){V("string"==typeof c||typeof c>"u","internal-error",{appName:o})}class en{constructor(o){var{uid:u,auth:l,stsTokenManager:p}=o,g=(0,E._T)(o,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ra(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=u,this.auth=l,this.stsTokenManager=p,this.accessToken=p.accessToken,this.displayName=g.displayName||null,this.email=g.email||null,this.emailVerified=g.emailVerified||!1,this.phoneNumber=g.phoneNumber||null,this.photoURL=g.photoURL||null,this.isAnonymous=g.isAnonymous||!1,this.tenantId=g.tenantId||null,this.providerData=g.providerData?[...g.providerData]:[],this.metadata=new _s(g.createdAt||void 0,g.lastLoginAt||void 0)}getIdToken(o){var u=this;return(0,S.Z)(function*(){const l=yield Jt(u,u.stsTokenManager.getToken(u.auth,o));return V(l,u.auth,"internal-error"),u.accessToken!==l&&(u.accessToken=l,yield u.auth._persistUserIfCurrent(u),u.auth._notifyListenersIfCurrent(u)),l})()}getIdTokenResult(o){return function Th(c){return pn.apply(this,arguments)}(this,o)}reload(){return function hc(c){return ia.apply(this,arguments)}(this)}_assign(o){this!==o&&(V(this.uid===o.uid,this.auth,"internal-error"),this.displayName=o.displayName,this.photoURL=o.photoURL,this.email=o.email,this.emailVerified=o.emailVerified,this.phoneNumber=o.phoneNumber,this.isAnonymous=o.isAnonymous,this.tenantId=o.tenantId,this.providerData=o.providerData.map(u=>Object.assign({},u)),this.metadata._copy(o.metadata),this.stsTokenManager._assign(o.stsTokenManager))}_clone(o){const u=new en(Object.assign(Object.assign({},this),{auth:o,stsTokenManager:this.stsTokenManager._clone()}));return u.metadata._copy(this.metadata),u}_onReload(o){V(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=o,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(o){this.reloadListener?this.reloadListener(o):this.reloadUserInfo=o}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(o,u=!1){var l=this;return(0,S.Z)(function*(){let p=!1;o.idToken&&o.idToken!==l.stsTokenManager.accessToken&&(l.stsTokenManager.updateFromServerResponse(o),p=!0),u&&(yield Fn(l)),yield l.auth._persistUserIfCurrent(l),p&&l.auth._notifyListenersIfCurrent(l)})()}delete(){var o=this;return(0,S.Z)(function*(){const u=yield o.getIdToken();return yield Jt(o,function cc(c,o){return nt.apply(this,arguments)}(o.auth,{idToken:u})),o.stsTokenManager.clearRefreshToken(),o.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(o=>Object.assign({},o)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(o,u){var l,p,g,A,x,F,B,K;const W=null!==(l=u.displayName)&&void 0!==l?l:void 0,he=null!==(p=u.email)&&void 0!==p?p:void 0,le=null!==(g=u.phoneNumber)&&void 0!==g?g:void 0,Ki=null!==(A=u.photoURL)&&void 0!==A?A:void 0,ku=null!==(x=u.tenantId)&&void 0!==x?x:void 0,Wi=null!==(F=u._redirectEventId)&&void 0!==F?F:void 0,Qi=null!==(B=u.createdAt)&&void 0!==B?B:void 0,Cu=null!==(K=u.lastLoginAt)&&void 0!==K?K:void 0,{uid:Nu,emailVerified:Ru,isAnonymous:Du,providerData:Yi,stsTokenManager:Fr}=u;V(Nu&&Fr,o,"internal-error");const Xi=Xr.fromJSON(this.name,Fr);V("string"==typeof Nu,o,"internal-error"),qt(W,o.name),qt(he,o.name),V("boolean"==typeof Ru,o,"internal-error"),V("boolean"==typeof Du,o,"internal-error"),qt(le,o.name),qt(Ki,o.name),qt(ku,o.name),qt(Wi,o.name),qt(Qi,o.name),qt(Cu,o.name);const rr=new en({uid:Nu,auth:o,email:he,emailVerified:Ru,displayName:W,isAnonymous:Du,photoURL:Ki,phoneNumber:le,tenantId:ku,stsTokenManager:Xi,createdAt:Qi,lastLoginAt:Cu});return Yi&&Array.isArray(Yi)&&(rr.providerData=Yi.map(Po=>Object.assign({},Po))),Wi&&(rr._redirectEventId=Wi),rr}static _fromIdTokenResponse(o,u,l=!1){return(0,S.Z)(function*(){const p=new Xr;p.updateFromServerResponse(u);const g=new en({uid:u.localId,auth:o,stsTokenManager:p,isAnonymous:l});return yield Fn(g),g})()}}const dc=new Map;function _t(c){je(c instanceof Function,"Expected a class definition");let o=dc.get(c);return o?(je(o instanceof c,"Instance stored in cache mismatched with class"),o):(o=new c,dc.set(c,o),o)}const Un=(()=>{class c{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,S.Z)(function*(){return!0})()}_set(u,l){var p=this;return(0,S.Z)(function*(){p.storage[u]=l})()}_get(u){var l=this;return(0,S.Z)(function*(){const p=l.storage[u];return void 0===p?null:p})()}_remove(u){var l=this;return(0,S.Z)(function*(){delete l.storage[u]})()}_addListener(u,l){}_removeListener(u,l){}}return c.type="NONE",c})();function jt(c,o,u){return`firebase:${c}:${o}:${u}`}class mn{constructor(o,u,l){this.persistence=o,this.auth=u,this.userKey=l;const{config:p,name:g}=this.auth;this.fullUserKey=jt(this.userKey,p.apiKey,g),this.fullPersistenceKey=jt("persistence",p.apiKey,g),this.boundEventHandler=u._onStorageEvent.bind(u),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(o){return this.persistence._set(this.fullUserKey,o.toJSON())}getCurrentUser(){var o=this;return(0,S.Z)(function*(){const u=yield o.persistence._get(o.fullUserKey);return u?en._fromJSON(o.auth,u):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(o){var u=this;return(0,S.Z)(function*(){if(u.persistence===o)return;const l=yield u.getCurrentUser();return yield u.removeCurrentUser(),u.persistence=o,l?u.setCurrentUser(l):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(o,u,l="authUser"){return(0,S.Z)(function*(){if(!u.length)return new mn(_t(Un),o,l);const p=(yield Promise.all(u.map(function(){var B=(0,S.Z)(function*(K){if(yield K._isAvailable())return K});return function(K){return B.apply(this,arguments)}}()))).filter(B=>B);let g=p[0]||_t(Un);const A=jt(l,o.config.apiKey,o.name);let x=null;for(const B of u)try{const K=yield B._get(A);if(K){const W=en._fromJSON(o,K);B!==g&&(x=W),g=B;break}}catch{}const F=p.filter(B=>B._shouldAllowMigration);return g._shouldAllowMigration&&F.length?(g=F[0],x&&(yield g._set(A,x.toJSON())),yield Promise.all(u.map(function(){var B=(0,S.Z)(function*(K){if(K!==g)try{yield K._remove(A)}catch{}});return function(K){return B.apply(this,arguments)}}())),new mn(g,o,l)):new mn(g,o,l)})()}}function ys(c){const o=c.toLowerCase();if(o.includes("opera/")||o.includes("opr/")||o.includes("opios/"))return"Opera";if(aa(o))return"IEMobile";if(o.includes("msie")||o.includes("trident/"))return"IE";if(o.includes("edge/"))return"Edge";if(vs(o))return"Firefox";if(o.includes("silk/"))return"Silk";if(ua(o))return"Blackberry";if(ca(o))return"Webos";if(Jr(o))return"Safari";if((o.includes("chrome/")||oa(o))&&!o.includes("edge/"))return"Chrome";if(ei(o))return"Android";{const l=c.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==l?void 0:l.length))return l[1]}return"Other"}function vs(c=(0,I.z$)()){return/firefox\//i.test(c)}function Jr(c=(0,I.z$)()){const o=c.toLowerCase();return o.includes("safari/")&&!o.includes("chrome/")&&!o.includes("crios/")&&!o.includes("android")}function oa(c=(0,I.z$)()){return/crios\//i.test(c)}function aa(c=(0,I.z$)()){return/iemobile/i.test(c)}function ei(c=(0,I.z$)()){return/android/i.test(c)}function ua(c=(0,I.z$)()){return/blackberry/i.test(c)}function ca(c=(0,I.z$)()){return/webos/i.test(c)}function gn(c=(0,I.z$)()){return/iphone|ipad|ipod/i.test(c)||/macintosh/i.test(c)&&/mobile/i.test(c)}function Is(c=(0,I.z$)()){return gn(c)||ei(c)||ca(c)||ua(c)||/windows phone/i.test(c)||aa(c)}function Ke(c,o=[]){let u;switch(c){case"Browser":u=ys((0,I.z$)());break;case"Worker":u=`${ys((0,I.z$)())}-${c}`;break;default:u=c}const l=o.length?o.join(","):"FirebaseCore-web";return`${u}/JsCore/${P.SDK_VERSION}/${l}`}function fr(){return(fr=(0,S.Z)(function*(c){return(yield Ze(c,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function ws(c,o){return da.apply(this,arguments)}function da(){return(da=(0,S.Z)(function*(c,o){return Ze(c,"GET","/v2/recaptchaConfig",Fe(c,o))})).apply(this,arguments)}function pc(c){return void 0!==c&&void 0!==c.getResponse}function mc(c){return void 0!==c&&void 0!==c.enterprise}class fa{constructor(o){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===o.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=o.recaptchaKey.split("/")[3],this.emailPasswordEnabled=o.recaptchaEnforcementState.some(u=>"EMAIL_PASSWORD_PROVIDER"===u.provider&&"OFF"!==u.enforcementState)}}function pa(c){return new Promise((o,u)=>{const l=document.createElement("script");l.setAttribute("src",c),l.onload=o,l.onerror=p=>{const g=Ce("internal-error");g.customData=p,u(g)},l.type="text/javascript",l.charset="UTF-8",function bh(){var c,o;return null!==(o=null===(c=document.getElementsByTagName("head"))||void 0===c?void 0:c[0])&&void 0!==o?o:document}().appendChild(l)})}function gc(c){return`__${c}${Math.floor(1e6*Math.random())}`}class ga{constructor(o){this.type="recaptcha-enterprise",this.auth=Ue(o)}verify(o="verify",u=!1){var l=this;return(0,S.Z)(function*(){function g(){return g=(0,S.Z)(function*(x){if(!u){if(null==x.tenantId&&null!=x._agentRecaptchaConfig)return x._agentRecaptchaConfig.siteKey;if(null!=x.tenantId&&void 0!==x._tenantRecaptchaConfigs[x.tenantId])return x._tenantRecaptchaConfigs[x.tenantId].siteKey}return new Promise(function(){var F=(0,S.Z)(function*(B,K){ws(x,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(W=>{if(void 0!==W.recaptchaKey){const he=new fa(W);return null==x.tenantId?x._agentRecaptchaConfig=he:x._tenantRecaptchaConfigs[x.tenantId]=he,B(he.siteKey)}K(new Error("recaptcha Enterprise site key undefined"))}).catch(W=>{K(W)})});return function(B,K){return F.apply(this,arguments)}}())}),g.apply(this,arguments)}function A(x,F,B){const K=window.grecaptcha;mc(K)?K.enterprise.ready(()=>{K.enterprise.execute(x,{action:o}).then(W=>{F(W)}).catch(()=>{F("NO_RECAPTCHA")})}):B(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((x,F)=>{(function p(x){return g.apply(this,arguments)})(l.auth).then(B=>{if(!u&&mc(window.grecaptcha))A(B,x,F);else{if(typeof window>"u")return void F(new Error("RecaptchaVerifier is only supported in browser"));pa("https://www.google.com/recaptcha/enterprise.js?render="+B).then(()=>{A(B,x,F)}).catch(K=>{F(K)})}}).catch(B=>{F(B)})})})()}}function _n(c,o,u){return pr.apply(this,arguments)}function pr(){return(pr=(0,S.Z)(function*(c,o,u,l=!1){const p=new ga(c);let g;try{g=yield p.verify(u)}catch{g=yield p.verify(u,!0)}const A=Object.assign({},o);return Object.assign(A,l?{captchaResp:g}:{captchaResponse:g}),Object.assign(A,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(A,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),A})).apply(this,arguments)}class _a{constructor(o){this.auth=o,this.queue=[]}pushCallback(o,u){const l=g=>new Promise((A,x)=>{try{A(o(g))}catch(F){x(F)}});l.onAbort=u,this.queue.push(l);const p=this.queue.length-1;return()=>{this.queue[p]=()=>Promise.resolve()}}runMiddleware(o){var u=this;return(0,S.Z)(function*(){if(u.auth.currentUser===o)return;const l=[];try{for(const p of u.queue)yield p(o),p.onAbort&&l.push(p.onAbort)}catch(p){l.reverse();for(const g of l)try{g()}catch{}throw u.auth._errorFactory.create("login-blocked",{originalMessage:null==p?void 0:p.message})}})()}}class ya{constructor(o,u,l,p){this.app=o,this.heartbeatServiceProvider=u,this.appCheckServiceProvider=l,this.config=p,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _c(this),this.idTokenSubscription=new _c(this),this.beforeStateQueue=new _a(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=L,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=o.name,this.clientVersion=p.sdkClientVersion}_initializeWithPersistence(o,u){var l=this;return u&&(this._popupRedirectResolver=_t(u)),this._initializationPromise=this.queue((0,S.Z)(function*(){var p,g;if(!l._deleted&&(l.persistenceManager=yield mn.create(l,o),!l._deleted)){if(null!==(p=l._popupRedirectResolver)&&void 0!==p&&p._shouldInitProactively)try{yield l._popupRedirectResolver._initialize(l)}catch{}yield l.initializeCurrentUser(u),l.lastNotifiedUid=(null===(g=l.currentUser)||void 0===g?void 0:g.uid)||null,!l._deleted&&(l._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var o=this;return(0,S.Z)(function*(){if(o._deleted)return;const u=yield o.assertedPersistence.getCurrentUser();if(o.currentUser||u){if(o.currentUser&&u&&o.currentUser.uid===u.uid)return o._currentUser._assign(u),void(yield o.currentUser.getIdToken());yield o._updateCurrentUser(u,!0)}})()}initializeCurrentUser(o){var u=this;return(0,S.Z)(function*(){var l;const p=yield u.assertedPersistence.getCurrentUser();let g=p,A=!1;if(o&&u.config.authDomain){yield u.getOrInitRedirectPersistenceManager();const x=null===(l=u.redirectUser)||void 0===l?void 0:l._redirectEventId,F=null==g?void 0:g._redirectEventId,B=yield u.tryRedirectSignIn(o);(!x||x===F)&&null!=B&&B.user&&(g=B.user,A=!0)}if(!g)return u.directlySetCurrentUser(null);if(!g._redirectEventId){if(A)try{yield u.beforeStateQueue.runMiddleware(g)}catch(x){g=p,u._popupRedirectResolver._overrideRedirectResult(u,()=>Promise.reject(x))}return g?u.reloadAndSetCurrentUserOrClear(g):u.directlySetCurrentUser(null)}return V(u._popupRedirectResolver,u,"argument-error"),yield u.getOrInitRedirectPersistenceManager(),u.redirectUser&&u.redirectUser._redirectEventId===g._redirectEventId?u.directlySetCurrentUser(g):u.reloadAndSetCurrentUserOrClear(g)})()}tryRedirectSignIn(o){var u=this;return(0,S.Z)(function*(){let l=null;try{l=yield u._popupRedirectResolver._completeRedirectFn(u,o,!0)}catch{yield u._setRedirectUser(null)}return l})()}reloadAndSetCurrentUserOrClear(o){var u=this;return(0,S.Z)(function*(){try{yield Fn(o)}catch(l){if("auth/network-request-failed"!==(null==l?void 0:l.code))return u.directlySetCurrentUser(null)}return u.directlySetCurrentUser(o)})()}useDeviceLanguage(){this.languageCode=function Jo(){if(typeof navigator>"u")return null;const c=navigator;return c.languages&&c.languages[0]||c.language||null}()}_delete(){var o=this;return(0,S.Z)(function*(){o._deleted=!0})()}updateCurrentUser(o){var u=this;return(0,S.Z)(function*(){const l=o?(0,I.m9)(o):null;return l&&V(l.auth.config.apiKey===u.config.apiKey,u,"invalid-user-token"),u._updateCurrentUser(l&&l._clone(u))})()}_updateCurrentUser(o,u=!1){var l=this;return(0,S.Z)(function*(){if(!l._deleted)return o&&V(l.tenantId===o.tenantId,l,"tenant-id-mismatch"),u||(yield l.beforeStateQueue.runMiddleware(o)),l.queue((0,S.Z)(function*(){yield l.directlySetCurrentUser(o),l.notifyAuthListeners()}))})()}signOut(){var o=this;return(0,S.Z)(function*(){return yield o.beforeStateQueue.runMiddleware(null),(o.redirectPersistenceManager||o._popupRedirectResolver)&&(yield o._setRedirectUser(null)),o._updateCurrentUser(null,!0)})()}setPersistence(o){var u=this;return this.queue((0,S.Z)(function*(){yield u.assertedPersistence.setPersistence(_t(o))}))}initializeRecaptchaConfig(){var o=this;return(0,S.Z)(function*(){const u=yield ws(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),l=new fa(u);null==o.tenantId?o._agentRecaptchaConfig=l:o._tenantRecaptchaConfigs[o.tenantId]=l,l.emailPasswordEnabled&&new ga(o).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(o){this._errorFactory=new I.LL("auth","Firebase",o())}onAuthStateChanged(o,u,l){return this.registerStateListener(this.authStateSubscription,o,u,l)}beforeAuthStateChanged(o,u){return this.beforeStateQueue.pushCallback(o,u)}onIdTokenChanged(o,u,l){return this.registerStateListener(this.idTokenSubscription,o,u,l)}toJSON(){var o;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(o=this._currentUser)||void 0===o?void 0:o.toJSON()}}_setRedirectUser(o,u){var l=this;return(0,S.Z)(function*(){const p=yield l.getOrInitRedirectPersistenceManager(u);return null===o?p.removeCurrentUser():p.setCurrentUser(o)})()}getOrInitRedirectPersistenceManager(o){var u=this;return(0,S.Z)(function*(){if(!u.redirectPersistenceManager){const l=o&&_t(o)||u._popupRedirectResolver;V(l,u,"argument-error"),u.redirectPersistenceManager=yield mn.create(u,[_t(l._redirectPersistence)],"redirectUser"),u.redirectUser=yield u.redirectPersistenceManager.getCurrentUser()}return u.redirectPersistenceManager})()}_redirectUserForId(o){var u=this;return(0,S.Z)(function*(){var l,p;return u._isInitialized&&(yield u.queue((0,S.Z)(function*(){}))),(null===(l=u._currentUser)||void 0===l?void 0:l._redirectEventId)===o?u._currentUser:(null===(p=u.redirectUser)||void 0===p?void 0:p._redirectEventId)===o?u.redirectUser:null})()}_persistUserIfCurrent(o){var u=this;return(0,S.Z)(function*(){if(o===u.currentUser)return u.queue((0,S.Z)(function*(){return u.directlySetCurrentUser(o)}))})()}_notifyListenersIfCurrent(o){o===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var o,u;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const l=null!==(u=null===(o=this.currentUser)||void 0===o?void 0:o.uid)&&void 0!==u?u:null;this.lastNotifiedUid!==l&&(this.lastNotifiedUid=l,this.authStateSubscription.next(this.currentUser))}registerStateListener(o,u,l,p){if(this._deleted)return()=>{};const g="function"==typeof u?u:u.next.bind(u),A=this._isInitialized?Promise.resolve():this._initializationPromise;return V(A,this,"internal-error"),A.then(()=>g(this.currentUser)),"function"==typeof u?o.addObserver(u,l,p):o.addObserver(u)}directlySetCurrentUser(o){var u=this;return(0,S.Z)(function*(){u.currentUser&&u.currentUser!==o&&u._currentUser._stopProactiveRefresh(),o&&u.isProactiveRefreshEnabled&&o._startProactiveRefresh(),u.currentUser=o,o?yield u.assertedPersistence.setCurrentUser(o):yield u.assertedPersistence.removeCurrentUser()})()}queue(o){return this.operations=this.operations.then(o,o),this.operations}get assertedPersistence(){return V(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(o){!o||this.frameworks.includes(o)||(this.frameworks.push(o),this.frameworks.sort(),this.clientVersion=Ke(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var o=this;return(0,S.Z)(function*(){var u;const l={"X-Client-Version":o.clientVersion};o.app.options.appId&&(l["X-Firebase-gmpid"]=o.app.options.appId);const p=yield null===(u=o.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===u?void 0:u.getHeartbeatsHeader();p&&(l["X-Firebase-Client"]=p);const g=yield o._getAppCheckToken();return g&&(l["X-Firebase-AppCheck"]=g),l})()}_getAppCheckToken(){var o=this;return(0,S.Z)(function*(){var u;const l=yield null===(u=o.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===u?void 0:u.getToken();return null!=l&&l.error&&function ce(c,...o){Q.logLevel<=te.in.WARN&&Q.warn(`Auth (${P.SDK_VERSION}): ${c}`,...o)}(`Error while retrieving App Check token: ${l.error}`),null==l?void 0:l.token})()}}function Ue(c){return(0,I.m9)(c)}class _c{constructor(o){this.auth=o,this.observer=null,this.addObserver=(0,I.ne)(u=>this.observer=u)}get next(){return V(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ia(c){const o=c.indexOf(":");return o<0?"":c.substr(0,o+1)}function vc(c){if(!c)return null;const o=Number(c);return isNaN(o)?null:o}class Bt{constructor(o,u){this.providerId=o,this.signInMethod=u}toJSON(){return lt("not implemented")}_getIdTokenResponse(o){return lt("not implemented")}_linkToIdToken(o,u){return lt("not implemented")}_getReauthenticationResolver(o){return lt("not implemented")}}function Ic(c,o){return wa.apply(this,arguments)}function wa(){return(wa=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:resetPassword",Fe(c,o))})).apply(this,arguments)}function yn(c,o){return Es.apply(this,arguments)}function Es(){return(Es=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Ss(){return(Ss=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:update",Fe(c,o))})).apply(this,arguments)}function Vn(c,o){return bs.apply(this,arguments)}function bs(){return(bs=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithPassword",Fe(c,o))})).apply(this,arguments)}function rt(c,o){return xs.apply(this,arguments)}function xs(){return(xs=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:sendOobCode",Fe(c,o))})).apply(this,arguments)}function mr(){return(mr=(0,S.Z)(function*(c,o){return rt(c,o)})).apply(this,arguments)}function ks(c,o){return si.apply(this,arguments)}function si(){return(si=(0,S.Z)(function*(c,o){return rt(c,o)})).apply(this,arguments)}function Cs(c,o){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,S.Z)(function*(c,o){return rt(c,o)})).apply(this,arguments)}function ai(){return(ai=(0,S.Z)(function*(c,o){return rt(c,o)})).apply(this,arguments)}function ui(){return(ui=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithEmailLink",Fe(c,o))})).apply(this,arguments)}function qn(){return(qn=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithEmailLink",Fe(c,o))})).apply(this,arguments)}class gr extends Bt{constructor(o,u,l,p=null){super("password",l),this._email=o,this._password=u,this._tenantId=p}static _fromEmailAndPassword(o,u){return new gr(o,u,"password")}static _fromEmailAndCode(o,u,l=null){return new gr(o,u,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(o){const u="string"==typeof o?JSON.parse(o):o;if(null!=u&&u.email&&null!=u&&u.password){if("password"===u.signInMethod)return this._fromEmailAndPassword(u.email,u.password);if("emailLink"===u.signInMethod)return this._fromEmailAndCode(u.email,u.password,u.tenantId)}return null}_getIdTokenResponse(o){var u=this;return(0,S.Z)(function*(){var l;switch(u.signInMethod){case"password":const p={returnSecureToken:!0,email:u._email,password:u._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(l=o._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const g=yield _n(o,p,"signInWithPassword");return Vn(o,g)}return Vn(o,p).catch(function(){var g=(0,S.Z)(function*(A){if("auth/missing-recaptcha-token"===A.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const x=yield _n(o,p,"signInWithPassword");return Vn(o,x)}return Promise.reject(A)});return function(A){return g.apply(this,arguments)}}());case"emailLink":return function Ta(c,o){return ui.apply(this,arguments)}(o,{email:u._email,oobCode:u._password});default:Ee(o,"internal-error")}})()}_linkToIdToken(o,u){var l=this;return(0,S.Z)(function*(){switch(l.signInMethod){case"password":return yn(o,{idToken:u,returnSecureToken:!0,email:l._email,password:l._password});case"emailLink":return function Rs(c,o){return qn.apply(this,arguments)}(o,{idToken:u,email:l._email,oobCode:l._password});default:Ee(o,"internal-error")}})()}_getReauthenticationResolver(o){return this._getIdTokenResponse(o)}}function tn(c,o){return ci.apply(this,arguments)}function ci(){return(ci=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithIdp",Fe(c,o))})).apply(this,arguments)}class Rt extends Bt{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(o){const u=new Rt(o.providerId,o.signInMethod);return o.idToken||o.accessToken?(o.idToken&&(u.idToken=o.idToken),o.accessToken&&(u.accessToken=o.accessToken),o.nonce&&!o.pendingToken&&(u.nonce=o.nonce),o.pendingToken&&(u.pendingToken=o.pendingToken)):o.oauthToken&&o.oauthTokenSecret?(u.accessToken=o.oauthToken,u.secret=o.oauthTokenSecret):Ee("argument-error"),u}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(o){const u="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:p}=u,g=(0,E._T)(u,["providerId","signInMethod"]);if(!l||!p)return null;const A=new Rt(l,p);return A.idToken=g.idToken||void 0,A.accessToken=g.accessToken||void 0,A.secret=g.secret,A.nonce=g.nonce,A.pendingToken=g.pendingToken||null,A}_getIdTokenResponse(o){return tn(o,this.buildRequest())}_linkToIdToken(o,u){const l=this.buildRequest();return l.idToken=u,tn(o,l)}_getReauthenticationResolver(o){const u=this.buildRequest();return u.autoCreate=!1,tn(o,u)}buildRequest(){const o={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)o.pendingToken=this.pendingToken;else{const u={};this.idToken&&(u.id_token=this.idToken),this.accessToken&&(u.access_token=this.accessToken),this.secret&&(u.oauth_token_secret=this.secret),u.providerId=this.providerId,this.nonce&&!this.pendingToken&&(u.nonce=this.nonce),o.postBody=(0,I.xO)(u)}return o}}function Ps(){return(Ps=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:sendVerificationCode",Fe(c,o))})).apply(this,arguments)}function Ea(){return(Ea=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithPhoneNumber",Fe(c,o))})).apply(this,arguments)}function Os(){return(Os=(0,S.Z)(function*(c,o){const u=yield Ne(c,"POST","/v1/accounts:signInWithPhoneNumber",Fe(c,o));if(u.temporaryProof)throw On(c,"account-exists-with-different-credential",u);return u})).apply(this,arguments)}const Ms={USER_NOT_FOUND:"user-not-found"};function nn(){return(nn=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithPhoneNumber",Fe(c,Object.assign(Object.assign({},o),{operation:"REAUTH"})),Ms)})).apply(this,arguments)}class rn extends Bt{constructor(o){super("phone","phone"),this.params=o}static _fromVerification(o,u){return new rn({verificationId:o,verificationCode:u})}static _fromTokenResponse(o,u){return new rn({phoneNumber:o,temporaryProof:u})}_getIdTokenResponse(o){return function Tc(c,o){return Ea.apply(this,arguments)}(o,this._makeVerificationRequest())}_linkToIdToken(o,u){return function li(c,o){return Os.apply(this,arguments)}(o,Object.assign({idToken:u},this._makeVerificationRequest()))}_getReauthenticationResolver(o){return function hi(c,o){return nn.apply(this,arguments)}(o,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:o,phoneNumber:u,verificationId:l,verificationCode:p}=this.params;return o&&u?{temporaryProof:o,phoneNumber:u}:{sessionInfo:l,code:p}}toJSON(){const o={providerId:this.providerId};return this.params.phoneNumber&&(o.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(o.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(o.verificationCode=this.params.verificationCode),this.params.verificationId&&(o.verificationId=this.params.verificationId),o}static fromJSON(o){"string"==typeof o&&(o=JSON.parse(o));const{verificationId:u,verificationCode:l,phoneNumber:p,temporaryProof:g}=o;return l||u||p||g?new rn({verificationId:u,verificationCode:l,phoneNumber:p,temporaryProof:g}):null}}class _r{constructor(o){var u,l,p,g,A,x;const F=(0,I.zd)((0,I.pd)(o)),B=null!==(u=F.apiKey)&&void 0!==u?u:null,K=null!==(l=F.oobCode)&&void 0!==l?l:null,W=function kh(c){switch(c){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(p=F.mode)&&void 0!==p?p:null);V(B&&K&&W,"argument-error"),this.apiKey=B,this.operation=W,this.code=K,this.continueUrl=null!==(g=F.continueUrl)&&void 0!==g?g:null,this.languageCode=null!==(A=F.languageCode)&&void 0!==A?A:null,this.tenantId=null!==(x=F.tenantId)&&void 0!==x?x:null}static parseLink(o){const u=function Ch(c){const o=(0,I.zd)((0,I.pd)(c)).link,u=o?(0,I.zd)((0,I.pd)(o)).deep_link_id:null,l=(0,I.zd)((0,I.pd)(c)).deep_link_id;return(l?(0,I.zd)((0,I.pd)(l)).link:null)||l||u||o||c}(o);try{return new _r(u)}catch{return null}}}let Aa=(()=>{class c{constructor(){this.providerId=c.PROVIDER_ID}static credential(u,l){return gr._fromEmailAndPassword(u,l)}static credentialWithLink(u,l){const p=_r.parseLink(l);return V(p,"argument-error"),gr._fromEmailAndCode(u,p.code,p.tenantId)}}return c.PROVIDER_ID="password",c.EMAIL_PASSWORD_SIGN_IN_METHOD="password",c.EMAIL_LINK_SIGN_IN_METHOD="emailLink",c})();class dt{constructor(o){this.providerId=o,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(o){this.defaultLanguageCode=o}setCustomParameters(o){return this.customParameters=o,this}getCustomParameters(){return this.customParameters}}class yt extends dt{constructor(){super(...arguments),this.scopes=[]}addScope(o){return this.scopes.includes(o)||this.scopes.push(o),this}getScopes(){return[...this.scopes]}}class sn extends yt{static credentialFromJSON(o){const u="string"==typeof o?JSON.parse(o):o;return V("providerId"in u&&"signInMethod"in u,"argument-error"),Rt._fromParams(u)}credential(o){return this._credential(Object.assign(Object.assign({},o),{nonce:o.rawNonce}))}_credential(o){return V(o.idToken||o.accessToken,"argument-error"),Rt._fromParams(Object.assign(Object.assign({},o),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(o){return sn.oauthCredentialFromTaggedObject(o)}static credentialFromError(o){return sn.oauthCredentialFromTaggedObject(o.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{oauthIdToken:u,oauthAccessToken:l,oauthTokenSecret:p,pendingToken:g,nonce:A,providerId:x}=o;if(!l&&!p&&!u&&!g||!x)return null;try{return new sn(x)._credential({idToken:u,accessToken:l,nonce:A,pendingToken:g})}catch{return null}}}let di=(()=>{class c extends yt{constructor(){super("facebook.com")}static credential(u){return Rt._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.FACEBOOK_SIGN_IN_METHOD,accessToken:u})}static credentialFromResult(u){return c.credentialFromTaggedObject(u)}static credentialFromError(u){return c.credentialFromTaggedObject(u.customData||{})}static credentialFromTaggedObject({_tokenResponse:u}){if(!u||!("oauthAccessToken"in u)||!u.oauthAccessToken)return null;try{return c.credential(u.oauthAccessToken)}catch{return null}}}return c.FACEBOOK_SIGN_IN_METHOD="facebook.com",c.PROVIDER_ID="facebook.com",c})(),Sa=(()=>{class c extends yt{constructor(){super("google.com"),this.addScope("profile")}static credential(u,l){return Rt._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GOOGLE_SIGN_IN_METHOD,idToken:u,accessToken:l})}static credentialFromResult(u){return c.credentialFromTaggedObject(u)}static credentialFromError(u){return c.credentialFromTaggedObject(u.customData||{})}static credentialFromTaggedObject({_tokenResponse:u}){if(!u)return null;const{oauthIdToken:l,oauthAccessToken:p}=u;if(!l&&!p)return null;try{return c.credential(l,p)}catch{return null}}}return c.GOOGLE_SIGN_IN_METHOD="google.com",c.PROVIDER_ID="google.com",c})(),Re=(()=>{class c extends yt{constructor(){super("github.com")}static credential(u){return Rt._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.GITHUB_SIGN_IN_METHOD,accessToken:u})}static credentialFromResult(u){return c.credentialFromTaggedObject(u)}static credentialFromError(u){return c.credentialFromTaggedObject(u.customData||{})}static credentialFromTaggedObject({_tokenResponse:u}){if(!u||!("oauthAccessToken"in u)||!u.oauthAccessToken)return null;try{return c.credential(u.oauthAccessToken)}catch{return null}}}return c.GITHUB_SIGN_IN_METHOD="github.com",c.PROVIDER_ID="github.com",c})();class Ht extends Bt{constructor(o,u){super(o,o),this.pendingToken=u}_getIdTokenResponse(o){return tn(o,this.buildRequest())}_linkToIdToken(o,u){const l=this.buildRequest();return l.idToken=u,tn(o,l)}_getReauthenticationResolver(o){const u=this.buildRequest();return u.autoCreate=!1,tn(o,u)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(o){const u="string"==typeof o?JSON.parse(o):o,{providerId:l,signInMethod:p,pendingToken:g}=u;return l&&p&&g&&l===p?new Ht(l,g):null}static _create(o,u){return new Ht(o,u)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Fs extends dt{constructor(o){V(o.startsWith("saml."),"argument-error"),super(o)}static credentialFromResult(o){return Fs.samlCredentialFromTaggedObject(o)}static credentialFromError(o){return Fs.samlCredentialFromTaggedObject(o.customData||{})}static credentialFromJSON(o){const u=Ht.fromJSON(o);return V(u,"argument-error"),u}static samlCredentialFromTaggedObject({_tokenResponse:o}){if(!o)return null;const{pendingToken:u,providerId:l}=o;if(!u||!l)return null;try{return Ht._create(l,u)}catch{return null}}}let ba=(()=>{class c extends yt{constructor(){super("twitter.com")}static credential(u,l){return Rt._fromParams({providerId:c.PROVIDER_ID,signInMethod:c.TWITTER_SIGN_IN_METHOD,oauthToken:u,oauthTokenSecret:l})}static credentialFromResult(u){return c.credentialFromTaggedObject(u)}static credentialFromError(u){return c.credentialFromTaggedObject(u.customData||{})}static credentialFromTaggedObject({_tokenResponse:u}){if(!u)return null;const{oauthAccessToken:l,oauthTokenSecret:p}=u;if(!l||!p)return null;try{return c.credential(l,p)}catch{return null}}}return c.TWITTER_SIGN_IN_METHOD="twitter.com",c.PROVIDER_ID="twitter.com",c})();function Us(c,o){return xa.apply(this,arguments)}function xa(){return(xa=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signUp",Fe(c,o))})).apply(this,arguments)}class Dt{constructor(o){this.user=o.user,this.providerId=o.providerId,this._tokenResponse=o._tokenResponse,this.operationType=o.operationType}static _fromIdTokenResponse(o,u,l,p=!1){return(0,S.Z)(function*(){const g=yield en._fromIdTokenResponse(o,l,p),A=Ec(l);return new Dt({user:g,providerId:A,_tokenResponse:l,operationType:u})})()}static _forOperation(o,u,l){return(0,S.Z)(function*(){yield o._updateTokensIfNecessary(l,!0);const p=Ec(l);return new Dt({user:o,providerId:p,_tokenResponse:l,operationType:u})})()}}function Ec(c){return c.providerId?c.providerId:"phoneNumber"in c?"phone":null}function Kt(){return(Kt=(0,S.Z)(function*(c){var o;const u=Ue(c);if(yield u._initializationPromise,null!==(o=u.currentUser)&&void 0!==o&&o.isAnonymous)return new Dt({user:u.currentUser,providerId:null,operationType:"signIn"});const l=yield Us(u,{returnSecureToken:!0}),p=yield Dt._fromIdTokenResponse(u,"signIn",l,!0);return yield u._updateCurrentUser(p.user),p})).apply(this,arguments)}class mi extends I.ZR{constructor(o,u,l,p){var g;super(u.code,u.message),this.operationType=l,this.user=p,Object.setPrototypeOf(this,mi.prototype),this.customData={appName:o.name,tenantId:null!==(g=o.tenantId)&&void 0!==g?g:void 0,_serverResponse:u.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(o,u,l,p){return new mi(o,u,l,p)}}function ka(c,o,u,l){return("reauthenticate"===o?u._getReauthenticationResolver(c):u._getIdTokenResponse(c)).catch(g=>{throw"auth/multi-factor-auth-required"===g.code?mi._fromErrorAndOperation(c,g,o,l):g})}function Ca(c){return new Set(c.map(({providerId:o})=>o).filter(o=>!!o))}function Na(){return Na=(0,S.Z)(function*(c,o){const u=(0,I.m9)(c);yield qs(!0,u,o);const{providerUserInfo:l}=yield function wh(c,o){return Mn.apply(this,arguments)}(u.auth,{idToken:yield u.getIdToken(),deleteProvider:[o]}),p=Ca(l||[]);return u.providerData=u.providerData.filter(g=>p.has(g.providerId)),p.has("phone")||(u.phoneNumber=null),yield u.auth._persistUserIfCurrent(u),u}),Na.apply(this,arguments)}function Ra(c,o){return Vs.apply(this,arguments)}function Vs(){return(Vs=(0,S.Z)(function*(c,o,u=!1){const l=yield Jt(c,o._linkToIdToken(c.auth,yield c.getIdToken()),u);return Dt._forOperation(c,"link",l)})).apply(this,arguments)}function qs(c,o,u){return Bs.apply(this,arguments)}function Bs(){return(Bs=(0,S.Z)(function*(c,o,u){yield Fn(o);const p=!1===c?"provider-already-linked":"no-such-provider";V(Ca(o.providerData).has(u)===c,o.auth,p)})).apply(this,arguments)}function Da(c,o){return gi.apply(this,arguments)}function gi(){return(gi=(0,S.Z)(function*(c,o,u=!1){const{auth:l}=c,p="reauthenticate";try{const g=yield Jt(c,ka(l,p,o,c),u);V(g.idToken,l,"internal-error");const A=dr(g.idToken);V(A,l,"internal-error");const{sub:x}=A;return V(c.uid===x,l,"user-mismatch"),Dt._forOperation(c,p,g)}catch(g){throw"auth/user-not-found"===(null==g?void 0:g.code)&&Ee(l,"user-mismatch"),g}})).apply(this,arguments)}function Gs(c,o){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,S.Z)(function*(c,o,u=!1){const l="signIn",p=yield ka(c,l,o),g=yield Dt._fromIdTokenResponse(c,l,p);return u||(yield c._updateCurrentUser(g.user)),g})).apply(this,arguments)}function _i(c,o){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,S.Z)(function*(c,o){return Gs(Ue(c),o)})).apply(this,arguments)}function Ac(c,o){return Oa.apply(this,arguments)}function Oa(){return(Oa=(0,S.Z)(function*(c,o){const u=(0,I.m9)(c);return yield qs(!1,u,o.providerId),Ra(u,o)})).apply(this,arguments)}function Sc(c,o){return vr.apply(this,arguments)}function vr(){return(vr=(0,S.Z)(function*(c,o){return Da((0,I.m9)(c),o)})).apply(this,arguments)}function Ir(){return(Ir=(0,S.Z)(function*(c,o){return Ne(c,"POST","/v1/accounts:signInWithCustomToken",Fe(c,o))})).apply(this,arguments)}function zs(){return zs=(0,S.Z)(function*(c,o){const u=Ue(c),l=yield function yi(c,o){return Ir.apply(this,arguments)}(u,{token:o,returnSecureToken:!0}),p=yield Dt._fromIdTokenResponse(u,"signIn",l);return yield u._updateCurrentUser(p.user),p}),zs.apply(this,arguments)}class on{constructor(o,u){this.factorId=o,this.uid=u.mfaEnrollmentId,this.enrollmentTime=new Date(u.enrolledAt).toUTCString(),this.displayName=u.displayName}static _fromServerResponse(o,u){return"phoneInfo"in u?Bn._fromServerResponse(o,u):"totpInfo"in u?La._fromServerResponse(o,u):Ee(o,"internal-error")}}class Bn extends on{constructor(o){super("phone",o),this.phoneNumber=o.phoneInfo}static _fromServerResponse(o,u){return new Bn(u)}}class La extends on{constructor(o){super("totp",o)}static _fromServerResponse(o,u){return new La(u)}}function Se(c,o,u){var l;V((null===(l=u.url)||void 0===l?void 0:l.length)>0,c,"invalid-continue-uri"),V(typeof u.dynamicLinkDomain>"u"||u.dynamicLinkDomain.length>0,c,"invalid-dynamic-link-domain"),o.continueUrl=u.url,o.dynamicLinkDomain=u.dynamicLinkDomain,o.canHandleCodeInApp=u.handleCodeInApp,u.iOS&&(V(u.iOS.bundleId.length>0,c,"missing-ios-bundle-id"),o.iOSBundleId=u.iOS.bundleId),u.android&&(V(u.android.packageName.length>0,c,"missing-android-pkg-name"),o.androidInstallApp=u.android.installApp,o.androidMinimumVersionCode=u.android.minimumVersion,o.androidPackageName=u.android.packageName)}function Fa(){return Fa=(0,S.Z)(function*(c,o,u){var l;const p=Ue(c),g={requestType:"PASSWORD_RESET",email:o,clientType:"CLIENT_TYPE_WEB"};if(null!==(l=p._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const A=yield _n(p,g,"getOobCode",!0);u&&Se(p,A,u),yield ks(p,A)}else u&&Se(p,g,u),yield ks(p,g).catch(function(){var A=(0,S.Z)(function*(x){if("auth/missing-recaptcha-token"!==x.code)return Promise.reject(x);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const F=yield _n(p,g,"getOobCode",!0);u&&Se(p,F,u),yield ks(p,F)}});return function(x){return A.apply(this,arguments)}}())}),Fa.apply(this,arguments)}function Ua(){return(Ua=(0,S.Z)(function*(c,o,u){yield Ic((0,I.m9)(c),{oobCode:o,newPassword:u})})).apply(this,arguments)}function $s(){return $s=(0,S.Z)(function*(c,o){yield function As(c,o){return Ss.apply(this,arguments)}((0,I.m9)(c),{oobCode:o})}),$s.apply(this,arguments)}function Va(c,o){return wr.apply(this,arguments)}function wr(){return(wr=(0,S.Z)(function*(c,o){const u=(0,I.m9)(c),l=yield Ic(u,{oobCode:o}),p=l.requestType;switch(V(p,u,"internal-error"),p){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":V(l.newEmail,u,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":V(l.mfaInfo,u,"internal-error");default:V(l.email,u,"internal-error")}let g=null;return l.mfaInfo&&(g=on._fromServerResponse(Ue(u),l.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.newEmail:l.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===l.requestType?l.email:l.newEmail)||null,multiFactorInfo:g},operation:p}})).apply(this,arguments)}function Pt(){return(Pt=(0,S.Z)(function*(c,o){const{data:u}=yield Va((0,I.m9)(c),o);return u.email})).apply(this,arguments)}function qa(){return qa=(0,S.Z)(function*(c,o,u){var l;const p=Ue(c),g={returnSecureToken:!0,email:o,password:u,clientType:"CLIENT_TYPE_WEB"};let A;if(null!==(l=p._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const B=yield _n(p,g,"signUpPassword");A=Us(p,B)}else A=Us(p,g).catch(function(){var B=(0,S.Z)(function*(K){if("auth/missing-recaptcha-token"===K.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const W=yield _n(p,g,"signUpPassword");return Us(p,W)}return Promise.reject(K)});return function(K){return B.apply(this,arguments)}}());const x=yield A.catch(B=>Promise.reject(B)),F=yield Dt._fromIdTokenResponse(p,"signIn",x);return yield p._updateCurrentUser(F.user),F}),qa.apply(this,arguments)}function Gn(){return Gn=(0,S.Z)(function*(c,o,u){var l;const p=Ue(c),g={requestType:"EMAIL_SIGNIN",email:o,clientType:"CLIENT_TYPE_WEB"};function A(x,F){V(F.handleCodeInApp,p,"argument-error"),F&&Se(p,x,F)}if(null!==(l=p._getRecaptchaConfig())&&void 0!==l&&l.emailPasswordEnabled){const x=yield _n(p,g,"getOobCode",!0);A(x,u),yield Cs(p,x)}else A(g,u),yield Cs(p,g).catch(function(){var x=(0,S.Z)(function*(F){if("auth/missing-recaptcha-token"!==F.code)return Promise.reject(F);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const B=yield _n(p,g,"getOobCode",!0);A(B,u),yield Cs(p,B)}});return function(F){return x.apply(this,arguments)}}())}),Gn.apply(this,arguments)}function Tr(){return(Tr=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c),p=Aa.credentialWithLink(o,u||pe());return V(p._tenantId===(l.tenantId||null),l,"tenant-id-mismatch"),_i(l,p)})).apply(this,arguments)}function Er(){return(Er=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:createAuthUri",Fe(c,o))})).apply(this,arguments)}function js(){return js=(0,S.Z)(function*(c,o){const l={identifier:o,continueUri:zt()?pe():"http://localhost"},{signinMethods:p}=yield function Dc(c,o){return Er.apply(this,arguments)}((0,I.m9)(c),l);return p||[]}),js.apply(this,arguments)}function Hs(){return Hs=(0,S.Z)(function*(c,o){const u=(0,I.m9)(c),p={requestType:"VERIFY_EMAIL",idToken:yield c.getIdToken()};o&&Se(u.auth,p,o);const{email:g}=yield function ii(c,o){return mr.apply(this,arguments)}(u.auth,p);g!==c.email&&(yield c.reload())}),Hs.apply(this,arguments)}function Ii(){return Ii=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c),g={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield c.getIdToken(),newEmail:o};u&&Se(l.auth,g,u);const{email:A}=yield function oi(c,o){return ai.apply(this,arguments)}(l.auth,g);A!==c.email&&(yield c.reload())}),Ii.apply(this,arguments)}function Ks(){return(Ks=(0,S.Z)(function*(c,o){return Ze(c,"POST","/v1/accounts:update",o)})).apply(this,arguments)}function Qs(){return Qs=(0,S.Z)(function*(c,{displayName:o,photoURL:u}){if(void 0===o&&void 0===u)return;const l=(0,I.m9)(c),g={idToken:yield l.getIdToken(),displayName:o,photoUrl:u,returnSecureToken:!0},A=yield Jt(l,function Za(c,o){return Ks.apply(this,arguments)}(l.auth,g));l.displayName=A.displayName||null,l.photoURL=A.photoUrl||null;const x=l.providerData.find(({providerId:F})=>"password"===F);x&&(x.displayName=l.displayName,x.photoURL=l.photoURL),yield l._updateTokensIfNecessary(A)}),Qs.apply(this,arguments)}function za(c,o,u){return Ys.apply(this,arguments)}function Ys(){return(Ys=(0,S.Z)(function*(c,o,u){const{auth:l}=c,g={idToken:yield c.getIdToken(),returnSecureToken:!0};o&&(g.email=o),u&&(g.password=u);const A=yield Jt(c,yn(l,g));yield c._updateTokensIfNecessary(A,!0)})).apply(this,arguments)}class zn{constructor(o,u,l={}){this.isNewUser=o,this.providerId=u,this.profile=l}}class wi extends zn{constructor(o,u,l,p){super(o,u,l),this.username=p}}class St extends zn{constructor(o,u){super(o,"facebook.com",u)}}class Lc extends wi{constructor(o,u){super(o,"github.com",u,"string"==typeof(null==u?void 0:u.login)?null==u?void 0:u.login:null)}}class Fc extends zn{constructor(o,u){super(o,"google.com",u)}}class Ar extends wi{constructor(o,u,l){super(o,"twitter.com",u,l)}}function Ph(c){const{user:o,_tokenResponse:u}=c;return o.isAnonymous&&!u?{providerId:null,isNewUser:!1,profile:null}:function Mc(c){var o,u;if(!c)return null;const{providerId:l}=c,p=c.rawUserInfo?JSON.parse(c.rawUserInfo):{},g=c.isNewUser||"identitytoolkit#SignupNewUserResponse"===c.kind;if(!l&&null!=c&&c.idToken){const A=null===(u=null===(o=dr(c.idToken))||void 0===o?void 0:o.firebase)||void 0===u?void 0:u.sign_in_provider;if(A)return new zn(g,"anonymous"!==A&&"custom"!==A?A:null)}if(!l)return null;switch(l){case"facebook.com":return new St(g,p);case"github.com":return new Lc(g,p);case"google.com":return new Fc(g,p);case"twitter.com":return new Ar(g,p,c.screenName||null);case"custom":case"anonymous":return new zn(g,null);default:return new zn(g,l,p)}}(u)}class vn{constructor(o,u,l){this.type=o,this.credential=u,this.auth=l}static _fromIdtoken(o,u){return new vn("enroll",o,u)}static _fromMfaPendingCredential(o){return new vn("signin",o)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(o){var u,l;if(null!=o&&o.multiFactorSession){if(null!==(u=o.multiFactorSession)&&void 0!==u&&u.pendingCredential)return vn._fromMfaPendingCredential(o.multiFactorSession.pendingCredential);if(null!==(l=o.multiFactorSession)&&void 0!==l&&l.idToken)return vn._fromIdtoken(o.multiFactorSession.idToken)}return null}}class Gt{constructor(o,u,l){this.session=o,this.hints=u,this.signInResolver=l}static _fromError(o,u){const l=Ue(o),p=u.customData._serverResponse,g=(p.mfaInfo||[]).map(x=>on._fromServerResponse(l,x));V(p.mfaPendingCredential,l,"internal-error");const A=vn._fromMfaPendingCredential(p.mfaPendingCredential);return new Gt(A,g,function(){var x=(0,S.Z)(function*(F){const B=yield F._process(l,A);delete p.mfaInfo,delete p.mfaPendingCredential;const K=Object.assign(Object.assign({},p),{idToken:B.idToken,refreshToken:B.refreshToken});switch(u.operationType){case"signIn":const W=yield Dt._fromIdTokenResponse(l,u.operationType,K);return yield l._updateCurrentUser(W.user),W;case"reauthenticate":return V(u.user,l,"internal-error"),Dt._forOperation(u.user,u.operationType,K);default:Ee(l,"internal-error")}});return function(F){return x.apply(this,arguments)}}())}resolveSignIn(o){var u=this;return(0,S.Z)(function*(){return u.signInResolver(o)})()}}class eo{constructor(o){this.user=o,this.enrolledFactors=[],o._onReload(u=>{u.mfaInfo&&(this.enrolledFactors=u.mfaInfo.map(l=>on._fromServerResponse(o.auth,l)))})}static _fromUser(o){return new eo(o)}getSession(){var o=this;return(0,S.Z)(function*(){return vn._fromIdtoken(yield o.user.getIdToken(),o.user.auth)})()}enroll(o,u){var l=this;return(0,S.Z)(function*(){const p=o,g=yield l.getSession(),A=yield Jt(l.user,p._process(l.user.auth,g,u));return yield l.user._updateTokensIfNecessary(A),l.user.reload()})()}unenroll(o){var u=this;return(0,S.Z)(function*(){const l="string"==typeof o?o:o.uid,p=yield u.user.getIdToken();try{const g=yield Jt(u.user,function Js(c,o){return Ze(c,"POST","/v2/accounts/mfaEnrollment:withdraw",Fe(c,o))}(u.user.auth,{idToken:p,mfaEnrollmentId:l}));u.enrolledFactors=u.enrolledFactors.filter(({uid:A})=>A!==l),yield u.user._updateTokensIfNecessary(g),yield u.user.reload()}catch(g){throw g}})()}}const In=new WeakMap,to="__sak";class no{constructor(o,u){this.storageRetriever=o,this.type=u}_isAvailable(){try{return this.storage?(this.storage.setItem(to,"1"),this.storage.removeItem(to),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(o,u){return this.storage.setItem(o,JSON.stringify(u)),Promise.resolve()}_get(o){const u=this.storage.getItem(o);return Promise.resolve(u?JSON.parse(u):null)}_remove(o){return this.storage.removeItem(o),Promise.resolve()}get storage(){return this.storageRetriever()}}const $n=(()=>{class c extends no{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(u,l)=>this.onStorageEvent(u,l),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Fh(){const c=(0,I.z$)();return Jr(c)||gn(c)}()&&function ha(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Is(),this._shouldAllowMigration=!0}forAllChangedKeys(u){for(const l of Object.keys(this.listeners)){const p=this.storage.getItem(l),g=this.localCache[l];p!==g&&u(l,g,p)}}onStorageEvent(u,l=!1){if(!u.key)return void this.forAllChangedKeys((x,F,B)=>{this.notifyListeners(x,B)});const p=u.key;if(l?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const x=this.storage.getItem(p);if(u.newValue!==x)null!==u.newValue?this.storage.setItem(p,u.newValue):this.storage.removeItem(p);else if(this.localCache[p]===u.newValue&&!l)return}const g=()=>{const x=this.storage.getItem(p);!l&&this.localCache[p]===x||this.notifyListeners(p,x)},A=this.storage.getItem(p);!function la(){return(0,I.w1)()&&10===document.documentMode}()||A===u.newValue||u.newValue===u.oldValue?g():setTimeout(g,10)}notifyListeners(u,l){this.localCache[u]=l;const p=this.listeners[u];if(p)for(const g of Array.from(p))g(l&&JSON.parse(l))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((u,l,p)=>{this.onStorageEvent(new StorageEvent("storage",{key:u,oldValue:l,newValue:p}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(u,l){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[u]||(this.listeners[u]=new Set,this.localCache[u]=this.storage.getItem(u)),this.listeners[u].add(l)}_removeListener(u,l){this.listeners[u]&&(this.listeners[u].delete(l),0===this.listeners[u].size&&delete this.listeners[u]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(u,l){var p=()=>super._set,g=this;return(0,S.Z)(function*(){yield p().call(g,u,l),g.localCache[u]=JSON.stringify(l)})()}_get(u){var l=()=>super._get,p=this;return(0,S.Z)(function*(){const g=yield l().call(p,u);return p.localCache[u]=JSON.stringify(g),g})()}_remove(u){var l=()=>super._remove,p=this;return(0,S.Z)(function*(){yield l().call(p,u),delete p.localCache[u]})()}}return c.type="LOCAL",c})(),wn=(()=>{class c extends no{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(u,l){}_removeListener(u,l){}}return c.type="SESSION",c})();let Gc=(()=>{class c{constructor(u){this.eventTarget=u,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(u){const l=this.receivers.find(g=>g.isListeningto(u));if(l)return l;const p=new c(u);return this.receivers.push(p),p}isListeningto(u){return this.eventTarget===u}handleEvent(u){var l=this;return(0,S.Z)(function*(){const p=u,{eventId:g,eventType:A,data:x}=p.data,F=l.handlersMap[A];if(null==F||!F.size)return;p.ports[0].postMessage({status:"ack",eventId:g,eventType:A});const B=Array.from(F).map(function(){var W=(0,S.Z)(function*(he){return he(p.origin,x)});return function(he){return W.apply(this,arguments)}}()),K=yield function Sr(c){return Promise.all(c.map(function(){var o=(0,S.Z)(function*(u){try{return{fulfilled:!0,value:yield u}}catch(l){return{fulfilled:!1,reason:l}}});return function(u){return o.apply(this,arguments)}}()))}(B);p.ports[0].postMessage({status:"done",eventId:g,eventType:A,response:K})})()}_subscribe(u,l){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[u]||(this.handlersMap[u]=new Set),this.handlersMap[u].add(l)}_unsubscribe(u,l){this.handlersMap[u]&&l&&this.handlersMap[u].delete(l),(!l||0===this.handlersMap[u].size)&&delete this.handlersMap[u],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return c.receivers=[],c})();function ze(c="",o=10){let u="";for(let l=0;l<o;l++)u+=Math.floor(10*Math.random());return c+u}class br{constructor(o){this.target=o,this.handlers=new Set}removeMessageHandler(o){o.messageChannel&&(o.messageChannel.port1.removeEventListener("message",o.onMessage),o.messageChannel.port1.close()),this.handlers.delete(o)}_send(o,u,l=50){var p=this;return(0,S.Z)(function*(){const g=typeof MessageChannel<"u"?new MessageChannel:null;if(!g)throw new Error("connection_unavailable");let A,x;return new Promise((F,B)=>{const K=ze("",20);g.port1.start();const W=setTimeout(()=>{B(new Error("unsupported_event"))},l);x={messageChannel:g,onMessage(he){const le=he;if(le.data.eventId===K)switch(le.data.status){case"ack":clearTimeout(W),A=setTimeout(()=>{B(new Error("timeout"))},3e3);break;case"done":clearTimeout(A),F(le.data.response);break;default:clearTimeout(W),clearTimeout(A),B(new Error("invalid_response"))}}},p.handlers.add(x),g.port1.addEventListener("message",x.onMessage),p.target.postMessage({eventType:o,eventId:K,data:u},[g.port2])}).finally(()=>{x&&p.removeMessageHandler(x)})})()}}function be(){return window}function Ha(){return typeof be().WorkerGlobalScope<"u"&&"function"==typeof be().importScripts}function Ve(){return(Ve=(0,S.Z)(function*(){if(null==navigator||!navigator.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const H="firebaseLocalStorageDb",ro="firebaseLocalStorage",z="fbase_key";class N{constructor(o){this.request=o}toPromise(){return new Promise((o,u)=>{this.request.addEventListener("success",()=>{o(this.request.result)}),this.request.addEventListener("error",()=>{u(this.request.error)})})}}function M(c,o){return c.transaction([ro],o?"readwrite":"readonly").objectStore(ro)}function io(){const c=indexedDB.open(H,1);return new Promise((o,u)=>{c.addEventListener("error",()=>{u(c.error)}),c.addEventListener("upgradeneeded",()=>{const l=c.result;try{l.createObjectStore(ro,{keyPath:z})}catch(p){u(p)}}),c.addEventListener("success",(0,S.Z)(function*(){const l=c.result;l.objectStoreNames.contains(ro)?o(l):(l.close(),yield function We(){const c=indexedDB.deleteDatabase(H);return new N(c).toPromise()}(),o(yield io()))}))})}function Zc(c,o,u){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,S.Z)(function*(c,o,u){const l=M(c,!0).put({[z]:o,value:u});return new N(l).toPromise()})).apply(this,arguments)}function Qa(){return(Qa=(0,S.Z)(function*(c,o){const u=M(c,!1).get(o),l=yield new N(u).toPromise();return void 0===l?null:l.value})).apply(this,arguments)}function zc(c,o){const u=M(c,!0).delete(o);return new N(u).toPromise()}const xr=(()=>{class c{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var u=this;return(0,S.Z)(function*(){return u.db||(u.db=yield io()),u.db})()}_withRetries(u){var l=this;return(0,S.Z)(function*(){let p=0;for(;;)try{const g=yield l._openDb();return yield u(g)}catch(g){if(p++>3)throw g;l.db&&(l.db.close(),l.db=void 0)}})()}initializeServiceWorkerMessaging(){var u=this;return(0,S.Z)(function*(){return Ha()?u.initializeReceiver():u.initializeSender()})()}initializeReceiver(){var u=this;return(0,S.Z)(function*(){u.receiver=Gc._getInstance(function Ka(){return Ha()?self:null}()),u.receiver._subscribe("keyChanged",function(){var l=(0,S.Z)(function*(p,g){return{keyProcessed:(yield u._poll()).includes(g.key)}});return function(p,g){return l.apply(this,arguments)}}()),u.receiver._subscribe("ping",function(){var l=(0,S.Z)(function*(p,g){return["keyChanged"]});return function(p,g){return l.apply(this,arguments)}}())})()}initializeSender(){var u=this;return(0,S.Z)(function*(){var l,p;if(u.activeServiceWorker=yield function U(){return Ve.apply(this,arguments)}(),!u.activeServiceWorker)return;u.sender=new br(u.activeServiceWorker);const g=yield u.sender._send("ping",{},800);g&&null!==(l=g[0])&&void 0!==l&&l.fulfilled&&null!==(p=g[0])&&void 0!==p&&p.value.includes("keyChanged")&&(u.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(u){var l=this;return(0,S.Z)(function*(){if(l.sender&&l.activeServiceWorker&&function Mt(){var c;return(null===(c=null==navigator?void 0:navigator.serviceWorker)||void 0===c?void 0:c.controller)||null}()===l.activeServiceWorker)try{yield l.sender._send("keyChanged",{key:u},l.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,S.Z)(function*(){try{if(!indexedDB)return!1;const u=yield io();return yield Zc(u,to,"1"),yield zc(u,to),!0}catch{}return!1})()}_withPendingWrite(u){var l=this;return(0,S.Z)(function*(){l.pendingWrites++;try{yield u()}finally{l.pendingWrites--}})()}_set(u,l){var p=this;return(0,S.Z)(function*(){return p._withPendingWrite((0,S.Z)(function*(){return yield p._withRetries(g=>Zc(g,u,l)),p.localCache[u]=l,p.notifyServiceWorker(u)}))})()}_get(u){var l=this;return(0,S.Z)(function*(){const p=yield l._withRetries(g=>function Vh(c,o){return Qa.apply(this,arguments)}(g,u));return l.localCache[u]=p,p})()}_remove(u){var l=this;return(0,S.Z)(function*(){return l._withPendingWrite((0,S.Z)(function*(){return yield l._withRetries(p=>zc(p,u)),delete l.localCache[u],l.notifyServiceWorker(u)}))})()}_poll(){var u=this;return(0,S.Z)(function*(){const l=yield u._withRetries(A=>{const x=M(A,!1).getAll();return new N(x).toPromise()});if(!l)return[];if(0!==u.pendingWrites)return[];const p=[],g=new Set;for(const{fbase_key:A,value:x}of l)g.add(A),JSON.stringify(u.localCache[A])!==JSON.stringify(x)&&(u.notifyListeners(A,x),p.push(A));for(const A of Object.keys(u.localCache))u.localCache[A]&&!g.has(A)&&(u.notifyListeners(A,null),p.push(A));return p})()}notifyListeners(u,l){this.localCache[u]=l;const p=this.listeners[u];if(p)for(const g of Array.from(p))g(l)}startPolling(){var u=this;this.stopPolling(),this.pollTimer=setInterval((0,S.Z)(function*(){return u._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(u,l){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[u]||(this.listeners[u]=new Set,this._get(u)),this.listeners[u].add(l)}_removeListener(u,l){this.listeners[u]&&(this.listeners[u].delete(l),0===this.listeners[u].size&&delete this.listeners[u]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return c.type="LOCAL",c})(),Y=1e12;class Si{constructor(o){this.auth=o,this.counter=Y,this._widgets=new Map}render(o,u){const l=this.counter;return this._widgets.set(l,new _e(o,this.auth.name,u||{})),this.counter++,l}reset(o){var u;const l=o||Y;null===(u=this._widgets.get(l))||void 0===u||u.delete(),this._widgets.delete(l)}getResponse(o){var u;return(null===(u=this._widgets.get(o||Y))||void 0===u?void 0:u.getResponse())||""}execute(o){var u=this;return(0,S.Z)(function*(){var l;return null===(l=u._widgets.get(o||Y))||void 0===l||l.execute(),""})()}}class _e{constructor(o,u,l){this.params=l,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const p="string"==typeof o?document.getElementById(o):o;V(p,"argument-error",{appName:u}),this.container=p,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Bh(c){const o=[],u="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let l=0;l<c;l++)o.push(u.charAt(Math.floor(62*Math.random())));return o.join("")}(50);const{callback:o,"expired-callback":u}=this.params;if(o)try{o(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,u)try{u()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Me=gc("rcb"),Z=new se(3e4,6e4);class Ya{constructor(){var o;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(o=be().grecaptcha)||void 0===o||!o.render)}load(o,u=""){return V(function jn(c){return c.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(c)}(u),o,"argument-error"),this.shouldResolveImmediately(u)&&pc(be().grecaptcha)?Promise.resolve(be().grecaptcha):new Promise((l,p)=>{const g=be().setTimeout(()=>{p(Ce(o,"network-request-failed"))},Z.get());be()[Me]=()=>{be().clearTimeout(g),delete be()[Me];const x=be().grecaptcha;if(!x||!pc(x))return void p(Ce(o,"internal-error"));const F=x.render;x.render=(B,K)=>{const W=F(B,K);return this.counter++,W},this.hostLanguage=u,l(x)},pa(`https://www.google.com/recaptcha/api.js??${(0,I.xO)({onload:Me,render:"explicit",hl:u})}`).catch(()=>{clearTimeout(g),p(Ce(o,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(o){var u;return!(null===(u=be().grecaptcha)||void 0===u||!u.render)&&(o===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Gh{load(o){return(0,S.Z)(function*(){return new Si(o)})()}clearedOneInstance(){}}const bi="recaptcha",Zh={theme:"light",type:"image"};class xi{constructor(o,u=Object.assign({},Zh),l){this.parameters=u,this.type=bi,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ue(l),this.isInvisible="invisible"===this.parameters.size,V(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const p="string"==typeof o?document.getElementById(o):o;V(p,this.auth,"argument-error"),this.container=p,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Gh:new Ya,this.validateStartingState()}verify(){var o=this;return(0,S.Z)(function*(){o.assertNotDestroyed();const u=yield o.render(),l=o.getAssertedRecaptcha();return l.getResponse(u)||new Promise(g=>{const A=x=>{x&&(o.tokenChangeListeners.delete(A),g(x))};o.tokenChangeListeners.add(A),o.isInvisible&&l.execute(u)})})()}render(){try{this.assertNotDestroyed()}catch(o){return Promise.reject(o)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(o=>{throw this.renderPromise=null,o})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(o=>{this.container.removeChild(o)})}validateStartingState(){V(!this.parameters.sitekey,this.auth,"argument-error"),V(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),V(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(o){return u=>{if(this.tokenChangeListeners.forEach(l=>l(u)),"function"==typeof o)o(u);else if("string"==typeof o){const l=be()[o];"function"==typeof l&&l(u)}}}assertNotDestroyed(){V(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var o=this;return(0,S.Z)(function*(){if(yield o.init(),!o.widgetId){let u=o.container;if(!o.isInvisible){const l=document.createElement("div");u.appendChild(l),u=l}o.widgetId=o.getAssertedRecaptcha().render(u,o.parameters)}return o.widgetId})()}init(){var o=this;return(0,S.Z)(function*(){V(zt()&&!Ha(),o.auth,"internal-error"),yield function Kc(){let c=null;return new Promise(o=>{"complete"!==document.readyState?(c=()=>o(),window.addEventListener("load",c)):o()}).catch(o=>{throw c&&window.removeEventListener("load",c),o})}(),o.recaptcha=yield o._recaptchaLoader.load(o.auth,o.auth.languageCode||void 0);const u=yield function ot(c){return fr.apply(this,arguments)}(o.auth);V(u,o.auth,"internal-error"),o.parameters.sitekey=u})()}getAssertedRecaptcha(){return V(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class oo{constructor(o,u){this.verificationId=o,this.onConfirmation=u}confirm(o){const u=rn._fromVerification(this.verificationId,o);return this.onConfirmation(u)}}function ki(){return(ki=(0,S.Z)(function*(c,o,u){const l=Ue(c),p=yield C(l,o,(0,I.m9)(u));return new oo(p,g=>_i(l,g))})).apply(this,arguments)}function ao(){return(ao=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c);yield qs(!1,l,"phone");const p=yield C(l.auth,o,(0,I.m9)(u));return new oo(p,g=>Ac(l,g))})).apply(this,arguments)}function Ci(){return(Ci=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c),p=yield C(l.auth,o,(0,I.m9)(u));return new oo(p,g=>Sc(l,g))})).apply(this,arguments)}function C(c,o,u){return Cr.apply(this,arguments)}function Cr(){return Cr=(0,S.Z)(function*(c,o,u){var l;const p=yield u.verify();try{let g;if(V("string"==typeof p,c,"argument-error"),V(u.type===bi,c,"argument-error"),g="string"==typeof o?{phoneNumber:o}:o,"session"in g){const A=g.session;if("phoneNumber"in g)return V("enroll"===A.type,c,"internal-error"),(yield function at(c,o){return Ze(c,"POST","/v2/accounts/mfaEnrollment:start",Fe(c,o))}(c,{idToken:A.credential,phoneEnrollmentInfo:{phoneNumber:g.phoneNumber,recaptchaToken:p}})).phoneSessionInfo.sessionInfo;{V("signin"===A.type,c,"internal-error");const x=(null===(l=g.multiFactorHint)||void 0===l?void 0:l.uid)||g.multiFactorUid;return V(x,c,"missing-multi-factor-info"),(yield function jc(c,o){return Ze(c,"POST","/v2/accounts/mfaSignIn:start",Fe(c,o))}(c,{mfaPendingCredential:A.credential,mfaEnrollmentId:x,phoneSignInInfo:{recaptchaToken:p}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:A}=yield function wc(c,o){return Ps.apply(this,arguments)}(c,{phoneNumber:g.phoneNumber,recaptchaToken:p});return A}}finally{u._reset()}}),Cr.apply(this,arguments)}function Xa(){return(Xa=(0,S.Z)(function*(c,o){yield Ra((0,I.m9)(c),o)})).apply(this,arguments)}let un=(()=>{class c{constructor(u){this.providerId=c.PROVIDER_ID,this.auth=Ue(u)}verifyPhoneNumber(u,l){return C(this.auth,u,(0,I.m9)(l))}static credential(u,l){return rn._fromVerification(u,l)}static credentialFromResult(u){return c.credentialFromTaggedObject(u)}static credentialFromError(u){return c.credentialFromTaggedObject(u.customData||{})}static credentialFromTaggedObject({_tokenResponse:u}){if(!u)return null;const{phoneNumber:l,temporaryProof:p}=u;return l&&p?rn._fromTokenResponse(l,p):null}}return c.PROVIDER_ID="phone",c.PHONE_SIGN_IN_METHOD="phone",c})();function vt(c,o){return o?_t(o):(V(c._popupRedirectResolver,c,"argument-error"),c._popupRedirectResolver)}class Ja extends Bt{constructor(o){super("custom","custom"),this.params=o}_getIdTokenResponse(o){return tn(o,this._buildIdpRequest())}_linkToIdToken(o,u){return tn(o,this._buildIdpRequest(u))}_getReauthenticationResolver(o){return tn(o,this._buildIdpRequest())}_buildIdpRequest(o){const u={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return o&&(u.idToken=o),u}}function Hn(c){return Gs(c.auth,new Ja(c),c.bypassAuthState)}function Qc(c){const{auth:o,user:u}=c;return V(u,o,"internal-error"),Da(u,new Ja(c),c.bypassAuthState)}function eu(c){return tu.apply(this,arguments)}function tu(){return(tu=(0,S.Z)(function*(c){const{auth:o,user:u}=c;return V(u,o,"internal-error"),Ra(u,new Ja(c),c.bypassAuthState)})).apply(this,arguments)}class Yc{constructor(o,u,l,p,g=!1){this.auth=o,this.resolver=l,this.user=p,this.bypassAuthState=g,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(u)?u:[u]}execute(){var o=this;return new Promise(function(){var u=(0,S.Z)(function*(l,p){o.pendingPromise={resolve:l,reject:p};try{o.eventManager=yield o.resolver._initialize(o.auth),yield o.onExecution(),o.eventManager.registerConsumer(o)}catch(g){o.reject(g)}});return function(l,p){return u.apply(this,arguments)}}())}onAuthEvent(o){var u=this;return(0,S.Z)(function*(){const{urlResponse:l,sessionId:p,postBody:g,tenantId:A,error:x,type:F}=o;if(x)return void u.reject(x);const B={auth:u.auth,requestUri:l,sessionId:p,tenantId:A||void 0,postBody:g||void 0,user:u.user,bypassAuthState:u.bypassAuthState};try{u.resolve(yield u.getIdpTask(F)(B))}catch(K){u.reject(K)}})()}onError(o){this.reject(o)}getIdpTask(o){switch(o){case"signInViaPopup":case"signInViaRedirect":return Hn;case"linkViaPopup":case"linkViaRedirect":return eu;case"reauthViaPopup":case"reauthViaRedirect":return Qc;default:Ee(this.auth,"internal-error")}}resolve(o){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(o),this.unregisterAndCleanUp()}reject(o){je(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(o),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const xt=new se(2e3,1e4);function Kn(){return(Kn=(0,S.Z)(function*(c,o,u){const l=Ue(c);Xt(c,o,dt);const p=vt(l,u);return new Lt(l,"signInViaPopup",o,p).executeNotNull()})).apply(this,arguments)}function it(){return(it=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c);Xt(l.auth,o,dt);const p=vt(l.auth,u);return new Lt(l.auth,"reauthViaPopup",o,p,l).executeNotNull()})).apply(this,arguments)}function uo(){return(uo=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c);Xt(l.auth,o,dt);const p=vt(l.auth,u);return new Lt(l.auth,"linkViaPopup",o,p,l).executeNotNull()})).apply(this,arguments)}let Lt=(()=>{class c extends Yc{constructor(u,l,p,g,A){super(u,l,g,A),this.provider=p,this.authWindow=null,this.pollId=null,c.currentPopupAction&&c.currentPopupAction.cancel(),c.currentPopupAction=this}executeNotNull(){var u=this;return(0,S.Z)(function*(){const l=yield u.execute();return V(l,u.auth,"internal-error"),l})()}onExecution(){var u=this;return(0,S.Z)(function*(){je(1===u.filter.length,"Popup operations only handle one event");const l=ze();u.authWindow=yield u.resolver._openPopup(u.auth,u.provider,u.filter[0],l),u.authWindow.associatedEvent=l,u.resolver._originValidation(u.auth).catch(p=>{u.reject(p)}),u.resolver._isIframeWebStorageSupported(u.auth,p=>{p||u.reject(Ce(u.auth,"web-storage-unsupported"))}),u.pollUserCancellation()})()}get eventId(){var u;return(null===(u=this.authWindow)||void 0===u?void 0:u.associatedEvent)||null}cancel(){this.reject(Ce(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,c.currentPopupAction=null}pollUserCancellation(){const u=()=>{var l,p;this.pollId=null!==(p=null===(l=this.authWindow)||void 0===l?void 0:l.window)&&void 0!==p&&p.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ce(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(u,xt.get())};u()}}return c.currentPopupAction=null,c})();const Jc="pendingRedirect",En=new Map;class el extends Yc{constructor(o,u,l=!1){super(o,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],u,void 0,l),this.eventId=null}execute(){var o=()=>super.execute,u=this;return(0,S.Z)(function*(){let l=En.get(u.auth._key());if(!l){try{const g=(yield function $h(c,o){return nu.apply(this,arguments)}(u.resolver,u.auth))?yield o().call(u):null;l=()=>Promise.resolve(g)}catch(p){l=()=>Promise.reject(p)}En.set(u.auth._key(),l)}return u.bypassAuthState||En.set(u.auth._key(),()=>Promise.resolve(null)),l()})()}onAuthEvent(o){var u=()=>super.onAuthEvent,l=this;return(0,S.Z)(function*(){if("signInViaRedirect"===o.type)return u().call(l,o);if("unknown"!==o.type){if(o.eventId){const p=yield l.auth._redirectUserForId(o.eventId);if(p)return l.user=p,u().call(l,o);l.resolve(null)}}else l.resolve(null)})()}onExecution(){return(0,S.Z)(function*(){})()}cleanUp(){}}function nu(){return(nu=(0,S.Z)(function*(c,o){const u=nl(o),l=tl(c);if(!(yield l._isAvailable()))return!1;const p="true"===(yield l._get(u));return yield l._remove(u),p})).apply(this,arguments)}function ru(c,o){return iu.apply(this,arguments)}function iu(){return(iu=(0,S.Z)(function*(c,o){return tl(c)._set(nl(o),"true")})).apply(this,arguments)}function su(c,o){En.set(c._key(),o)}function tl(c){return _t(c._redirectPersistence)}function nl(c){return jt(Jc,c.config.apiKey,c.name)}function Hh(c,o,u){return function Kh(c,o,u){return ou.apply(this,arguments)}(c,o,u)}function ou(){return(ou=(0,S.Z)(function*(c,o,u){const l=Ue(c);Xt(c,o,dt),yield l._initializationPromise;const p=vt(l,u);return yield ru(p,l),p._openRedirect(l,o,"signInViaRedirect")})).apply(this,arguments)}function Wh(c,o,u){return function Qh(c,o,u){return au.apply(this,arguments)}(c,o,u)}function au(){return(au=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c);Xt(l.auth,o,dt),yield l.auth._initializationPromise;const p=vt(l.auth,u);yield ru(p,l.auth);const g=yield Qe(l);return p._openRedirect(l.auth,o,"reauthViaRedirect",g)})).apply(this,arguments)}function Yh(c,o,u){return function rl(c,o,u){return uu.apply(this,arguments)}(c,o,u)}function uu(){return(uu=(0,S.Z)(function*(c,o,u){const l=(0,I.m9)(c);Xt(l.auth,o,dt),yield l.auth._initializationPromise;const p=vt(l.auth,u);yield qs(!1,l,o.providerId),yield ru(p,l.auth);const g=yield Qe(l);return p._openRedirect(l.auth,o,"linkViaRedirect",g)})).apply(this,arguments)}function co(){return(co=(0,S.Z)(function*(c,o){return yield Ue(c)._initializationPromise,lo(c,o,!1)})).apply(this,arguments)}function lo(c,o){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,S.Z)(function*(c,o,u=!1){const l=Ue(c),p=vt(l,o),A=yield new el(l,p,u).execute();return A&&!u&&(delete A.user._redirectEventId,yield l._persistUserIfCurrent(A.user),yield l._setRedirectUser(null,o)),A})).apply(this,arguments)}function Qe(c){return ho.apply(this,arguments)}function ho(){return(ho=(0,S.Z)(function*(c){const o=ze(`${c.uid}:::`);return c._redirectEventId=o,yield c.auth._setRedirectUser(c),yield c.auth._persistUserIfCurrent(c),o})).apply(this,arguments)}class cu{constructor(o){this.auth=o,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(o){this.consumers.add(o),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,o)&&(this.sendToConsumer(this.queuedRedirectEvent,o),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(o){this.consumers.delete(o)}onEvent(o){if(this.hasEventBeenHandled(o))return!1;let u=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(o,l)&&(u=!0,this.sendToConsumer(o,l),this.saveEventToCache(o))}),this.hasHandledPotentialRedirect||!function ut(c){switch(c.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Di(c);default:return!1}}(o)||(this.hasHandledPotentialRedirect=!0,u||(this.queuedRedirectEvent=o,u=!0)),u}sendToConsumer(o,u){var l;if(o.error&&!Di(o)){const p=(null===(l=o.error.code)||void 0===l?void 0:l.split("auth/")[1])||"internal-error";u.onError(Ce(this.auth,p))}else u.onAuthEvent(o)}isEventForConsumer(o,u){const l=null===u.eventId||!!o.eventId&&o.eventId===u.eventId;return u.filter.includes(o.type)&&l}hasEventBeenHandled(o){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xe(o))}saveEventToCache(o){this.cachedEventUids.add(xe(o)),this.lastProcessedEventTime=Date.now()}}function xe(c){return[c.type,c.eventId,c.sessionId,c.tenantId].filter(o=>o).join("-")}function Di({type:c,error:o}){return"unknown"===c&&"auth/no-auth-event"===(null==o?void 0:o.code)}function De(c){return fo.apply(this,arguments)}function fo(){return(fo=(0,S.Z)(function*(c,o={}){return Ze(c,"GET","/v1/projects",o)})).apply(this,arguments)}const Nr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,It=/^https?/;function lu(){return(lu=(0,S.Z)(function*(c){if(c.config.emulator)return;const{authorizedDomains:o}=yield De(c);for(const u of o)try{if(Ye(u))return}catch{}Ee(c,"unauthorized-domain")})).apply(this,arguments)}function Ye(c){const o=pe(),{protocol:u,hostname:l}=new URL(o);if(c.startsWith("chrome-extension://")){const A=new URL(c);return""===A.hostname&&""===l?"chrome-extension:"===u&&c.replace("chrome-extension://","")===o.replace("chrome-extension://",""):"chrome-extension:"===u&&A.hostname===l}if(!It.test(u))return!1;if(Nr.test(c))return l===c;const p=c.replace(/\./g,"\\.");return new RegExp("^(.+\\."+p+"|"+p+")$","i").test(l)}const Xh=new se(3e4,6e4);function cn(){const c=be().___jsl;if(null!=c&&c.H)for(const o of Object.keys(c.H))if(c.H[o].r=c.H[o].r||[],c.H[o].L=c.H[o].L||[],c.H[o].r=[...c.H[o].L],c.CP)for(let u=0;u<c.CP.length;u++)c.CP[u]=null}let Ft=null;const mo=new se(5e3,15e3),Pi="__/auth/iframe",Jh="emulator/auth/iframe",Sn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function go(c){const o=c.config;V(o.authDomain,c,"auth-domain-config-required");const u=o.emulator?cr(o,Jh):`https://${c.config.authDomain}/${Pi}`,l={apiKey:o.apiKey,appName:c.name,v:P.SDK_VERSION},p=bn.get(c.config.apiHost);p&&(l.eid=p);const g=c._getFrameworks();return g.length&&(l.fw=g.join(",")),`${u}?${(0,I.xO)(l).slice(1)}`}function Ut(){return Ut=(0,S.Z)(function*(c){const o=yield function po(c){return Ft=Ft||function $e(c){return new Promise((o,u)=>{var l,p,g;function A(){cn(),gapi.load("gapi.iframes",{callback:()=>{o(gapi.iframes.getContext())},ontimeout:()=>{cn(),u(Ce(c,"network-request-failed"))},timeout:Xh.get()})}if(null!==(p=null===(l=be().gapi)||void 0===l?void 0:l.iframes)&&void 0!==p&&p.Iframe)o(gapi.iframes.getContext());else{if(null===(g=be().gapi)||void 0===g||!g.load){const x=gc("iframefcb");return be()[x]=()=>{gapi.load?A():u(Ce(c,"network-request-failed"))},pa(`https://apis.google.com/js/api.js?onload=${x}`).catch(F=>u(F))}A()}}).catch(o=>{throw Ft=null,o})}(c),Ft}(c),u=be().gapi;return V(u,c,"internal-error"),o.open({where:document.body,url:go(c),messageHandlersFilter:u.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sn,dontclear:!0},l=>new Promise(function(){var p=(0,S.Z)(function*(g,A){yield l.restyle({setHideOnLeave:!1});const x=Ce(c,"network-request-failed"),F=be().setTimeout(()=>{A(x)},mo.get());function B(){be().clearTimeout(F),g(l)}l.ping(B).then(B,()=>{A(x)})});return function(g,A){return p.apply(this,arguments)}}()))}),Ut.apply(this,arguments)}const Oi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Mi{constructor(o){this.window=o,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Li="__/auth/handler",al="emulator/auth/handler",ul=encodeURIComponent("fac");function Dr(c,o,u,l,p,g){return Qn.apply(this,arguments)}function Qn(){return(Qn=(0,S.Z)(function*(c,o,u,l,p,g){V(c.config.authDomain,c,"auth-domain-config-required"),V(c.config.apiKey,c,"invalid-api-key");const A={apiKey:c.config.apiKey,appName:c.name,authType:u,redirectUrl:l,v:P.SDK_VERSION,eventId:p};if(o instanceof dt){o.setDefaultLanguage(c.languageCode),A.providerId=o.providerId||"",(0,I.xb)(o.getCustomParameters())||(A.customParameters=JSON.stringify(o.getCustomParameters()));for(const[K,W]of Object.entries(g||{}))A[K]=W}if(o instanceof yt){const K=o.getScopes().filter(W=>""!==W);K.length>0&&(A.scopes=K.join(","))}c.tenantId&&(A.tid=c.tenantId);const x=A;for(const K of Object.keys(x))void 0===x[K]&&delete x[K];const F=yield c._getAppCheckToken(),B=F?`#${ul}=${encodeURIComponent(F)}`:"";return`${function cl({config:c}){return c.emulator?cr(c,al):`https://${c.authDomain}/${Li}`}(c)}?${(0,I.xO)(x).slice(1)}${B}`})).apply(this,arguments)}const fu="webStorageSupport",pu=class ed{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wn,this._completeRedirectFn=lo,this._overrideRedirectResult=su}_openPopup(o,u,l,p){var g=this;return(0,S.Z)(function*(){var A;je(null===(A=g.eventManagers[o._key()])||void 0===A?void 0:A.manager,"_initialize() not called before _openPopup()");const x=yield Dr(o,u,l,pe(),p);return function Wn(c,o,u,l=500,p=600){const g=Math.max((window.screen.availHeight-p)/2,0).toString(),A=Math.max((window.screen.availWidth-l)/2,0).toString();let x="";const F=Object.assign(Object.assign({},Oi),{width:l.toString(),height:p.toString(),top:g,left:A}),B=(0,I.z$)().toLowerCase();u&&(x=oa(B)?"_blank":u),vs(B)&&(o=o||"http://localhost",F.scrollbars="yes");const K=Object.entries(F).reduce((he,[le,Ki])=>`${he}${le}=${Ki},`,"");if(function Sh(c=(0,I.z$)()){var o;return gn(c)&&!(null===(o=window.navigator)||void 0===o||!o.standalone)}(B)&&"_self"!==x)return function du(c,o){const u=document.createElement("a");u.href=c,u.target=o;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),u.dispatchEvent(l)}(o||"",x),new Mi(null);const W=window.open(o||"",x,K);V(W,c,"popup-blocked");try{W.focus()}catch{}return new Mi(W)}(o,x,ze())})()}_openRedirect(o,u,l,p){var g=this;return(0,S.Z)(function*(){return yield g._originValidation(o),function ja(c){be().location.href=c}(yield Dr(o,u,l,pe(),p)),new Promise(()=>{})})()}_initialize(o){const u=o._key();if(this.eventManagers[u]){const{manager:p,promise:g}=this.eventManagers[u];return p?Promise.resolve(p):(je(g,"If manager is not set, promise should be"),g)}const l=this.initAndGetManager(o);return this.eventManagers[u]={promise:l},l.catch(()=>{delete this.eventManagers[u]}),l}initAndGetManager(o){var u=this;return(0,S.Z)(function*(){const l=yield function xn(c){return Ut.apply(this,arguments)}(o),p=new cu(o);return l.register("authEvent",g=>(V(null==g?void 0:g.authEvent,o,"invalid-auth-event"),{status:p.onEvent(g.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),u.eventManagers[o._key()]={manager:p},u.iframes[o._key()]=l,p})()}_isIframeWebStorageSupported(o,u){this.iframes[o._key()].send(fu,{type:fu},p=>{var g;const A=null===(g=null==p?void 0:p[0])||void 0===g?void 0:g[fu];void 0!==A&&u(!!A),Ee(o,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(o){const u=o._key();return this.originValidationPromises[u]||(this.originValidationPromises[u]=function sl(c){return lu.apply(this,arguments)}(o)),this.originValidationPromises[u]}get _shouldInitProactively(){return Is()||Jr()||gn()}};class ll{constructor(o){this.factorId=o}_process(o,u,l){switch(u.type){case"enroll":return this._finalizeEnroll(o,u.credential,l);case"signin":return this._finalizeSignIn(o,u.credential);default:return lt("unexpected MultiFactorSessionType")}}}class Xe extends ll{constructor(o){super("phone"),this.credential=o}static _fromCredential(o){return new Xe(o)}_finalizeEnroll(o,u,l){return function Xs(c,o){return Ze(c,"POST","/v2/accounts/mfaEnrollment:finalize",Fe(c,o))}(o,{idToken:u,displayName:l,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(o,u){return function ae(c,o){return Ze(c,"POST","/v2/accounts/mfaSignIn:finalize",Fe(c,o))}(o,{mfaPendingCredential:u,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let hl=(()=>{class c{constructor(){}static assertion(u){return Xe._fromCredential(u)}}return c.FACTOR_ID="phone",c})();var Yn="@firebase/auth";class fl{constructor(o){this.auth=o,this.internalListeners=new Map}getUid(){var o;return this.assertAuthConfigured(),(null===(o=this.auth.currentUser)||void 0===o?void 0:o.uid)||null}getToken(o){var u=this;return(0,S.Z)(function*(){return u.assertAuthConfigured(),yield u.auth._initializationPromise,u.auth.currentUser?{accessToken:yield u.auth.currentUser.getIdToken(o)}:null})()}addAuthTokenListener(o){if(this.assertAuthConfigured(),this.internalListeners.has(o))return;const u=this.auth.onIdTokenChanged(l=>{o((null==l?void 0:l.stsTokenManager.accessToken)||null)});this.internalListeners.set(o,u),this.updateProactiveRefresh()}removeAuthTokenListener(o){this.assertAuthConfigured();const u=this.internalListeners.get(o);u&&(this.internalListeners.delete(o),u(),this.updateProactiveRefresh())}assertAuthConfigured(){V(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Cn(){return window}(0,I.Pz)("authIdTokenMaxAge"),function Te(c){(0,P._registerComponent)(new ee.wA("auth",(o,{options:u})=>{const l=o.getProvider("app").getImmediate(),p=o.getProvider("heartbeat"),g=o.getProvider("app-check-internal"),{apiKey:A,authDomain:x}=l.options;V(A&&!A.includes(":"),"invalid-api-key",{appName:l.name});const F={apiKey:A,authDomain:x,clientPlatform:c,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ke(c)},B=new ya(l,p,g,F);return function yc(c,o){const u=(null==o?void 0:o.persistence)||[],l=(Array.isArray(u)?u:[u]).map(_t);null!=o&&o.errorMap&&c._updateErrorMap(o.errorMap),c._initializeWithPersistence(l,null==o?void 0:o.popupRedirectResolver)}(B,u),B},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,u,l)=>{o.getProvider("auth-internal").initialize()})),(0,P._registerComponent)(new ee.wA("auth-internal",o=>{const u=Ue(o.getProvider("auth").getImmediate());return new fl(u)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,P.registerVersion)(Yn,"0.23.2",function ge(c){switch(c){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(c)),(0,P.registerVersion)(Yn,"0.23.2","esm2017")}("Browser");function _u(){return _u=(0,S.Z)(function*(c,o,u){var l;const{BuildInfo:p}=Cn();je(o.sessionId,"AuthEvent did not contain a session ID");const g=yield function id(c){return vu.apply(this,arguments)}(o.sessionId),A={};return gn()?A.ibi=p.packageName:ei()?A.apn=p.packageName:Ee(c,"operation-not-supported-in-this-environment"),p.displayName&&(A.appDisplayName=p.displayName),A.sessionId=g,Dr(c,u,o.type,void 0,null!==(l=o.eventId)&&void 0!==l?l:void 0,A)}),_u.apply(this,arguments)}function yu(){return(yu=(0,S.Z)(function*(c){const{BuildInfo:o}=Cn(),u={};gn()?u.iosBundleId=o.packageName:ei()?u.androidPackageName=o.packageName:Ee(c,"operation-not-supported-in-this-environment"),yield De(c,u)})).apply(this,arguments)}function yo(){return(yo=(0,S.Z)(function*(c,o,u){const{cordova:l}=Cn();let p=()=>{};try{yield new Promise((g,A)=>{let x=null;function F(){var W;g();const he=null===(W=l.plugins.browsertab)||void 0===W?void 0:W.close;"function"==typeof he&&he(),"function"==typeof(null==u?void 0:u.close)&&u.close()}function B(){x||(x=window.setTimeout(()=>{A(Ce(c,"redirect-cancelled-by-user"))},2e3))}function K(){"visible"===(null==document?void 0:document.visibilityState)&&B()}o.addPassiveListener(F),document.addEventListener("resume",B,!1),ei()&&document.addEventListener("visibilitychange",K,!1),p=()=>{o.removePassiveListener(F),document.removeEventListener("resume",B,!1),document.removeEventListener("visibilitychange",K,!1),x&&window.clearTimeout(x)}})}finally{p()}})).apply(this,arguments)}function vu(){return(vu=(0,S.Z)(function*(c){const o=function Iu(c){if(je(/[0-9a-zA-Z]+/.test(c),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(c);const o=new ArrayBuffer(c.length),u=new Uint8Array(o);for(let l=0;l<c.length;l++)u[l]=c.charCodeAt(l);return u}(c),u=yield crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(u)).map(p=>p.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Ui extends cu{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(o=>{this.resolveInialized=o})}addPassiveListener(o){this.passiveListeners.add(o)}removePassiveListener(o){this.passiveListeners.delete(o)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(o){return this.resolveInialized(),this.passiveListeners.forEach(u=>u(o)),super.onEvent(o)}initialized(){var o=this;return(0,S.Z)(function*(){yield o.initPromise})()}}function wu(c){return wo.apply(this,arguments)}function wo(){return(wo=(0,S.Z)(function*(c){const o=yield Nn()._get(To(c));return o&&(yield Nn()._remove(To(c))),o})).apply(this,arguments)}function vl(){const c=[];for(let u=0;u<20;u++){const l=Math.floor(62*Math.random());c.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(l))}return c.join("")}function Nn(){return _t($n)}function To(c){return jt("authEvent",c.config.apiKey,c.name)}function Or(c){if(null==c||!c.includes("?"))return{};const[o,...u]=c.split("?");return(0,I.zd)(u.join("?"))}const Eu=class ft{constructor(){this._redirectPersistence=wn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=lo,this._overrideRedirectResult=su}_initialize(o){var u=this;return(0,S.Z)(function*(){const l=o._key();let p=u.eventManagers.get(l);return p||(p=new Ui(o),u.eventManagers.set(l,p),u.attachCallbackListeners(o,p)),p})()}_openPopup(o){Ee(o,"operation-not-supported-in-this-environment")}_openRedirect(o,u,l,p){var g=this;return(0,S.Z)(function*(){!function rd(c){var o,u,l,p,g,A,x,F,B,K;const W=Cn();V("function"==typeof(null===(o=null==W?void 0:W.universalLinks)||void 0===o?void 0:o.subscribe),c,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),V(typeof(null===(u=null==W?void 0:W.BuildInfo)||void 0===u?void 0:u.packageName)<"u",c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),V("function"==typeof(null===(g=null===(p=null===(l=null==W?void 0:W.cordova)||void 0===l?void 0:l.plugins)||void 0===p?void 0:p.browsertab)||void 0===g?void 0:g.openUrl),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V("function"==typeof(null===(F=null===(x=null===(A=null==W?void 0:W.cordova)||void 0===A?void 0:A.plugins)||void 0===x?void 0:x.browsertab)||void 0===F?void 0:F.isAvailable),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V("function"==typeof(null===(K=null===(B=null==W?void 0:W.cordova)||void 0===B?void 0:B.InAppBrowser)||void 0===K?void 0:K.open),c,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(o);const A=yield g._initialize(o);yield A.initialized(),A.resetRedirect(),function jh(){En.clear()}(),yield g._originValidation(o);const x=function vo(c,o,u=null){return{type:o,eventId:u,urlResponse:null,sessionId:vl(),postBody:null,tenantId:c.tenantId,error:Ce(c,"no-auth-event")}}(o,l,p);yield function Io(c,o){return Nn()._set(To(c),o)}(o,x);const F=yield function _l(c,o,u){return _u.apply(this,arguments)}(o,x,u),B=yield function yl(c){const{cordova:o}=Cn();return new Promise(u=>{o.plugins.browsertab.isAvailable(l=>{let p=null;l?o.plugins.browsertab.openUrl(c):p=o.InAppBrowser.open(c,function fc(c=(0,I.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(c)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(c)}()?"_blank":"_system","location=yes"),u(p)})})}(F);return function nd(c,o,u){return yo.apply(this,arguments)}(o,A,B)})()}_isIframeWebStorageSupported(o,u){throw new Error("Method not implemented.")}_originValidation(o){const u=o._key();return this.originValidationPromises[u]||(this.originValidationPromises[u]=function td(c){return yu.apply(this,arguments)}(o)),this.originValidationPromises[u]}attachCallbackListeners(o,u){const{universalLinks:l,handleOpenURL:p,BuildInfo:g}=Cn(),A=setTimeout((0,S.Z)(function*(){yield wu(o),u.onEvent(Vi())}),500),x=function(){var K=(0,S.Z)(function*(W){clearTimeout(A);const he=yield wu(o);let le=null;he&&null!=W&&W.url&&(le=function ln(c,o){var u,l;const p=function Eo(c){const o=Or(c),u=o.link?decodeURIComponent(o.link):void 0,l=Or(u).link,p=o.deep_link_id?decodeURIComponent(o.deep_link_id):void 0;return Or(p).link||p||l||u||c}(o);if(p.includes("/__/auth/callback")){const g=Or(p),A=g.firebaseError?function Tu(c){try{return JSON.parse(c)}catch{return null}}(decodeURIComponent(g.firebaseError)):null,x=null===(l=null===(u=null==A?void 0:A.code)||void 0===u?void 0:u.split("auth/"))||void 0===l?void 0:l[1],F=x?Ce(x):null;return F?{type:c.type,eventId:c.eventId,tenantId:c.tenantId,error:F,urlResponse:null,sessionId:null,postBody:null}:{type:c.type,eventId:c.eventId,tenantId:c.tenantId,sessionId:c.sessionId,urlResponse:p,postBody:null}}return null}(he,W.url)),u.onEvent(le||Vi())});return function(he){return K.apply(this,arguments)}}();typeof l<"u"&&"function"==typeof l.subscribe&&l.subscribe(null,x);const F=p,B=`${g.packageName.toLowerCase()}://`;Cn().handleOpenURL=function(){var K=(0,S.Z)(function*(W){if(W.toLowerCase().startsWith(B)&&x({url:W}),"function"==typeof F)try{F(W)}catch(he){console.error(he)}});return function(W){return K.apply(this,arguments)}}()}};function Vi(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ce("no-auth-event")}}function Mr(){var c;return(null===(c=null==self?void 0:self.location)||void 0===c?void 0:c.protocol)||null}function Tl(c=(0,I.z$)()){return!("file:"!==Mr()&&"ionic:"!==Mr()&&"capacitor:"!==Mr()||!c.toLowerCase().match(/iphone|ipad|ipod|android/))}function Lr(){try{const c=self.localStorage,o=ze();if(c)return c.setItem(o,"1"),c.removeItem(o),!function El(c=(0,I.z$)()){return function sd(){return(0,I.w1)()&&11===(null==document?void 0:document.documentMode)}()||function wt(c=(0,I.z$)()){return/Edge\/\d+/.test(c)}(c)}()||(0,I.hl)()}catch{return Ao()&&(0,I.hl)()}return!1}function Ao(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Vt(){return(function wl(){return"http:"===Mr()||"https:"===Mr()}()||(0,I.ru)()||Tl())&&!function hn(){return(0,I.b$)()||(0,I.UG)()}()&&Lr()&&!Ao()}function Su(){return Tl()&&typeof document<"u"}function bu(){return(bu=(0,S.Z)(function*(){return!!Su()&&new Promise(c=>{const o=setTimeout(()=>{c(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(o),c(!0)})})})).apply(this,arguments)}const re={LOCAL:"local",NONE:"none",SESSION:"session"},Zi=V,So="persistence";function bo(c){return xo.apply(this,arguments)}function xo(){return(xo=(0,S.Z)(function*(c){yield c._initializationPromise;const o=Sl(),u=jt(So,c.config.apiKey,c.name);o&&o.setItem(u,c._getPersistence())})).apply(this,arguments)}function Sl(){var c;try{return(null===(c=function od(){return typeof window<"u"?window:null}())||void 0===c?void 0:c.sessionStorage)||null}catch{return null}}const ad=V;class dn{constructor(){this.browserResolver=_t(pu),this.cordovaResolver=_t(Eu),this.underlyingResolver=null,this._redirectPersistence=wn,this._completeRedirectFn=lo,this._overrideRedirectResult=su}_initialize(o){var u=this;return(0,S.Z)(function*(){return yield u.selectUnderlyingResolver(),u.assertedUnderlyingResolver._initialize(o)})()}_openPopup(o,u,l,p){var g=this;return(0,S.Z)(function*(){return yield g.selectUnderlyingResolver(),g.assertedUnderlyingResolver._openPopup(o,u,l,p)})()}_openRedirect(o,u,l,p){var g=this;return(0,S.Z)(function*(){return yield g.selectUnderlyingResolver(),g.assertedUnderlyingResolver._openRedirect(o,u,l,p)})()}_isIframeWebStorageSupported(o,u){this.assertedUnderlyingResolver._isIframeWebStorageSupported(o,u)}_originValidation(o){return this.assertedUnderlyingResolver._originValidation(o)}get _shouldInitProactively(){return Su()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ad(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var o=this;return(0,S.Z)(function*(){if(o.underlyingResolver)return;const u=yield function Gi(){return bu.apply(this,arguments)}();o.underlyingResolver=u?o.cordovaResolver:o.browserResolver})()}}function er(c){return c.unwrap()}function bl(c){return xu(c)}function xu(c){const{_tokenResponse:o}=c instanceof I.ZR?c.customData:c;if(!o)return null;if(!(c instanceof I.ZR)&&"temporaryProof"in o&&"phoneNumber"in o)return un.credentialFromResult(c);const u=o.providerId;if(!u||u===ie.PASSWORD)return null;let l;switch(u){case ie.GOOGLE:l=Sa;break;case ie.FACEBOOK:l=di;break;case ie.GITHUB:l=Re;break;case ie.TWITTER:l=ba;break;default:const{oauthIdToken:p,oauthAccessToken:g,oauthTokenSecret:A,pendingToken:x,nonce:F}=o;return g||A||p||x?x?u.startsWith("saml.")?Ht._create(u,x):Rt._fromParams({providerId:u,signInMethod:u,pendingToken:x,idToken:p,accessToken:g}):new sn(u).credential({idToken:p,accessToken:g,rawNonce:F}):null}return c instanceof I.ZR?l.credentialFromError(c):l.credentialFromResult(c)}function Je(c,o){return o.catch(u=>{throw u instanceof I.ZR&&function nr(c,o){var u;const l=null===(u=o.customData)||void 0===u?void 0:u._tokenResponse;if("auth/multi-factor-auth-required"===(null==o?void 0:o.code))o.resolver=new zi(c,function Ot(c,o){var u;const l=(0,I.m9)(c),p=o;return V(o.customData.operationType,l,"argument-error"),V(null===(u=p.customData._serverResponse)||void 0===u?void 0:u.mfaPendingCredential,l,"argument-error"),Gt._fromError(l,p)}(c,o));else if(l){const p=xu(o),g=o;p&&(g.credential=p,g.tenantId=l.tenantId||void 0,g.email=l.email||void 0,g.phoneNumber=l.phoneNumber||void 0)}}(c,u),u}).then(u=>{const p=u.user;return{operationType:u.operationType,credential:bl(u),additionalUserInfo:Ph(u),user:fn.getOrCreate(p)}})}function Co(c,o){return No.apply(this,arguments)}function No(){return(No=(0,S.Z)(function*(c,o){const u=yield o;return{verificationId:u.verificationId,confirm:l=>Je(c,u.confirm(l))}})).apply(this,arguments)}class zi{constructor(o,u){this.resolver=u,this.auth=function tr(c){return c.wrapped()}(o)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(o){return Je(er(this.auth),this.resolver.resolveSignIn(o))}}class fn{constructor(o){this._delegate=o,this.multiFactor=function Lh(c){const o=(0,I.m9)(c);return In.has(o)||In.set(o,eo._fromUser(o)),In.get(o)}(o)}static getOrCreate(o){return fn.USER_MAP.has(o)||fn.USER_MAP.set(o,new fn(o)),fn.USER_MAP.get(o)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(o){return this._delegate.getIdTokenResult(o)}getIdToken(o){return this._delegate.getIdToken(o)}linkAndRetrieveDataWithCredential(o){return this.linkWithCredential(o)}linkWithCredential(o){var u=this;return(0,S.Z)(function*(){return Je(u.auth,Ac(u._delegate,o))})()}linkWithPhoneNumber(o,u){var l=this;return(0,S.Z)(function*(){return Co(l.auth,function Wc(c,o,u){return ao.apply(this,arguments)}(l._delegate,o,u))})()}linkWithPopup(o){var u=this;return(0,S.Z)(function*(){return Je(u.auth,function zh(c,o,u){return uo.apply(this,arguments)}(u._delegate,o,dn))})()}linkWithRedirect(o){var u=this;return(0,S.Z)(function*(){return yield bo(Ue(u.auth)),Yh(u._delegate,o,dn)})()}reauthenticateAndRetrieveDataWithCredential(o){return this.reauthenticateWithCredential(o)}reauthenticateWithCredential(o){var u=this;return(0,S.Z)(function*(){return Je(u.auth,Sc(u._delegate,o))})()}reauthenticateWithPhoneNumber(o,u){return Co(this.auth,function Tn(c,o,u){return Ci.apply(this,arguments)}(this._delegate,o,u))}reauthenticateWithPopup(o){return Je(this.auth,function Xc(c,o,u){return it.apply(this,arguments)}(this._delegate,o,dn))}reauthenticateWithRedirect(o){var u=this;return(0,S.Z)(function*(){return yield bo(Ue(u.auth)),Wh(u._delegate,o,dn)})()}sendEmailVerification(o){return function vi(c,o){return Hs.apply(this,arguments)}(this._delegate,o)}unlink(o){var u=this;return(0,S.Z)(function*(){return yield function yr(c,o){return Na.apply(this,arguments)}(u._delegate,o),u})()}updateEmail(o){return function Oc(c,o){return za((0,I.m9)(c),o,null)}(this._delegate,o)}updatePassword(o){return function Zn(c,o){return za((0,I.m9)(c),null,o)}(this._delegate,o)}updatePhoneNumber(o){return function Zt(c,o){return Xa.apply(this,arguments)}(this._delegate,o)}updateProfile(o){return function Ws(c,o){return Qs.apply(this,arguments)}(this._delegate,o)}verifyBeforeUpdateEmail(o,u){return function Pc(c,o,u){return Ii.apply(this,arguments)}(this._delegate,o,u)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}fn.USER_MAP=new WeakMap;const $i=V;let Pe=(()=>{class c{constructor(u,l){if(this.app=u,l.isInitialized())return this._delegate=l.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:p}=u.options;$i(p,"invalid-api-key",{appName:u.name}),$i(p,"invalid-api-key",{appName:u.name});const g=typeof window<"u"?dn:void 0;this._delegate=l.initialize({options:{persistence:Ro(p,u.name),popupRedirectResolver:g}}),this._delegate._updateErrorMap(b),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?fn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(u){this._delegate.languageCode=u}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(u){this._delegate.tenantId=u}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(u,l){!function va(c,o,u){const l=Ue(c);V(l._canInitEmulator,l,"emulator-config-failed"),V(/^https?:\/\//.test(o),l,"invalid-emulator-scheme");const p=!(null==u||!u.disableWarnings),g=Ia(o),{host:A,port:x}=function Ts(c){const o=Ia(c),u=/(\/\/)?([^?#/]+)/.exec(c.substr(o.length));if(!u)return{host:"",port:null};const l=u[2].split("@").pop()||"",p=/^(\[[^\]]+\])(:|$)/.exec(l);if(p){const g=p[1];return{host:g,port:vc(l.substr(g.length+1))}}{const[g,A]=l.split(":");return{host:g,port:vc(A)}}}(o);l.config.emulator={url:`${g}//${A}${null===x?"":`:${x}`}/`},l.settings.appVerificationDisabledForTesting=!0,l.emulatorConfig=Object.freeze({host:A,port:x,protocol:g.replace(":",""),options:Object.freeze({disableWarnings:p})}),p||function xh(){function c(){const o=document.createElement("p"),u=o.style;o.innerText="Running in emulator mode. Do not use with production credentials.",u.position="fixed",u.width="100%",u.backgroundColor="#ffffff",u.border=".1em solid #000000",u.color="#b50000",u.bottom="0px",u.left="0px",u.margin="0px",u.zIndex="10000",u.textAlign="center",o.classList.add("firebase-emulator-warning"),document.body.appendChild(o)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",c):c())}()}(this._delegate,u,l)}applyActionCode(u){return function xc(c,o){return $s.apply(this,arguments)}(this._delegate,u)}checkActionCode(u){return Va(this._delegate,u)}confirmPasswordReset(u,l){return function Rh(c,o,u){return Ua.apply(this,arguments)}(this._delegate,u,l)}createUserWithEmailAndPassword(u,l){var p=this;return(0,S.Z)(function*(){return Je(p._delegate,function Cc(c,o,u){return qa.apply(this,arguments)}(p._delegate,u,l))})()}fetchProvidersForEmail(u){return this.fetchSignInMethodsForEmail(u)}fetchSignInMethodsForEmail(u){return function Dh(c,o){return js.apply(this,arguments)}(this._delegate,u)}isSignInWithEmailLink(u){return function Rc(c,o){const u=_r.parseLink(o);return"EMAIL_SIGNIN"===(null==u?void 0:u.operation)}(0,u)}getRedirectResult(){var u=this;return(0,S.Z)(function*(){$i(Vt(),u._delegate,"operation-not-supported-in-this-environment");const l=yield function il(c,o){return co.apply(this,arguments)}(u._delegate,dn);return l?Je(u._delegate,Promise.resolve(l)):{credential:null,user:null}})()}addFrameworkForLogging(u){!function qi(c,o){Ue(c)._logFramework(o)}(this._delegate,u)}onAuthStateChanged(u,l,p){const{next:g,error:A,complete:x}=ji(u,l,p);return this._delegate.onAuthStateChanged(g,A,x)}onIdTokenChanged(u,l,p){const{next:g,error:A,complete:x}=ji(u,l,p);return this._delegate.onIdTokenChanged(g,A,x)}sendSignInLinkToEmail(u,l){return function Ba(c,o,u){return Gn.apply(this,arguments)}(this._delegate,u,l)}sendPasswordResetEmail(u,l){return function bc(c,o,u){return Fa.apply(this,arguments)}(this._delegate,u,l||void 0)}setPersistence(u){var l=this;return(0,S.Z)(function*(){let p;switch(function Al(c,o){Zi(Object.values(re).includes(o),c,"invalid-persistence-type"),(0,I.b$)()?Zi(o!==re.SESSION,c,"unsupported-persistence-type"):(0,I.UG)()?Zi(o===re.NONE,c,"unsupported-persistence-type"):Ao()?Zi(o===re.NONE||o===re.LOCAL&&(0,I.hl)(),c,"unsupported-persistence-type"):Zi(o===re.NONE||Lr(),c,"unsupported-persistence-type")}(l._delegate,u),u){case re.SESSION:p=wn;break;case re.LOCAL:p=(yield _t(xr)._isAvailable())?xr:$n;break;case re.NONE:p=Un;break;default:return Ee("argument-error",{appName:l._delegate.name})}return l._delegate.setPersistence(p)})()}signInAndRetrieveDataWithCredential(u){return this.signInWithCredential(u)}signInAnonymously(){return Je(this._delegate,function pi(c){return Kt.apply(this,arguments)}(this._delegate))}signInWithCredential(u){return Je(this._delegate,_i(this._delegate,u))}signInWithCustomToken(u){return Je(this._delegate,function Ma(c,o){return zs.apply(this,arguments)}(this._delegate,u))}signInWithEmailAndPassword(u,l){return Je(this._delegate,function Nc(c,o,u){return _i((0,I.m9)(c),Aa.credential(o,u))}(this._delegate,u,l))}signInWithEmailLink(u,l){return Je(this._delegate,function Ga(c,o,u){return Tr.apply(this,arguments)}(this._delegate,u,l))}signInWithPhoneNumber(u,l){return Co(this._delegate,function bt(c,o,u){return ki.apply(this,arguments)}(this._delegate,u,l))}signInWithPopup(u){var l=this;return(0,S.Z)(function*(){return $i(Vt(),l._delegate,"operation-not-supported-in-this-environment"),Je(l._delegate,function Ni(c,o,u){return Kn.apply(this,arguments)}(l._delegate,u,dn))})()}signInWithRedirect(u){var l=this;return(0,S.Z)(function*(){return $i(Vt(),l._delegate,"operation-not-supported-in-this-environment"),yield bo(l._delegate),Hh(l._delegate,u,dn)})()}updateCurrentUser(u){return this._delegate.updateCurrentUser(u)}verifyPasswordResetCode(u){return function kc(c,o){return Pt.apply(this,arguments)}(this._delegate,u)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return c.Persistence=re,c})();function ji(c,o,u){let l=c;"function"!=typeof c&&({next:l,error:o,complete:u}=c);const p=l;return{next:A=>p(A&&fn.getOrCreate(A)),error:o,complete:u}}function Ro(c,o){const u=function ko(c,o){const u=Sl();if(!u)return[];const l=jt(So,c,o);switch(u.getItem(l)){case re.NONE:return[Un];case re.LOCAL:return[xr,wn];case re.SESSION:return[wn];default:return[]}}(c,o);if(typeof self<"u"&&!u.includes(xr)&&u.push(xr),typeof window<"u")for(const l of[$n,wn])u.includes(l)||u.push(l);return u.includes(Un)||u.push(Un),u}class Do{constructor(){this.providerId="phone",this._delegate=new un(er(de.Z.auth()))}static credential(o,u){return un.credential(o,u)}verifyPhoneNumber(o,u){return this._delegate.verifyPhoneNumber(o,u)}unwrap(){return this._delegate}}Do.PHONE_SIGN_IN_METHOD=un.PHONE_SIGN_IN_METHOD,Do.PROVIDER_ID=un.PROVIDER_ID;const ud=V;class Hi{constructor(o,u,l=de.Z.app()){var p;ud(null===(p=l.options)||void 0===p?void 0:p.apiKey,"invalid-api-key",{appName:l.name}),this._delegate=new xi(o,u,l.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function xl(c){c.INTERNAL.registerComponent(new ee.wA("auth-compat",o=>{const u=o.getProvider("app-compat").getImmediate(),l=o.getProvider("auth");return new Pe(u,l)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Aa,FacebookAuthProvider:di,GithubAuthProvider:Re,GoogleAuthProvider:Sa,OAuthProvider:sn,SAMLAuthProvider:Fs,PhoneAuthProvider:Do,PhoneMultiFactorGenerator:hl,RecaptchaVerifier:Hi,TwitterAuthProvider:ba,Auth:Pe,AuthCredential:Bt,Error:I.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),c.registerVersion("@firebase/auth-compat","0.4.2")}(de.Z)}}]);